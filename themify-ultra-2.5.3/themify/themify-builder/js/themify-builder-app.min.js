var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(g,y,t){g instanceof String&&(g=String(g));for(var x=g.length,r=0;r<x;r++){var p=g[r];if(y.call(t,p,r,g))return{i:r,v:p}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(g,y,t){g!=Array.prototype&&g!=Object.prototype&&(g[y]=t.value)};$jscomp.getGlobal=function(g){return"undefined"!=typeof window&&window===g?g:"undefined"!=typeof global&&null!=global?global:g};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(g,y,t,x){if(y){t=$jscomp.global;g=g.split(".");for(x=0;x<g.length-1;x++){var r=g[x];r in t||(t[r]={});t=t[r]}g=g[g.length-1];x=t[g];y=y(x);y!=x&&null!=y&&$jscomp.defineProperty(t,g,{configurable:!0,writable:!0,value:y})}};$jscomp.polyfill("Array.prototype.find",function(g){return g?g:function(g,t){return $jscomp.findInternal(this,g,t).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(g){return $jscomp.SYMBOL_PREFIX+(g||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var g=$jscomp.global.Symbol.iterator;g||(g=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[g]&&$jscomp.defineProperty(Array.prototype,g,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(g){var y=0;return $jscomp.iteratorPrototype(function(){return y<g.length?{done:!1,value:g[y++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(g){$jscomp.initSymbolIterator();g={next:g};g[$jscomp.global.Symbol.iterator]=function(){return this};return g};$jscomp.iteratorFromArray=function(g,y){$jscomp.initSymbolIterator();g instanceof String&&(g+="");var t=0,x={next:function(){if(t<g.length){var r=t++;return{value:y(r,g[r]),done:!1}}x.next=function(){return{done:!0,value:void 0}};return x.next()}};x[Symbol.iterator]=function(){return x};return x};
$jscomp.polyfill("Array.prototype.keys",function(g){return g?g:function(){return $jscomp.iteratorFromArray(this,function(g){return g})}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.values",function(g){return g?g:function(){return $jscomp.iteratorFromArray(this,function(g,t){return t})}},"es6","es3");var tb_app;
(function(g,y,t,x,r,p,l,q){"function"===typeof r.document.ondragstart&&(r.document.ondragstart=x.document.ondragstart=null);var H=g.ui.sortable.prototype._mouseStart,E=p.body.classList.contains("full-section-scrolling");g.ui.sortable.prototype._mouseStart=function(a,b,d){if("mousedown"===a.type&&1===a.which){var e=a.target.classList;if(e.contains("tb_subrow_holder")||e.contains("tb_grid_drag")||e.contains("tb_column_action")&&a.target.parentNode.classList.contains("sub_column")||("row"===c.ActionBar.type||
"subrow"===c.ActionBar.type)&&!e.contains("ti-move")&&null!==a.target.parentNode.closest(".tb_clicked"))return a.stopImmediatePropagation(),a.preventDefault(),!1;this._trigger("beforeStart",a,[this,this._uiHash()])}H.apply(this,[a,b,d])};Element.prototype.closest||(Element.prototype.closest=function(a){var b=null,d=null,c=null,f=this;0===a.indexOf(".")?(b=!0,a=a.replace(".","")):0===a.indexOf("#")?(d=!0,a=a.replace("#","")):c=!0;for(;;){var h=f;h=!0===b&&h.classList.contains(a)||!0===d&&h.id===a||
!0===c&&h.nodeName.toLowerCase()===a?h:null;if(null!==h)return h;f=f.parentElement;if(!f)return null}});String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(a,b){var d=this.toString(),c=d.length;if(b===q||b>c)b=c;b-=c;d=d.indexOf(a,b);return-1!==d&&d===b}});q===g.fn.themifySerializeObject&&(g.fn.themifySerializeObject=function(){for(var a={},b=this.length-1;-1<b;--b){var d=this[b].type;if(this[b].classList.contains("wp-editor-area")&&tinyMCE!==q){var c=tinyMCE.get(this[b].id);
c&&(this[b].value=c.getContent())}if(""!==this[b].value&&("text"===d||"number"===d||"radio"===d||"checkbox"===d||"textarea"===d||"select-one"===d||"hidden"===d||"email"===d||"select"===d||"select-multiple"===d)&&(this[b].name||this[b].id)){var c=this[b].name?this[b].name:this[b].id,f=this[b].value;"radio"===d||"checkbox"===d?f=this[b].checked&&f:"select-multiple"===d&&(f=g(this[b]).val());a[c]!==q&&"radio"!==d?(!a[c].push&&(a[c]=[a[c]]),f&&a[c].push(f)):f&&(a[c]=f)}}return a});var c=tb_app={activeModel:null,
Models:{},Collections:{},Mixins:{},Views:{Modules:{},Rows:{},SubRows:{},Columns:{}},Forms:{},Constructor:{},Utils:{},Instances:{Builder:{}}},D={},B=null;c.builderIndex=0;c.mode="default";c.autoSaveCid=null;c.hasChanged=null;c.editing=!1;c.scrollTo=!1;c.eventName=!1;c.beforeEvent=!1;c.saving=!1;c.activeBreakPoint="desktop";c.zoomMeta={isActive:!1,size:100};c.isPreview=!1;c.clearOnModeChange=null;c.Models.Module=y.Model.extend({defaults:{element_id:null,elType:"module",mod_name:"",mod_settings:{}},
initialize:function(){c.Models.Registry.register(this.cid,this);var a=this.get("element_id");a&&1!==D[a]||(a=c.Utils.generateUniqueID(),this.set({element_id:a},{silent:!0}));D[a]=1},toRenderData:function(){return{slug:this.get("mod_name"),name:themifyBuilder.modules[this.get("mod_name")].name,excerpt:this.getExcerpt()}},getExcerpt:function(a){a=a||this.get("mod_settings");return this.limitString(a.content_text||a.content_box||a.plain_text||"",100)},limitString:function(a,b){var d="";""!==a&&(a=this.stripHtml(a).toString(),
d=a.length>b?a.substr(0,b):a);return d},stripHtml:function(a){var b=p.createElement("div");b.innerHTML=a;return b.textContent||b.innerText||""},setData:function(a){c.Utils.clearElementId([a]);a=c.Views.init_module(a);a.model.trigger("custom:change",a)},backendLivePreview:function(){g(".tb_element_cid_"+this.cid).find(".module_excerpt").text(this.getExcerpt())},getPreviewSettings:function(){return _.extend({cid:this.cid},themifyBuilder.modules[this.get("mod_name")].defaults)},getIDattr:function(){return this.get("element_id")?
this.get("element_id"):c.Utils.generateUniqueID()}});c.Models.SubRow=y.Model.extend({defaults:{element_id:null,elType:"subrow",gutter:"gutter-default",column_alignment:E?"col_align_middle":"col_align_top",column_h:"",desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_mobile:"-auto",col_tablet_landscape:"-auto",col_tablet:"-auto",cols:{},styling:{}},initialize:function(){c.Models.Registry.register(this.cid,this);var a=this.get("element_id");a&&1!==D[a]||(a=c.Utils.generateUniqueID(),
this.set({element_id:a},{silent:!0}));D[a]=1},setData:function(a){c.Utils.clearElementId([a]);a=c.Views.init_subrow(a);a.model.trigger("custom:change",a)}});c.Models.Column=y.Model.extend({defaults:{element_id:null,elType:"column",grid_class:"",component_name:"column",modules:{},styling:{}},initialize:function(){c.Models.Registry.register(this.cid,this);var a=this.get("element_id");a&&1!==D[a]||(a=c.Utils.generateUniqueID(),this.set({element_id:a},{silent:!0}));D[a]=1},setData:function(a){c.Utils.clearElementId([a]);
a=c.Views.init_column(a);a.model.trigger("custom:change",a)}});c.Models.Row=y.Model.extend({defaults:{element_id:null,elType:"row",gutter:"gutter-default",column_alignment:E?"col_align_middle":"col_align_top",column_h:"",desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_mobile:"-auto",col_tablet_landscape:"-auto",col_tablet:"-auto",cols:{},styling:{}},initialize:function(){c.Models.Registry.register(this.cid,this);var a=this.get("element_id");a&&1!==D[a]||(a=c.Utils.generateUniqueID(),
this.set({element_id:a},{silent:!0}));D[a]=1},setData:function(a){c.Utils.clearElementId([a]);a=c.Views.init_row(a);a.model.trigger("custom:change",a)}});c.Collections.Rows=y.Collection.extend({model:c.Models.Row});c.Models.Registry={items:{},register:function(a,b){this.items[a]=b},lookup:function(a){return this.items[a]||null},remove:function(a){this.items[a]=null;delete this.items[a]},destroy:function(){for(var a in this.items)this.items[a].destroy();this.items={}}};c.Models.setValue=function(a,
b,d){d=d||!1;c.Models.Registry.lookup(a).set(b,{silent:d})};c.vent=_.extend({},y.Events);c.Views.register_module=function(a){"default"!==c.mode&&(this.Modules[c.mode]=this.Modules["default"].extend(a))};c.Views.init_module=function(a,b){if(themifyBuilder.modules[a.mod_name]===q)return!1;!0===b&&a.mod_settings===q&&themifyBuilder.modules[a.mod_name].defaults!==q&&(a.mod_settings=_.extend({},themifyBuilder.modules[a.mod_name].defaults));var d=a instanceof c.Models.Module?a:new c.Models.Module(a),e=
new (this.get_module())({model:d,type:c.mode});return{model:d,view:e}};c.Views.get_module=function(){return this.Modules[c.mode]};c.Views.unregister_module=function(){"default"!==c.mode&&(this.Modules[c.mode]=null,delete this.Modules[c.mode])};c.Views.module_exists=function(){return this.Modules.hasOwnProperty(c.mode)};c.Views.register_column=function(a){"default"!==c.mode&&(this.Columns[c.mode]=this.Columns["default"].extend(a))};c.Views.init_column=function(a){a=a instanceof c.Models.Column?a:new c.Models.Column(a);
var b=new (this.get_column())({model:a,type:c.mode});return{model:a,view:b}};c.Views.get_column=function(){return this.Columns[c.mode]};c.Views.unregister_column=function(){"default"!==c.mode&&(this.Columns[c.mode]=null,delete this.Columns[c.mode])};c.Views.column_exists=function(){return this.Columns.hasOwnProperty(c.mode)};c.Views.register_subrow=function(a){"default"!==c.mode&&(this.SubRows[c.mode]=this.SubRows["default"].extend(a))};c.Views.init_subrow=function(a){a=a instanceof c.Models.SubRow?
a:new c.Models.SubRow(a);var b=new (this.get_subrow())({model:a,type:c.mode});return{model:a,view:b}};c.Views.get_subrow=function(){return this.SubRows[c.mode]};c.Views.unregister_subrow=function(){"default"!==c.mode&&(this.SubRows[c.mode]=null,delete this.SubRows[c.mode])};c.Views.subrow_exists=function(){return this.SubRows.hasOwnProperty(c.mode)};c.Views.register_row=function(a){"default"!==c.mode&&(this.Rows[c.mode]=this.Rows["default"].extend(a))};c.Views.init_row=function(a){var b=a.attributes;
return b===q||b.cols!==q&&(0<Object.keys(b.cols).length||0<b.cols.length)||b.styling!==q&&0<Object.keys(b.styling).length?(a=a instanceof c.Models.Row?a:new c.Models.Row(a),b=new (this.get_row())({model:a,type:c.mode}),{model:a,view:b}):!1};c.Views.get_row=function(){return this.Rows[c.mode]};c.Views.unregister_row=function(){"default"!==c.mode&&(this.Rows[c.mode]=null,delete this.Rows[c.mode])};c.Views.row_exists=function(){return this.Rows.hasOwnProperty(c.mode)};c.Views.BaseElement=y.View.extend({type:"default",
initialize:function(){this.listenTo(this.model,"custom:change",this.modelChange);this.listenTo(this.model,"destroy",this.remove);this.listenTo(this.model,"edit",this.edit);this.listenTo(this.model,"duplicate",this.duplicate);this.listenTo(this.model,"save",this.save);this.listenTo(this.model,"importExport",this.importExport);this.listenTo(this.model,"delete",this["delete"]);this.listenTo(this.model,"copy",this.copy);this.listenTo(this.model,"paste",this.paste);this.listenTo(this.model,"change:view",
this.setView)},setView:function(a){this.setElement(a)},modelChange:function(){this.$el.attr(_.extend({},_.result(this,"attributes")));var a=this.render(),b=c.beforeEvent.data("cid"),d=p.getElementsByClassName("tb_element_cid_"+b)[0];d.parentNode.replaceChild(a.el,d);"visual"===c.mode?this.model.trigger("visual:change"):("row"===c.eventName&&(b=this.$el.data("cid")),c.undoManager.push(b,c.beforeEvent,this.$el,c.eventName),c.Mixins.Builder.update(this.$el))},remove:function(){this.$el.remove()},copy:function(a,
b){var d=this.$el,e=this.model,f=e.get("elType");"column"===f&&(f=e.get("component_name"));d=this.getData(d,f);Object.keys(c.GS.styles).length&&(e=c.GS.findUsedItems(d),e.length&&(d.attached_gs=e));c.Utils.clearElementId([d]);"sub-column"===f&&(f="column");l.Clipboard.set(f,d)},paste:function(a,b){var d=this.$el,e=this.model,f=e.get("elType"),h=null;"column"===f?f=e.get("component_name"):"module"===f&&(h=e.get("mod_name"));"sub-column"===f&&(f="column");var k="style"===b||null!==b&&b!==q&&b.classList.contains("tb_paste_style"),
g=l.Clipboard.get(f);if(!1===g||!0===k&&"module"===f&&h!==g.mod_name)l.alertWrongPaste();else{c.eventName="row";if(!0===k){var m=ThemifyStyles.getStyleOptions("module"===f?h:f),h="module"===f?"mod_settings":"styling",v=this.getData(d,"column"===f?e.get("component_name"):f),u=function(a){if(-1!==a.indexOf("breakpoint_")||-1!==a.indexOf("_apply_all"))return!0;var b=-1!==a.indexOf("_color")?"color":-1!==a.indexOf("_style")?"style":!1;if(!1!==b){if(b=a.replace("_"+b,"_width"),m[b]!==q&&"border"===m[b].type)return!0}else if(-1!==
a.indexOf("_unit")){if(b=a.replace(/_unit$/ig,"",""),m[b]!==q)return!0}else if(-1!==a.indexOf("_w")){if(b=a.replace(/_w$/ig,"",""),m[b]!==q&&"font_select"===m[b].type)return!0}else if(m[a]!==q&&"radio"===m[a].type)return!0;return!1};v[h]===q&&(v[h]={});for(var w in g[h])m[w]!==q||u(w)?(v[h][w]=g[h][w],m[w]!==q&&(!0===m[w].isFontColor&&g[h][m[w].g+"-gradient"]!==q?v[h][m[w].g+"-gradient"]=g[h][m[w].g+"-gradient"]:(m[w].posId!==q&&g[h][m[w].posId]!==q&&(v[h][m[w].posId]=g[h][m[w].posId]),m[w].repeatId!==
q&&g[h][m[w].repeatId]!==q&&(v[h][m[w].repeatId]=g[h][m[w].repeatId])))):delete g[h][w];g.used_gs!==q&&(v.used_gs=g.used_gs);m=null;g=v;delete g.element_id}"column"===f&&(g.grid_class=c.Utils.filterClass(d.prop("class")),d.hasClass("first")?g.grid_class+=" first":d.hasClass("last")&&(g.grid_class+=" last"),f=d[0].style.width,g.grid_width=f?f.replace("%",""):null,g.component_name=e.get("component_name"));!1===k&&c.Utils.clearElementId([g]);c.hasChanged=!0;c.beforeEvent=l.clone(d);e.setData(g);null!==
c.activeModel&&l.Lightbox.close()}},importExport:function(a,b){var d=b.classList.contains("ti-import")?"import":"export",e=this,f=this.$el,h=this.model,k=h.get("elType"),n=k.charAt(0).toUpperCase()+k.slice(1),m="subrow"===k?"Sub-Row":"sub-column"===k?"Sub-Column":n,n={contructor:!0,loadMethod:"html",data:{component_form:{name:ThemifyConstructor.label[d+"_tab"].replace("%s",n),options:[{id:"tb_data_field",type:"textarea",label:ThemifyConstructor.label.import_label.replace("%s",m),help:ThemifyConstructor.label[d+
"_data"].replace("%s",n),"class":"fullwidth",rows:13}]}}};"import"===d&&(n.save={});l.Lightbox.$lightbox[0].style.display="none";l.Lightbox.open(n,function(){r.document.body.classList.add("tb_standalone_lightbox")},function(){var b=this.$lightbox;b.addClass("tb_import_export_lightbox");this.setStandAlone(a.clientX,a.clientY);if("import"===d)b.find(".builder_save_button").on("click.tb_import",function(a){a.preventDefault();a.stopPropagation();a=b.find("#tb_data_field");a=JSON.parse(a.val());if("column"===
k&&"sub-column"===a.component_name||"sub-column"===k&&"column"===a.component_name)a.component_name=k,a.grid_class=f.closest(".module_column").prop("class");if(a.component_name===q||a.component_name!==k)l.alertWrongPaste();else{var d=a.hasOwnProperty("used_gs")?Object.keys(a.used_gs):[],e=d.length;if(0<e){for(var n=e-1;-1<n;--n){var m=c.GS.findBySlug(d[n]);m&&delete a.used_gs[d[n]];m=null}e&&(c.GS.loadingPosts=!0,g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_import_gs_posts_ajax",
tb_load_nonce:themifyBuilder.tb_load_nonce,data:a.used_gs},success:function(a){for(var b=Object.keys(a),d=b.length-1;-1<d;--d)c.GS.styles[a[b[d]].id]=a[b[d]],"visual"===c.mode&&(c.liveStylingInstance.setCss(c.GS.styles[a[b[d]].id].data,q,c.GS.styles[a[b[d]].id]["class"]),c.GS.styles[a[b[d]].id].cssLoaded=!0);c.GS.loadingPosts=!1}}))}a=c.Utils.clear(a);c.eventName="row";c.beforeEvent=l.clone(f);c.hasChanged=!0;h.setData(a);l.Lightbox.close()}});else{var n=e.getData(f,k);n.component_name=k;var m=c.GS.findUsedItems(n);
if(!1!==m){for(var z={},p=m.length-1;-1<p;--p){var C=c.GS.styles[m[p]];var I="row"===C.type?C.data[0].styling:"column"===C.type?C.data[0].cols[0].styling:C.data[0].cols[0].modules[0].mod_settings;z[C["class"]]={};z[C["class"]].title=C.title;z[C["class"]]["class"]=C["class"];z[C["class"]].type=C.type;z[C["class"]].data=I}Object.keys(z).length&&(n.used_gs=z)}n=JSON.stringify(n);b.find("#tb_data_field").val(n).on("click",function(){g(this).trigger("focus").trigger("select")})}t.body.one("themify_builder_lightbox_close",
function(){b.removeClass("tb_import_export_lightbox");r.document.body.classList.remove("tb_standalone_lightbox");"import"===d&&b.find(".builder_save_button").off("click.tb_import")})})},getData:function(a,b){var d={};switch(b){case "row":case "subrow":d=c.Utils._getRowSettings(a.closest(".module_"+b)[0],b);break;case "module":d=c.Models.Registry.lookup(a.closest(".active_module").data("cid")).attributes;break;case "column":case "sub-column":var d=a.closest(".module_column"),e=d.closest("column"===
b?".module_row":".module_subrow"),d=c.Utils._getRowSettings(e[0],"column"===b?"row":"subrow").cols[d.index()]}return c.Utils.clear(d)},duplicate:function(a,b){var d=this.$el,e=l.clone(d);null!==c.activeModel&&l.Lightbox.$lightbox.is(":visible")&&ThemifyConstructor.saveComponent();d.removeClass("tb_element_cid_"+this.model.cid);e.hide().insertAfter(d);var f=this.getData(e,this.model.get("elType"));c.eventName="duplicate";c.beforeEvent=e;c.hasChanged=!0;this.model.setData(f);d.addClass("tb_element_cid_"+
this.model.cid)},edit:function(a,b){var d;if(c.isPreview&&q===themifyBuilder.globalStyleData)return!0;if(null===c.activeModel||c.GS.isEmpty(c.activeModel.attributes.gs)){var e=d=c.hasChanged=!1,f=l.Lightbox.$lightbox,h=this.model.get("elType"),k=!1,g="module"===h?this.model.get("mod_name"):h;if(null!==a){var m=b.classList;var v=m.contains("tb_dragger")?b.getAttribute("data-id"):null;if(null!==v&&""===b.getAttribute("data-v"))return;"dblclick"===a.type&&this.model.cid!==c.autoSaveCid&&c.ActionBar.clear();
d=null!==v||m.contains("tb_styling");if(!0===d)this.model.set({styleClicked:!0},{silent:!0}),null!==v&&(k=function(a){var b=m.contains("tb_dragger_padding")?"padding":"margin",d="padding"===b?"p":"m",e=ThemifyConstructor.label[d],f=q;if("module"===h&&(f=a.getElementsByClassName("tb_styling_tab_nav")[0],f!==q)){if(c.EdgeDrag.modules[g]!==q&&c.EdgeDrag.modules[g][b]!==q&&(v=v.replace(/_left|_right|_bottom|_top$/ig,""),c.EdgeDrag.modules[g][b][v]!==q&&(b=c.EdgeDrag.getTabId(ThemifyConstructor.data[g].styling.options.options,
v,d),null!==b))){for(var d=f.getElementsByClassName("tb_tab_wrapper")[0].getElementsByTagName("a"),k=d.length-1;-1<k;--k)if(d[k].getAttribute("href")==="#tb_1_"+b){d[k].click();break}d=null}b=f.getElementsByClassName("current")[0].getElementsByTagName("a")[0].getAttribute("href");f=a.querySelector(b)}f===q&&(f=a);for(var n=f.getElementsByClassName("tb_style_toggle"),k=n.length-1;-1<k;--k)if(n[k].textContent===e){n[k].classList.contains("tb_closed")&&n[k].click();setTimeout(function(){n[k].closest(".simplebar-scroll-content").scrollTop=
n[k].offsetTop;n=null},10);break}});else if(m.contains("tb_visibility_component"))e=!0,this.model.set({visibileClicked:!0},{silent:!0});else if(!0===(m.contains("tb_swap")?!1:"layout-part"===g?!0:t.body.triggerHandler("tb_edit_"+g,[a,this.el,this.model]))&&"visual"===c.mode&&!c.Forms.LayoutPart.id&&("dblclick"===a.type||m.contains("tb_edit"))){c.activeModel=this.model;c.Forms.LayoutPart.edit(this.el);return}}c.GS.isEmpty(this.model.attributes.gs)&&q===themifyBuilder.globalStyleData||(d=!0,this.model.set({styleClicked:!0},
{silent:!0}));null!==c.activeModel&&null!==c.autoSaveCid&&this.model.cid!==c.autoSaveCid&&ThemifyConstructor.saveComponent(!0);c.activeModel=this.model;if(c.autoSaveCid===this.model.cid){var u=null;if(!0===d)u=f.find('a[href="#tb_options_styling"]'),this.model.unset("styleClicked",{silent:!0});else if(!0===e)u=f.find('a[href="#tb_options_visibility"]'),this.model.unset("visibileClicked",{silent:!0});else if("module"===h||"row"===h)u=f.find('a[href="#tb_options_setting"]');null!==u&&0<u.length&&(u[0].click(),
!1!==k&&!0===d&&k(l.Lightbox.$lightbox[0].querySelector("#tb_lightbox_container")))}else l.Lightbox.open({loadMethod:"inline",templateID:g},!1,k),"row"!==g&&l.Lightbox.$lightbox[0].getElementsByClassName("tb_action_breadcrumb")[0].appendChild(c.ActionBar.getBreadCrumbs(c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_element_cid_"+this.model.cid)[0]))}else c.GS.saveLiveEdit({model:this.model,e:a,target:b})},"delete":function(a,b){var d,e=this.$el,f=this.model,h=f.cid,k=f.get("elType");
if(confirm(themifyBuilder.i18n[k+"DeleteConfirm"])){var n=e.closest(".module_row"),m="row",v="",u={},q=h;"row"===k?(u.pos_cid=n.next(".module_row"),u.pos="before",0===u.pos_cid.length&&(u.pos="after",u.pos_cid=n.prev(".module_row")),m="delete_row",u.pos_cid=u.pos_cid.data("cid")):h=n.data("cid");n=l.clone(n);"row"!==k&&(d=e.closest(".module_subrow"));f.destroy();"row"!==k&&0<d.length&&0===d.find(".active_module").length&&d.addClass("tb_row_empty");"row"!==k&&(v=g(".tb_element_cid_"+h),d=v.closest(".module_row"),
0===d.find(".active_module").length&&d.addClass("tb_row_empty"));c.hasChanged=!0;c.undoManager.push(h,n,v,m,u);null!==c.activeModel&&c.activeModel.cid===q&&l.Lightbox.$lightbox.find(".tb_close_lightbox")[0].click();c.toolbar.pageBreakModule.countModules()}},save:function(a){null!==c.activeModel&&null!==c.autoSaveCid&&ThemifyConstructor.saveComponent(!0);var b=this.model.get("elType"),d={contructor:!0,loadMethod:"html",save:{done:"save"},data:{}},e=this.model.cid;d.data["s"+b]={options:[{id:"item_title_field",
type:"text",label:ThemifyConstructor.label.title},{id:"item_layout_save",type:"checkbox",label:"",options:[{name:"layout_part",value:ThemifyConstructor.label.slayout_part}],new_line:!1,after:"",help:'Any changes made to a Layout Part are saved and reflected everywhere else they are being used (<a href="https://themify.me/docs/builder#layout-parts" target="_blank">learn more</a>)'}]};l.Lightbox.$lightbox[0].style.display="none";l.Lightbox.open(d,function(){r.document.body.classList.add("tb_standalone_lightbox")},
function(d){var f=this.$lightbox,k=function(a){if("keypress"!==a.type||13===a.keyCode){a.preventDefault();a.stopPropagation();l.showLoader("show");a=c.Models.Registry.lookup(e);switch(b){case "row":var f=b;var h=c.Utils._getRowSettings(g(".tb_element_cid_"+e)[0]);c.Utils.clearElementId([h],!0);break;case "module":f=a.get("mod_name"),h={mod_name:f,element_id:c.Utils.generateUniqueID(),mod_settings:a.get("mod_settings")}}f=ThemifyStyles.createCss([h],f);h=c.Utils.clear(h);if(Object.keys(c.GS.styles).length){var k=
c.GS.findUsedItems(h);!1!==k&&(f=c.GS.attachCSS(f,k))}f=g.extend(c.Forms.serialize(d),{action:"tb_save_custom_item",item:JSON.stringify(h),css:JSON.stringify(f),tb_load_nonce:themifyBuilder.tb_load_nonce,postid:themifyBuilder.post_ID,type:b});if(k!==q&&!1!==k)for(f.usedGS=[],a=k.length-1;-1<a;--a)f.usedGS.push(c.GS.styles[k[a]]["class"]);var n=f.item_layout_save;g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:f,success:function(a){h=null;if("success"===a.status){g("#tb_module_panel",
r.document).find(".tb_module_panel_search_text").val("");if(n){c.hasChanged=!0;var d={mod_name:"layout-part",mod_settings:{selected_layout_part:a.post_name}};delete a.status;0<ThemifyConstructor.layoutPart.data.length&&ThemifyConstructor.layoutPart.data.push(a);var f=g(".tb_element_cid_"+e),k=l.clone(f);if("row"===b){d=c.Views.init_row({cols:[{grid_class:"col-full first last",element_id:c.Utils.generateUniqueID(),modules:[d]}]});var m=d.view.render();d=c.Models.Registry.lookup(m.$el.find(".active_module").data("cid"))}else d=
c.Views.init_module(d),m=d.view.render(),d=d.model;f.replaceWith(m.el);if("visual"===c.mode)g(p).ajaxComplete(function F(a,d,e){-1!==e.data.indexOf("tb_load_module_partial",3)&&(g(this).off("ajaxComplete",F),v="row"===b?c.liveStylingInstance.$liveStyledElmt.closest(".module_row"):c.liveStylingInstance.$liveStyledElmt,c.undoManager.push(m.$el.data("cid"),k,v,"row"))}),d.trigger("custom:preview:refresh",d.get("mod_settings"));else{var v=m.el;c.Mixins.Builder.updateModuleSort(m.$el);c.undoManager.push(m.$el.data("cid"),
k,v,"row")}}f=g(".tb_library_item_list");a=c.toolbar.libraryItems.template([a]);"visual"===c.mode&&(f=f.add(c.toolbar.$el.find(".tb_library_item_list")));f=f.get();d=0;for(var u=f.length;d<u;++d){var q=f[d].getElementsByClassName("simplebar-content");0<q.length?q[0].insertAdjacentHTML("afterbegin",a):f[d].insertAdjacentHTML("afterbegin",a);f[d].previousElementSibling.getElementsByClassName("current")[0].click()}c.toolbar.libraryItems.bindEvents(!0);l.showLoader("hide");l.Lightbox.close()}else alert(a.msg)}})}};
f.addClass("tb_save_module_lightbox");this.setStandAlone(a.clientX,a.clientY);f.on("click.saveLayout",".builder_save_button",k).on("keypress.saveLayout","input",k);t.body.one("themify_builder_lightbox_close",function(){f.removeClass("tb_save_module_lightbox").off(".saveLayout");r.document.body.classList.remove("tb_standalone_lightbox")})})}});c.Views.BaseElement.extend=function(a){var b=this,d=y.View.extend.apply(this,arguments);d.prototype.events=_.extend({},this.prototype.events,a.events);d.prototype.initialize=
function(){"function"===typeof b.prototype.initialize&&b.prototype.initialize.apply(this,arguments);"function"===typeof a.initialize&&a.initialize.apply(this,arguments)};return d};c.Views.Modules["default"]=c.Views.BaseElement.extend({tagName:"div",attributes:function(){var a=this.model.get("mod_settings"),b={"data-cid":this.model.cid,"class":"active_module module-"+this.model.get("mod_name")+" tb_"+this.model.get("element_id")+" tb_element_cid_"+this.model.cid};if("visual"===c.mode){b["class"]+=
" tb_module_front";if("hide_all"===a.visibility_all||"hide"===a.visibility_desktop||"hide"===a.visibility_tablet||"hide"===a.visibility_tablet_landscape||"hide"===a.visibility_mobile)b["class"]+=" tb_visibility_hidden";var d=a.hasOwnProperty("global_styles")?" "+a.global_styles:"",d=""==d&&null!==ThemifyConstructor.styles&&ThemifyConstructor.styles.hasOwnProperty("global_styles")?" "+ThemifyConstructor.styles.global_styles:d;b["class"]+=d}else b["class"]+=" tb_module";a.custom_css_id!==q&&""!==a.custom_css_id&&
(b.id=a.custom_css_id);return b},template:"visual"===c.mode?null:wp.template("builder_module_item"),initialize:function(){this.listenTo(this.model,"dom:module:unsaved",this.removeUnsaved)},removeUnsaved:function(){this.model.destroy()},render:function(){"visual"!==c.mode&&(this.el.innerHTML=this.template(this.model.toRenderData()));return this}});c.Views.Columns["default"]=c.Views.BaseElement.extend({tagName:"div",attributes:function(){var a={"class":"module_column tb-column tb_element_cid_"+this.model.cid+
" tb_"+this.model.get("element_id")+" "+this.model.get("grid_class"),"data-cid":this.model.cid};this.model.get("grid_width")&&(a.style="width:"+this.model.get("grid_width")+"%");"column"!==this.model.get("component_name")&&(a["class"]+=" sub_column");return a},render:function(){var a=this.model.get("component_name");this.el.innerHTML=l.templateCache.get("tmpl-builder_column_item");var b=this.model.get("modules");if(b){var d=p.createDocumentFragment(),e;for(e in b)if(b[e]!==q&&null!==b[e]){var f=b[e];
(f=f.cols===q?c.Views.init_module(f):c.Views.init_subrow(f))&&d.appendChild(f.view.render().el)}b=this.el.getElementsByClassName("tb_holder")[0];b.appendChild(d);"sub-column"===a&&b.classList.add("tb_subrow_holder")}return this}});c.Views.SubRows["default"]=c.Views.BaseElement.extend({tagName:"div",attributes:function(){return{"class":"themify_builder_sub_row module_subrow active_module clearfix tb_element_cid_"+this.model.cid+" tb_"+this.model.get("element_id"),"data-cid":this.model.cid}},render:function(){var a=
this.model.get("cols"),b=Object.keys(a).length;this.el.innerHTML=l.templateCache.get("tmpl-builder_subrow_item");if(0<b){for(var d=p.createDocumentFragment(),e=!1,f=0;f<=b;++f)a[f]!==q&&(a[f].component_name="sub-column",d.appendChild(c.Views.init_column(a[f]).view.render().el),!1===e&&a[f].modules!==q&&0<a[f].modules.length&&(e=!0));!1===e&&this.el.classList.add("tb_row_empty");this.el.getElementsByClassName("subrow_inner")[0].appendChild(d)}c.Utils.selectedGridMenu(this.el,"subrow");return this}});
c.Views.Rows["default"]=c.Views.BaseElement.extend({tagName:"div",attributes:function(){var a=this.model.get("styling"),b={"class":"themify_builder_row module_row clearfix tb_element_cid_"+this.model.cid+" tb_"+this.model.get("element_id"),"data-cid":this.model.cid};null!==a&&(a.custom_css_row!==q&&""!==a.custom_css_row&&(b["class"]+=" "+a.custom_css_row),a.custom_css_id!==q&&""!==a.custom_css_id&&(b.id=a.custom_css_id));return b},render:function(){var a=this.model.get("cols"),b=Object.keys(a).length,
d=!1;this.el.innerHTML=l.templateCache.get("tmpl-builder_row_item");if(0<b){for(var e=p.createDocumentFragment(),f=0;f<=b;++f)a[f]!==q&&(a[f].component_name="column",e.appendChild(c.Views.init_column(a[f]).view.render().el),!1===d&&a[f].modules!==q&&(0<a[f].modules.length||"object"===typeof a[f].modules&&0<Object.keys(a[f].modules).length)&&(d=!0));this.el.getElementsByClassName("row_inner")[0].appendChild(e)}else c.Utils._addNewColumn({newclass:"col-full",component:"column"},this.el.getElementsByClassName("row_inner")[0]);
!1===d&&this.el.classList.add("tb_row_empty");c.Utils.selectedGridMenu(this.el,"row");return this}});c.Views.Builder=y.View.extend({type:"default",lastRow:null,events:{"click .tb_import_layout_button":"importLayoutButton"},initialize:function(){this.$el.off("tb_init tb_new_row").on("tb_init",this.init.bind(this)).on("tb_init",this.newRowAvailable.bind(this))},init:function(a){c.Mixins.Builder.rowSort(this.$el);"visual"===c.mode?(c.Mixins.Builder.updateModuleSort(this.$el),setTimeout(function(){c.Utils._onResize(!0)},
1500)):(c.Mixins.Builder.updateModuleSort(this.$el),c.Mixins.Builder.initModuleDraggable(c.toolbar.$el.find(".tb_module_panel_modules_wrap").first(),".tb_module"),c.Mixins.Builder.initModuleDraggable(c.toolbar.$el,".tb_row_grid"));var b=this;setTimeout(function(){c.ActionBar.init();c.Utils.setCompactMode(b.el.getElementsByClassName("module_column"));b.insertLayoutButton();c.GS.init()},1E3);D={}},render:function(){var a=p.createDocumentFragment(),b=this.collection;c.Utils.clearLastEmptyRow(b.models);
for(var d=0,e=b.models.length;d<e;++d){var f=c.Views.init_row(b.models[d]);!1!==f&&a.appendChild(f.view.render().el)}this.el.appendChild(a);c.Utils.columnDrag(!1,!1);return this},insertLayoutButton:function(){this.removeLayoutButton();this.lastRowAddBtn();var a=this.el.getElementsByClassName("module_row");2>a.length&&a[0]!==q&&a[0].classList.contains("tb_row_empty")&&(a=p.createElement("a"),a.className="tb_import_layout_button",a.href="#",a.textContent=themifyBuilder.i18n.text_import_layout_button,
this.el.appendChild(a))},removeLayoutButton:function(){for(var a=this.el.getElementsByClassName("tb_import_layout_button"),b=a.length-1;-1<b;--b)a[b].parentNode.removeChild(a[b])},importLayoutButton:function(a){c.Views.Toolbar.prototype.loadLayout(a)},newRowAvailable:function(a,b){var d=this.el.children,e=!0,f=d.length;a=a||1;if(0!==f&&!0!==b)for(--f;-1<f;--f)if(d[f].classList.contains("module_row")){e=!1;break}if(!0===e)return d=c.Views.init_row(c.Utils.grid(a)[0]).view.render().$el,d[0].className+=
" tb_new_row",this.el.insertBefore(d[0],this.lastRow),c.Utils.setCompactMode(d[0].getElementsByClassName("module_column")),c.Mixins.Builder.update(d),"visual"===c.mode&&"desktop"!==c.activeBreakPoint&&g("body",r.document).height(p.body.scrollHeight),d},lastRowShowHide:function(a){this.lastRow&&(a?this.lastRow.classList.remove("hide"):(this.lastRow.classList.remove("expanded"),this.lastRow.classList.add("hide")))},lastRowAddBtn:function(){var a=p.getElementById("tb_add_container");null!==a&&a.parentNode.removeChild(a);
this.lastRow=p.createElement("div");var a=p.createElement("div"),b=null;this.lastRow.id="tb_add_container";a.className="tb_last_add_btn";a.textContent="+";this.lastRow.appendChild(a);this.lastRow.addEventListener("click",function(a){a.preventDefault();var d=a.target,f=d.closest(".tb_row_grid");null!==f?(this.classList.remove("expanded"),c.Mixins.Builder.rowDrop(c.Utils.grid(f.dataset.col),g("<div>").insertBefore(this),!0,!0)):d.classList.contains("tb_add_blocks")?(this.classList.remove("expanded"),
c.toolbar.common.show(a,g(this).find(".tb_last_add_btn")),c.toolbar.common.clicked=this.previousElementSibling?g(this.previousElementSibling):null,c.toolbar.common.btn[0].querySelector('[data-target="tb_module_panel_rows_wrap"]').click()):d.classList.contains("tb_last_add_btn")&&(null===b&&(b=!0,a=l.is_template_support?p.getElementById("tmpl-last_row_add_btn").content.cloneNode(!0):l.templateCache.get("tmpl-last_row_add_btn"),l.is_template_support?this.appendChild(a):this.insertAdjacentHTML("beforeend",
a)),this.classList.add("expanded"))});a=null;this.el.appendChild(this.lastRow)}});c.Mixins.Builder={before:null,zindex:null,r:null,w:null,h:null,type:null,moduleHolderArgs:null,isFullWidth:null,update:function(a){if("visual"===c.mode){var b=null!==c.activeModel?c.activeModel.get("elType"):c.Models.Registry.lookup(a.data("cid")).get("elType");c.Utils.loadContentJs(a,b)}a=a.closest(".module_row");c.Utils.columnDrag(a.find(".row_inner"),!1);c.Utils.columnDrag(a.find(".subrow_inner"),!1);c.Mixins.Builder.updateModuleSort(a)},
dragScroll:function(a,b){function d(a,b){n=!0;if(null===k){k=!0;var c=this!==q?this.id:null;c||(c=b);var e=("tb_toolbar"===c||"wpadminbar"===c?"-":"+")+("="+h*m+"px");f.stop().animate({scrollTop:e},{duration:500,complete:function(){!0===n&&(10>m&&++m,k=null,d(null,c))}})}}var e=g("body",r.document);"visual"===c.mode&&(e=e.add(t.body));this.top===q&&(this.top=c.toolbar.$el,this.top=this.top.add(g("#tb_fixed_bottom_scroll",r.document)),"visual"!==c.mode&&(this.top=this.top.add("#wpadminbar")));if(!0===
b)this.top.off("mouseenter mouseleave"),"row"===a&&"visual"===c.mode&&c.toolbar.$el.find('.tb_zoom[data-zoom="100"]').trigger("click"),e.removeClass("tb_drag_start tb_drag_"+a);else{var f=null,h=50,k=null,n=!0,m=1;"visual"!==c.mode&&(f=g(".edit-post-layout__content").first(),0===f.length?f=null:h/=2);null===f&&(f="desktop"===c.activeBreakPoint?g("body,html"):g("body,html",r.document));e.addClass("tb_drag_start tb_drag_"+a);"row"===a&&"visual"===c.mode&&c.toolbar.$el.find('.tb_zoom[data-zoom="50"]').trigger("click");
if(0<h)this.top.off("mouseenter").on("mouseenter",d).off("mouseleave").on("mouseleave",function(){m=1;k=n=null;f.stop()})}},columnSort:function(a){var b,d;a.find(".row_inner, .subrow_inner").sortable({items:"> .module_column",handle:"> .tb_column_action .tb_column_dragger",axis:"x",placeholder:"tb_state_highlight",tolerance:"pointer",cursorAt:{top:20,left:20},beforeStart:function(a,c,h){t.body.addClass("tb_drag_start");b=l.clone(h.item.closest(".module_row"));d=h.item.siblings();d.css("marginLeft",
0)},start:function(a,b){g(".tb_state_highlight").width(b.item.width())},stop:function(a,b){t.body.removeClass("tb_drag_start");d.css("marginLeft","")},update:function(a,d){var e=d.item.closest(".ui-sortable"),f=e.children(".module_column");f.removeClass("first last");e[0].classList.contains("direction-rtl")?(f.last().addClass("first"),f.first().addClass("last")):(f.first().addClass("first"),f.last().addClass("last"));c.Utils.columnDrag(e,!1);c.Utils.setCompactMode(f);e=e.closest(".module_row");c.undoManager.push(e.data("cid"),
b,e,"row")}})},rowSort:function(a){var b=this,d,e={items:">.module_row",handle:">.tb_row_action",axis:"y",placeholder:"tb_state_highlight",containment:"visual"===c.mode?"parent":"body",tolerance:"pointer",forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!1,beforeStart:function(a,e,k){b.before||(c.ActionBar.hoverCid=null,d=c.ActionBar.disable=!0,b.before=k.item.next(".module_row"),0===b.before.length&&(b.before=k.item.prev(".module_row"),d=!1),b.before=b.before.data("cid"),b.dragScroll("row"))},start:function(){a.sortable("refreshPositions")},
stop:function(a,e){c.ActionBar.disable=null;b.before=d=null;b.dragScroll("row",!0)},update:function(a,e){if("visual"===c.mode&&!e.item[0].classList.contains("tb_row_grid")){var f="desktop"===c.activeBreakPoint?g("html,body"):g("body",r.document);f.scrollTop(e.item.offset().top);f=null}if("sortupdate"===a.type&&b.before){c.hasChanged=!0;var f=e.item.next(".module_row"),h=!0;0===f.length&&(f=e.item.prev(".module_row"),d=h=!1);f=f.data("cid");c.undoManager.push(e.item.data("cid"),null,null,"row_sort",
{bnext:d,before:b.before,anext:h,after:f})}else e.item[0].classList.contains("predesigned_row")||e.item[0].classList.contains("tb_page_break_module")||"row"===e.item.data("type")?"row"===e.item.data("type")?c.toolbar.libraryItems.get(e.item.data("id"),"row",function(a){Array.isArray(a)||(a=Array(a));b.rowDrop(a,e.item)}):e.item[0].classList.contains("tb_page_break_module")?(b.rowDrop(c.toolbar.pageBreakModule.get(),e.item),c.toolbar.pageBreakModule.countModules()):c.toolbar.preDesignedRows.get(e.item.data("slug"),
function(a){b.rowDrop(a,e.item)}):e.item[0].classList.contains("tb_row_grid")&&b.subRowDrop(e.item.data("slug"),e.item)}};"visual"===c.mode&&(e.helper=function(){return g('<div class="tb_sortable_helper"/>')});a.sortable(e)},updateModuleSort:function(a,b){if(q===themifyBuilder.globalStyleData){var d=g(".tb_holder",a),e=this;if(b)return d.sortable(b),!1;d.each(function(){g(this).data({uiSortable:null,sortable:null})});this.moduleHolderArgs={placeholder:"tb_state_highlight",items:">.active_module,>div>.active_module",
connectWith:".tb_holder",revert:100,scroll:!1,cancel:".tb_disable_sorting,.tb_action_wrap:not(.tb_subrow_action)",cursorAt:{top:10,left:90},beforeStart:function(a,b,d){c.ActionBar.disable=!0;c.ActionBar.hoverCid=null;e.before||(e.r=d.item.closest(".module_row"),0<e.r.length?(e.before=l.clone(e.r),e.zindex=e.r.css("zIndex"),"auto"===e.zindex&&(e.zindex=""),e.r.css("zIndex",2)):e.r=null,e.w=d.item[0].style.width,e.h=d.item[0].style.height,d.item.css({width:180,height:30}),e.type="module",d.item[0].classList.contains("module_subrow")?
e.type+=" tb_drag_subrow":d.item[0].classList.contains("tb_row_grid")&&(e.type="column"),e.dragScroll(e.type))},start:function(a,b){if(b.item[0].classList.contains("module_subrow")||b.item[0].classList.contains("tb_row_grid"))g(".tb_subrow_holder").sortable("disable"),g(".tb_holder").sortable("refresh")},stop:function(a,b){c.ActionBar.disable=null;c.ActionBar.clear();"visual"===c.mode&&b.helper&&g(b.helper).remove();b.item.css({width:e.w,height:e.h,display:""});e.dragScroll(e.type,!0);e.r&&e.r.css("zIndex",
e.zindex);if(b.item[0].classList.contains("module_subrow")||b.item[0].classList.contains("tb_row_grid"))g(".tb_subrow_holder").sortable("enable"),g(".tb_holder").sortable("refresh");e.before=e.w=e.h=e.r=e.zindex=e.type=null},update:function(a,b){b.item.css({width:e.w,height:e.h});if(b.item[0].classList.contains("tb_module_dragging_helper")){var f=g(b.item.clone(!1));if(b.item.data("id")){var h=b.item.closest(".module_row");0<h.length&&(e.before=l.clone(h),e.before.find(".tb_module_dragging_helper").remove())}b.item.after(f);
e.moduleDrop(f,null,e.before)}else{if(b.sender&&(f=b.sender.closest(".module_row"),b.sender.closest(".module_row").toggleClass("tb_row_empty",0===f.find(".active_module").length),f=b.sender.closest(".module_subrow"),0<f.length&&f.toggleClass("tb_row_empty",0===f.find(".active_module").length),b.item[0].classList.contains("module_subrow")&&0<b.item.parent().closest(".module_subrow").length)){d.sortable("cancel");return}e.before&&(c.hasChanged=!0,b.item[0].classList.contains("module_subrow")||b.item.closest(".module_subrow").removeClass("tb_row_empty"),
f=b.item.closest(".module_row"),f.removeClass("tb_row_empty"),c.undoManager.push(b.item.data("cid"),e.before,f,"sort",{before:e.before.data("cid"),after:f.data("cid")}),e.before=null,t.body.triggerHandler("tb_"+e.type+"_sort",[b.item]))}}};"visual"===c.mode&&(this.moduleHolderArgs.helper=function(){return g('<div class="tb_sortable_helper"/>')});d.sortable(this.moduleHolderArgs)}},initModuleDraggable:function(a,b){var d=this,e=g.extend(!0,{},this.moduleHolderArgs);e.update=!1;e.appendTo=p.body;e.items=
b;".tb_row_grid"===b&&(e.connectWith=[e.connectWith,"visual"===c.mode?"#themify_builder_content-"+themifyBuilder.post_ID:"#tb_row_wrapper"]);e.stop=function(b,c){g(this).sortable("cancel");c.item.removeClass("tb_sortable_helper tb_module_dragging_helper");d.moduleHolderArgs.stop(b,c);c.item[0].classList.contains("tb_row_grid")&&a.sortable("refresh")};e.start=function(b,c){c.item.addClass("tb_sortable_helper tb_module_dragging_helper");d.moduleHolderArgs.start(b,c);c.item[0].classList.contains("tb_row_grid")&&
a.sortable("refresh")};e.helper=function(a,b){return g('<div class="tb_sortable_helper tb_module_dragging_helper">'+b.text()+"</div>")};a.sortable(e)},initRowDraggable:function(a,b){var d=this;a.find(b).draggable({appendTo:t.body,helper:"clone",revert:"invalid",connectToSortable:"visual"===c.mode?"#themify_builder_content-"+themifyBuilder.post_ID:"#tb_row_wrapper",cursorAt:{top:10,left:40},start:function(a,b){d.dragScroll("row");b.helper.addClass("tb_module_dragging_helper tb_sortable_helper").find(".tb_predesigned_rows_image").remove()},
stop:function(a,b){d.dragScroll("row",!0)}})},initModuleVisualDrag:function(a){var b=this;c.toolbar.$el.find(a).ThemifyDraggable({iframe:"#tb_iframe",dropitems:".tb_holder",elements:".active_module",type:"module",onDragBefore:function(a,b){c.ActionBar.disable=!0},onDragEnd:function(){c.ActionBar.disable=null},onDrop:function(a,c,f){b.moduleDrop(c,!1,l.clone(f.closest(".module_row")))}})},initRowGridVisualDrag:function(){var a=this;c.toolbar.$el.find(".tb_row_grid").ThemifyDraggable({iframe:"#tb_iframe",
dropitems:".tb_holder:not('.tb_subrow_holder'),.themify_builder_content:not('.not_editable_builder')>.module_row",elements:".active_module",cancel:".tb_subrow_holder",append:!1,type:"column",onDragBefore:function(a,d){c.ActionBar.disable=!0},onDragEnd:function(){c.ActionBar.disable=null},onDrop:function(b,d,c){a.subRowDrop(d.data("slug"),d)}})},initRowVisualDrag:function(a){var b=this;c.toolbar.$el.find(a).ThemifyDraggable({iframe:"#tb_iframe",dropitems:".themify_builder_content:not('.not_editable_builder')>.module_row",
append:!1,type:"row",onDragBefore:function(a,b){c.ActionBar.disable=!0;c.toolbar.$el.find('.tb_zoom[data-zoom="50"]').click()},onDragEnd:function(){c.ActionBar.disable=null},onDrop:function(a,e,f){e.addClass("tb_state_highlight").find(".tb_predesigned_rows_image").remove();e.show();c.Utils.setCompactMode(e.offset().top);"row"===e.data("type")?c.toolbar.libraryItems.get(e.data("id"),"row",function(a){if(!Array.isArray(a)){a=Array(a);var d=c.GS.findUsedItems(a);d.length&&(a[0].used_gs=d)}b.rowDrop(a,
e)}):e[0].classList.contains("tb_page_break_module")?(b.rowDrop(c.toolbar.pageBreakModule.get(),e),c.toolbar.pageBreakModule.countModules()):c.toolbar.preDesignedRows.get(e.data("slug"),function(a){b.rowDrop(a,e)})}})},subRowDrop:function(a,b){c.ActionBar.clear();var d=0<b.parent(".themify_builder_content,#tb_row_wrapper").length;if(d||0===b.closest(".sub_column").length){a=c.Utils.grid(a);if(!d){var e=l.clone(b.closest(".module_row"));e.find(".tb_row_grid").remove();var f="row"}var h=(d?c.Views.init_row({cols:a[0].cols}):
c.Views.init_subrow({cols:a[0].cols})).view.render().$el;if(d||b[0].parentNode.classList.contains("tb_holder")||b[0].parentNode.parentNode.classList.contains("tb_holder"))b[0].parentNode.replaceChild(h[0],b[0]),h[0].className+=" tb_element_selected",c.ActionBar.type="subrow";else{var k=b.next(".tb_holder");0<k.length?k.prepend(h):(k=b.prev(".tb_holder"),k.append(h))}if(d){e=h.next(".module_row");var g=!0;0===e.length&&(g=!1,e=h.prev(".module_row"));e=e.data("cid");f="grid_sort"}c.Utils.setCompactMode(h[0].getElementsByClassName("module_column"));
c.Mixins.Builder.update(h);b.remove();c.hasChanged=!0;k=h.closest(".module_row");d||k.removeClass("tb_row_empty");k.find(".tb_row_grid").remove();c.Utils.scrollToDropped(h[0]);c.undoManager.push(k.data("cid"),e,k,f,{next:g})}else b.remove()},rowDrop:function(a,b,d,e){function f(){var a=b.prev(".module_row");if(0===a.length){var d="visual"===c.mode?b.closest(".themify_builder_content").data("postid"):null;a=!1}else a=a.data("cid");b[0].innerHTML="";c.ActionBar.type="row";b[0].parentNode.replaceChild(k,
b[0]);c.hasChanged=!0;c.Instances.Builder[c.builderIndex].removeLayoutButton();c.undoManager.push("","","","predesign",{prev:a,rows:g,bid:d});a=0;for(d=g.length;a<d;++a){var e=g[a][0].getElementsByClassName("module_column");0===a&&g[a][0].classList.add("tb_element_selected");c.Utils.setCompactMode(e);c.Mixins.Builder.update(g[a])}c.Utils.scrollToDropped(g[0][0]);l.showLoader("hide")}c.ActionBar.clear();var h=function(a){for(var b in a)if(a[b].styling&&0<Object.keys(a[b].styling).length||a[b].modules&&
0<Object.keys(a[b].modules).length)return!0;return!1},k=p.createDocumentFragment(),g=[],m=[];e||c.Utils.clearLastEmptyRow(a);e=0;for(var v=a.length;e<v;++e)if(!0===d||a[e].styling&&0<Object.keys(a[e].styling).length||a[e].cols&&h(a[e].cols)){var u=c.Views.init_row(a[e]);if(!1!==u){u=u.view.render();k.appendChild(u.el);if("visual"===c.mode){var q=u.el.querySelectorAll("[data-cid]");m[u.el.dataset.cid]=1;e=0;for(v=q.length;e<v;++e)m[q[e].dataset.cid]=1}g.push(u.$el)}}"visual"===c.mode?(c.bootstrap(m,
f),m=null):f()},moduleDrop:function(a,b,d){function e(e){function f(e){k||g.model.set({is_new:1},{silent:!0});e=!0===e?g.model.getPreviewSettings():g.model.get("mod_settings");b?b.hasClass("tb_module_front")?b.after(n.el):b.append(n.el):a.replaceWith(n.el);k?c.activeModel=g.model:g.model.trigger("edit",null);c.hasChanged=!0;if("visual"===c.mode&&1<=Object.keys(e).length&&"layout-part"!==g.model.get("mod_name")){var f=e.cid;if("part"===h||"ajax"===a.data("type")){var m=!0;g.model.trigger("custom:preview:refresh",
e)}else"module"!==h?g.model.trigger("custom:preview:live",e):c.Utils.loadContentJs(n.$el,"module")}k&&(m&&(m=g.view.$el.find(".tb_preview_component").detach(),g.view.$el.prepend(m)),d&&(f=n.$el.closest(".module_row"),f.removeClass("tb_row_empty").find(".tb_module_dragging_helper").remove(),n.$el.closest(".module_subrow").removeClass("tb_row_empty"),c.undoManager.push(f.data("cid"),d,f,"row"),f=f.data("cid"),c.Instances.Builder[c.builderIndex].removeLayoutButton(),c.activeModel=null));c.Utils.scrollToDropped(null,
f)}var g=c.Views.init_module(e,!0),n=g.view.render();"visual"===c.mode&&k?(e=[],e[g.model.cid]=1,c.bootstrap(e,f)):f(!0);return n}c.ActionBar.clear();if(a[0].classList.contains("tb_row_grid"))this.subRowDrop(a.data("slug"),a);else{var f={mod_name:a.data("module-slug")},h=a.data("type"),k="part"===h||"module"===h;if(k)c.toolbar.libraryItems.get(a.data("id"),h,e);else return e(f);"visual"!==c.mode&&g(".themify-wp-editor-holder").addClass("themify-active-holder")}},toJSON:function(a){var b=[];a=a.children;
for(var d=0,e=a.length;d<e;++d)if(a[d].classList.contains("module_row")){var f=c.Utils._getRowSettings(a[d]);0<Object.keys(f).length&&b.push(f)}return b},columnHover:function(a){for(var b=a.closest(".sub_column"),d=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_hover_sub_column"),e=d.length-1;-1<e;--e)d[e].classList.remove("tb_hover_sub_column");d=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_action_overlap");for(e=d.length-1;-1<e;--e)d[e].classList.remove("tb_action_overlap");
if(null!==b){var f=b.parentNode.closest(".module_column");if(!f.classList.contains("tb_hover_sub_column")&&(f.classList.add("tb_hover_sub_column"),d=b.getElementsByClassName("tb_column_action")[0],d!==q)){var e=d.getBoundingClientRect(),h=!0,f=5>e.left?f.closest(".module_row").getElementsByClassName("tb_row_action")[0]:b.closest(".module_subrow").getElementsByClassName("tb_subrow_action")[0];f!==q&&(h=f.getBoundingClientRect(),h=Math.abs(e.left-h.left)<e.width?Math.abs(h.top-e.top)>e.height:!0);!0===
h?d.classList.remove("tb_action_overlap"):d.classList.add("tb_action_overlap")}}!0!==this.isFullWidth&&(b=null!==b?b.parentNode.closest(".module_column"):a.closest(".module_column"),!1!==this.isFullWidth&&(a=null!==b?b.closest(".module_row"):a.closest(".module_row"),null!==a&&(a.offsetWidth<p.body.clientWidth?(this.isFullWidth=!0,p.body.classList.remove("tb_page_row_fullwidth")):(this.isFullWidth=!1,p.body.classList.add("tb_page_row_fullwidth")))),null!==b&&null!==b.parentNode.parentNode.closest(".fullwidth")&&
(a=b.getElementsByClassName("tb_column_action")[0],a!==q&&a.getBoundingClientRect().right>=p.body.clientWidth&&a.classList.add("tb_action_outside")))}};c.undoManager={stack:[],is_working:!1,index:-1,btnUndo:null,btnRedo:null,compactBtn:null,init:function(){this.btnUndo=c.toolbar.el.getElementsByClassName("tb_undo_btn")[0];this.btnRedo=c.toolbar.el.getElementsByClassName("tb_redo_btn")[0];this.compactBtn=c.toolbar.el.getElementsByClassName("tb_compact_undo")[0];c.toolbar.$el.find(".tb_undo_redo").on("click",
this.do_change.bind(this));if(!themifyBuilder.disableShortcuts&&(g(r.document).on("keydown",this.keypres.bind(this)),"visual"===c.mode))g(p).on("keydown",this.keypres.bind(this))},push:function(a,b,d,e,f){c.hasChanged&&(c.editing=!1,d&&(d=l.clone(d)),"visual"!==c.mode||"duplicate"!==e&&"sort"!==e||g(x).triggerHandler("tfsmartresize.tfVideo"),this.stack.splice(this.index+1,this.stack.length-this.index),this.stack.push({cid:a,type:e,data:f,before:b,after:d}),this.index=this.stack.length-1,this.updateUndoBtns(),
"visual"===c.mode&&(c.Forms.LayoutPart.isSaved=null,t.body.triggerHandler("builder_dom_changed",[e])))},set:function(a){var b=a[0].querySelectorAll("[data-cid]"),b=Array.prototype.slice.call(b);b.unshift(a[0]);a=0;for(var d=b.length;a<d;++a){var e=c.Models.Registry.lookup(b[a].getAttribute("data-cid"));e&&e.trigger("change:view",b[a])}},doScroll:function(a){return a},keypres:function(a){if(90===a.which&&"INPUT"!==p.activeElement.tagName&&"TEXTAREA"!==p.activeElement.tagName)if(!0===a.ctrlKey&&!0===
a.shiftKey||!0===a.metaKey&&!0===a.shiftKey)a.preventDefault(),this.hasRedo()&&this.changes(!1);else if(!0===a.ctrlKey||!0===a.metaKey)a.preventDefault(),this.hasUndo()&&this.changes(!0)},changes:function(a){var b=a?0:1;if(null!==c.activeModel){if(!0===c.hasChanged){ThemifyConstructor.saveComponent(!1);g(this.btnUndo).triggerHandler("click");return}l.Lightbox.close()}var d=this.stack[this.index+b];if(d!==q){this.is_working=!0;var e="";var f=d.type;var h=g(".tb_element_cid_"+d.cid);b=!1;c.eventName=
f;if("row"===f)a?(e=l.clone(d.before),b=d.cid):(e=l.clone(d.after),b=d.before.data("cid"),h=g(".tb_element_cid_"+b)),this.doScroll(h),this.set(e),e.toggleClass("tb_row_empty",0===e.find(".active_module").length),h.replaceWith(e);else if("duplicate"===f)a?this.doScroll(g(".tb_element_cid_"+d.after.data("cid"))).remove():(this.doScroll(h),e=l.clone(d.after),b=d.before.data("cid"),this.set(e),h.after(e));else if("delete_row"===f)if(a){e=l.clone(d.before);b=d.cid;var k=g(".tb_element_cid_"+d.data.pos_cid);
this.doScroll(k);this.set(e);"after"===d.data.pos?k.after(e):k.before(e)}else this.doScroll(h).remove();else if("sort"===f)b=d.cid,a?(k=d.data.before,e=l.clone(d.before)):(k=d.data.after,e=l.clone(d.after),"visual"===c.mode&&e.find(".active_module").css({display:"block",height:"auto"})),this.doScroll(e),this.set(e),d=g(".tb_element_cid_"+b).closest(".module_row"),g(".tb_element_cid_"+b).remove(),d.toggleClass("tb_row_empty",0===d.find(".active_module").length),d=null,g(".tb_element_cid_"+k).replaceWith(e),
d=e.closest(".module_row"),d.toggleClass("tb_row_empty",0===d.find(".active_module").length),d=null;else if("row_sort"===f)b=d.cid,k=d.data[a?"bnext":"anext"],d=g(".tb_element_cid_"+d.data[a?"before":"after"]),h=g(".tb_element_cid_"+b),e=l.clone(h),h.remove(),h=null,this.set(e),k?d.before(e):d.after(e),this.doScroll(e);else if("save"===f){b=d.cid;var f=c.Models.Registry.lookup(b),n="module"===f.get("elType"),m=n?"mod_settings":"styling";if(n&&d.data.column)a?(d=g(".tb_element_cid_"+b).closest(".module_row"),
b=!1,this.doScroll(h).remove()):(b=d.data.column.data("cid"),e=l.clone(d.data.column),h=g(".tb_element_cid_"+b),this.doScroll(h),this.set(e),h.replaceWith(e),d=e.closest(".module_row")),d.toggleClass("tb_row_empty",0===d.find(".active_module").length),d=null;else{this.doScroll(h);n={};a?(e=l.clone(d.before),n[m]=d.data.bsettings):(e=l.clone(d.after),n[m]=d.data.asettings);if("visual"===c.mode){d=g.extend(!0,{},d.data.styles);for(var v in d)for(k in m=ThemifyStyles.getSheet(v),m=m.cssRules?m.cssRules:
m.rules,d[v])if(m[k])for(var u in d[v][k])m[k].style["backgroundClip"===u||"background-clip"===u?"WebkitBackgroundClip":u]=a?d[v][k][u].b:d[v][k][u].a}f.set(n,{silent:!0});n=null;this.set(e);h.replaceWith(e)}}else if("predesign"===f)if(h=d.data.rows,a)for(this.doScroll(g(".tb_element_cid_"+h[0].data("cid"))),k=0,v=h.length;k<v;++k)g(".tb_element_cid_"+h[k].data("cid")).remove();else{u=p.createDocumentFragment();e=[];k=0;for(v=h.length;k<v;++k)f=l.clone(h[k]),u.appendChild(f[0]),e.push(f);!1!==d.data.prev?
this.doScroll(g(".tb_element_cid_"+d.data.prev)).after(u):this.doScroll("visual"===c.mode?g("#themify_builder_content-"+d.data.bid):g("#tb_row_wrapper")).prepend(u);k=0;for(v=e.length;k<v;++k)this.set(e[k]),c.Mixins.Builder.update(e[k])}else if("import"===f){k=g('[data-postid="'+d.data.bid+'"]');d=a?d.data.before:d.data.after;var w=this;d=l.clone(d);k.children().remove();k.prepend(d);d.each(function(){w.set(g(this))})}else"grid_sort"===f&&(a?g(".tb_element_cid_"+d.cid).remove():(k=g(".tb_element_cid_"+
d.before),e=l.clone(d.after),b=d.cid,d.data.next?k.before(e):k.after(e),this.set(e)));b&&(c.ActionBar.hoverCid=null,c.Mixins.Builder.update(g(e)));a?--this.index:++this.index;this.is_working=!1;this.updateUndoBtns();c.toolbar.pageBreakModule.countModules()}},hasRedo:function(){return this.index<this.stack.length-1},hasUndo:function(){return-1!==this.index},disable:function(){this.btnUndo.classList.add("tb_disabled");this.btnRedo.classList.add("tb_disabled");this.compactBtn.classList.add("tb_disabled")},
updateUndoBtns:function(){var a=this.hasUndo(),b=this.hasRedo();a?this.btnUndo.classList.remove("tb_disabled"):this.btnUndo.classList.add("tb_disabled");b?this.btnRedo.classList.remove("tb_disabled"):this.btnRedo.classList.add("tb_disabled");a||b?this.compactBtn.classList.remove("tb_disabled"):this.compactBtn.classList.add("tb_disabled")},reset:function(){this.stack=[];this.index=-1;this.updateUndoBtns()},do_change:function(a){a.preventDefault();a.stopPropagation();!1!==this.is_working||a.currentTarget.classList.contains("tb_disabled")||
this.changes(a.currentTarget.classList.contains("tb_undo_btn"))}};c.Views.Toolbar=y.View.extend({events:{"click .tb_import":"import","click .tb_load_layout":"loadLayout","click .tb_save_layout":"saveLayout","click .tb_dup_link":"duplicate","click .tb_toolbar_save":"save","click .tb_toolbar_backend_edit a":"save","click .tb_toolbar_close_btn":"panelClose","click .tb_breakpoint_switcher":"breakpointSwitcher","click .tb_popular_devices li":"deviceSwitcher","change .tb_change_mode input":"modChange",
"click .tb_float_minimize":"minimize","click .tb_float_close":"closeFloat","click .tb_toolbar_add_modules":"openFloat","click .tb_custom_css":"addCustomCSS","click .tb_zoom":"zoom","click .tb_toolbar_zoom_menu_toggle":"zoom","click .tb_toolbar_builder_preview":"previewBuilder","click .js-tb_module_panel_acc":"toggleAccordion"},lightboxStorageKey:"tb_module_panel",render:function(){var a=this,b={},d;for(d in themifyBuilder.modules){var e=p.createElement("div");var f=p.createElement("div");var h=p.createElement("span"),
g=p.createElement("strong"),n=p.createElement("a");e.className="tb_module_outer tb-module-"+d;e.dataset.categories=themifyBuilder.modules[d].category;themifyBuilder.modules[d].favorite&&(e.className+=" favorited");f.className="tb_module tb-module-type-"+d;h.className="tb_favorite ti-star tb_disable_sorting";g.className="module_name";g.textContent=themifyBuilder.modules[d].name;n.href="#";n.className="add_module_btn tb_disable_sorting";n.dataset.type="module";n.title=themifyBuilder.i18n.add_module;
f.dataset.moduleSlug=d;themifyBuilder.modules[d].type&&(f.dataset.type=themifyBuilder.modules[d].type);f.appendChild(h);f.appendChild(g);f.appendChild(n);e.appendChild(f);f=themifyBuilder.modules[d].favorite?["favorite"]:themifyBuilder.modules[d].category;h=0;for(g=f.length;h<g;++h)b[f[h]]===q&&(b[f[h]]=p.createDocumentFragment()),b[f[h]].appendChild(e.cloneNode(!0))}f=this.el.getElementsByClassName("tb_module_category_content");for(d=f.length-1;-1<d;--d)if(e=f[d].getAttribute("data-category"))q!==
b[e]?f[d].appendChild(b[e]):f[d].parentNode.style.display="none";f=null;"visual"===c.mode&&r.document.body.appendChild(this.el);b=function(){a.Panel.init();c.undoManager.init();new SimpleBar(a.el.getElementsByClassName("tb_module_panel_modules_wrap")[0]);a.pageBreakModule.init();a.preDesignedRows.init();a.libraryItems.init();a.common.init();setTimeout(function(){a.setMode();a.help.init();setTimeout(function(){a.Revisions.init()},1200);"visual"===c.mode&&(c.Mixins.Builder.initModuleVisualDrag(".tb_module"),
c.Mixins.Builder.initRowGridVisualDrag())},800);"visual"===c.mode&&(a.$el.on("click",".tb_favorite",a.toggleFavoriteModule),a.unload());t.body.on("click",".tb_favorite",a.toggleFavoriteModule);a.draggable();"true"===localStorage.getItem("tb_panel_closed")?a.closeFloat():a.Panel.setFocus()};if("visual"===c.mode)r.jQuery("body").one("themify_builder_ready",b);else b()},setMode:function(){localStorage.getItem("tb_mode")?c.ActionBar.isHoverMode=null:(c.ActionBar.isHoverMode=!0,this.el.getElementsByClassName("tb_change_mode")[0].getElementsByClassName("tb-checkbox")[0].checked=
!0);!0===c.ActionBar.isInit&&c.ActionBar.changeMode()},modChange:function(a){a.stopPropagation();!0===a.currentTarget.checked?(localStorage.removeItem("tb_mode"),c.ActionBar.isHoverMode=!0):(localStorage.setItem("tb_mode",1),c.ActionBar.isHoverMode=null);c.ActionBar.clear();c.ActionBar.clearSelected();c.ActionBar.changeMode()},getStorage:function(){var a=localStorage.getItem(this.lightboxStorageKey);return a?JSON.parse(a):null},updateStorage:function(){var a=this.$el.find("#tb_module_panel"),b=a.position(),
d=a.outerHeight();0>=d&&(d=(d=this.getStorage())?d.height:"");a={top:b.top,left:b.left,width:a.outerWidth(),height:d};localStorage.setItem(this.lightboxStorageKey,JSON.stringify(a))},getPanelClass:function(a){return 195>=a?"tb_float_xsmall":270>=a?"tb_float_small":400>=a?"tb_float_medium":"tb_float_large"},_setResponsiveTabs:function(a){for(var b=c.toolbar.el.getElementsByClassName("tb_module_types"),d=b.length-1;-1<d;--d)"tb_float_xsmall"===a?(b[d].classList.add("tb_ui_dropdown_items"),b[d].parentNode.classList.add("tb_compact_tabs")):
(b[d].classList.remove("tb_ui_dropdown_items"),b[d].parentNode.classList.remove("tb_compact_tabs"))},resize:function(){for(var a=this.el.getElementsByClassName("tb_modules_panel_wrap")[0],b=this,d,c,f,h,k=a.getElementsByClassName("tb_resizable"),n,m,v=null,l=function(e){var g=d+h-e.clientX,k=null;if("w"===m||"sw"===m||"nw"===m){var l=a.style.width;k=parseInt(a.style.left)+parseInt(l)-g}if("w"!==m){if("y"===m||"-y"===m||"sw"===m||"se"===m||"nw"===m||"ne"===m)if(l="-y"===m||"ne"===m||"nw"===m?c+f-e.clientY:
f+e.clientY-c,50<=l&&l<=v){if("-y"===m||"ne"===m||"nw"===m)a.style.top=parseInt(a.style.top)+parseInt(a.style.height)-l+"px";a.style.height=l+"px"}"sw"!==m&&"nw"!==m&&(g=h+e.clientX-d)}if("y"!==m&&"-y"!==m){if(500<g||120>g)l=g,g=120>g?120:500,null!==k&&(k=k+l-g);null!==k&&(a.style.left=k+"px");a.style.width=g+"px";e=b.getPanelClass(g);n!==e&&(n&&a.classList.remove(n),a.classList.add(e),n=e,b._setResponsiveTabs(e))}},q=function(){r.document.body.classList.remove("tb_start_animate");r.document.body.classList.remove("tb_panel_resize");
r.document.removeEventListener("mousemove",l,{passive:!0});r.document.removeEventListener("mouseup",q,{passive:!0});d=h=m=n=null;b.updateStorage()},p=k.length-1;-1<p;--p)k[p].addEventListener("mousedown",function(b){1===b.which&&(r.document.body.classList.add("tb_start_animate"),r.document.body.classList.add("tb_panel_resize"),m=this.dataset.axis,d=b.clientX,c=b.clientY,v=g(x).height()-50,f=parseInt(g(a).outerHeight(),10),h=parseInt(g(a).outerWidth(),10),r.document.addEventListener("mousemove",l,
{passive:!0}),r.document.addEventListener("mouseup",q,{passive:!0}))},{passive:!0})},setFloat:function(){var a=this.Panel.el.find("#tb_module_panel");a[0].classList.add("tb_panel_floating");var b=this.getStorage();b&&(a[0].style.width=b.width+"px",a[0].style.height=b.height+"px");b=this.getPanelClass(a.width());a[0].classList.add(b);this._setResponsiveTabs(b)},removeFloat:function(){this.Panel.el.find("#tb_module_panel").css({top:"",width:"",height:"",left:"",right:"",bottom:""}).removeClass("tb_panel_floating tb_float_xsmall tb_float_small tb_float_medium tb_float_large tb_is_minimize")},
draggable:function(){var a=this.$el.find("#tb_module_panel"),b=this;if(!l.Lightbox.dockMode.get()){a[0].classList.add("tb_panel_floating");var d=this.getStorage(),e=null;if(d){for(var f in d)a[0].style[f]=d[f]+"px";e=d.width}else e=a.width();d=this.getPanelClass(e);a[0].classList.add(d);this._setResponsiveTabs(d)}a.draggable({handle:".tb_drag_handle",cancel:".tb_module_types",scroll:!0,start:function(a,d){r.document.body.classList.add("tb_panel_drag");b.setFloat();l.Lightbox.dockMode.get()&&(l.Lightbox.dockMode.close(),
setTimeout(function(){c.Utils._onResize(!0)},100))},drag:function(a,b){"visual"===c.mode&&l.Lightbox.dockMode.drag(a,b)},stop:function(a,d){r.document.body.classList.remove("tb_panel_drag");l.Lightbox.dockMode.drag(a,d);if(l.Lightbox.dockMode.get())b.removeFloat(),b._setResponsiveTabs(!1);else{var e=g(r).height()-30,f=d.position.top,h={};0>f?h.top=0:f>e&&(h.top=e);for(var k in h)d.helper[0].style[k]=h[k]+"px";b.updateStorage()}"visual"===c.mode&&g(p).triggerHandler("mouseup")}});this.resize()},minimize:function(a){a.preventDefault();
a.stopPropagation();a=g(a.currentTarget).closest("#tb_module_panel");if(a.hasClass("tb_is_minimize")){a.removeClass("tb_is_minimize");var b=this.getStorage();a.css("height",b?b.height:"")}else a.addClass("tb_is_minimize");"visual"===c.mode&&g(p).triggerHandler("mouseup")},"import":function(a){a.preventDefault();a.stopPropagation();var b=a.currentTarget.getAttribute("data-component"),d=r.document.getElementsByTagName("body")[0],e={contructor:"file"!==b,dataType:"json",data:{action:"builder_import",
type:b}};if("file"!==b||confirm(themifyBuilder.i18n.importFileConfirm))if("file"===b){var f=r.document.getElementById("tb_import_filestb_plupload_browse_button");null===f?(f=p.createElement("input"),a=p.createElement("div"),b=p.createElement("span"),a.id="tb_import_filestb_plupload_upload_ui",a.style.display="none",f.type="button",f.id="tb_import_filestb_plupload_browse_button",b.className="ajaxnonceplu",b.id=themifyBuilder.import_nonce,a.appendChild(f),a.appendChild(b),d.appendChild(a),c.Utils.builderPlupload("",
f.parentNode)):f.click()}else{l.Lightbox.$lightbox[0].style.display="none";f=g(a.currentTarget.closest("ul"));var h=f.offset(),k=h.top+f.height()-40;t.body.off("themify_builder_lightbox_close.import");f.addClass("tb_current_menu_selected");null!==c.Forms.LayoutPart.id&&(k-=x.pageYOffset+60);l.Lightbox.open(e,function(){d.classList.add("tb_standalone_lightbox")},function(){this.$lightbox[0].classList.add("tb_import_post_lightbox");this.setStandAlone(h.left,k,!0);t.body.one("themify_builder_lightbox_close.import",
function(){d.classList.remove("tb_standalone_lightbox");l.Lightbox.$lightbox[0].classList.remove("tb_import_post_lightbox");f.removeClass("tb_current_menu_selected");d=null});g("#tb_submit_import_form",l.Lightbox.$lightbox).one("click",function(a){a.preventDefault();l.LiteLightbox.confirm(themifyBuilder.i18n.dialog_import_page_post,function(a){g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"builder_import_submit",nonce:themifyBuilder.tb_load_nonce,data:c.Forms.serialize("tb_options_import"),
importType:"no"===a?"replace":"append",importTo:themifyBuilder.post_ID},beforeSend:function(a){l.showLoader("show")},success:function(a){a.builder_data!==q?c.Forms.reLoad(a.builder_data,themifyBuilder.post_ID):l.showLoader("error");l.Lightbox.close()}})},{buttons:{no:{label:ThemifyConstructor.label.replace_builder},yes:{label:ThemifyConstructor.label.append_builder}}})})})}},unload:function(){"visual"===c.mode&&p.head.insertAdjacentHTML("afterbegin",'<base target="_parent">');r.onbeforeunload=function(){return c.editing||
!c.hasChanged&&!c.undoManager.hasUndo()?null:"Are you sure"}},panelClose:function(a){a.preventDefault();r.location.reload(!0)},loadLayout:function(a){a.preventDefault();a.stopPropagation();var b=this,d=r.document.body,e=g(a.currentTarget.closest("ul"));a=b.layoutsList?{loadMethod:"html",data:b.layoutsList}:{data:{action:"tb_load_layout"}};l.Lightbox.$lightbox[0].style.display="none";e.addClass("tb_current_menu_selected");t.body.off("themify_builder_lightbox_close.loadLayout");l.Lightbox.open(a,function(){d.classList.add("tb_load_layout_active");
d.classList.add("tb_standalone_lightbox")},function(){function a(){k.on("click.loadLayout",".layout_preview img",function(a){a.preventDefault();a.stopPropagation();var d=g(this).closest(".layout_preview");l.LiteLightbox.confirm(themifyBuilder.i18n.confirm_template_selected,function(a){var e=d.closest("ul").data("group"),f=function(d){if("no"!==a){var e="visual"!==c.mode?p.getElementById("tb_row_wrapper"):p.getElementsByClassName("themify_builder_content-"+themifyBuilder.post_ID)[0],e=c.Mixins.Builder.toJSON(e),
f=[],h;for(h in e)f.push(e[h]);e=null;for(h in d)f.push(d[h]);d=f;f=null}!0!==b.is_set&&g.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"set_layout_action",nonce:themifyBuilder.tb_load_nonce,mode:"no"!==a?1:0,id:themifyBuilder.post_ID},success:function(){b.is_set=!0}});c.Forms.reLoad(d,themifyBuilder.post_ID);l.Lightbox.close()};if("pre-designed"===e){l.showLoader("show");var h=d.data("slug"),k=themifyBuilder.paths.layout_template.replace("{SLUG}",h);if(!c.layouts_selected)c.layouts_selected=
{};else if(c.layouts_selected[h]){f(JSON.parse(c.layouts_selected[h]));return}g.get(k,null,null,"text").done(function(a){c.layouts_selected[h]=a;f(JSON.parse(a))}).fail(function(a,b,d){l.LiteLightbox.alert(ThemifyConstructor.label.layout_error.replace("{FILE}",k))}).always(function(){l.showLoader()})}else g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_set_layout",nonce:themifyBuilder.tb_load_nonce,layout_slug:d.data("slug"),layout_group:e,mode:"no"!==a?1:0},beforeSend:function(){"visual"===
c.mode&&l.showLoader("show")},success:function(a){if(a.data){f(a.data);if(a.gs)for(var b=Object.keys(a.gs),d=b.length-1;-1<d;--d)c.GS.styles[b[d]]==q&&(c.GS.styles[b[d]]=a.gs[b[d]]),"visual"===c.mode&&!0!==c.GS.styles[b[d]].cssLoaded&&(c.liveStylingInstance.setCss(c.GS.styles[b[d]].data,q,c.GS.styles[b[d]]["class"]),c.GS.styles[b[d]].cssLoaded=!0);l.showLoader()}else l.showLoader("error"),alert(a.msg),l.Lightbox.close()}})},{buttons:{no:{label:ThemifyConstructor.label.layout_replace},yes:{label:ThemifyConstructor.label.layout_append}}})})}
function h(){a();var b=n.find(".layout_preview_list");m.show().find("li").on("click",function(a){a.preventDefault();a.stopPropagation();this.classList.contains("current")||(a=b,this.classList.contains("all")||(b.hide(),a=b.filter("[data-category"+(""!==themifyBuilder.paths.layouts_index?"*":"")+'="'+g(this).text()+'"]')),a.show(),v(a),g(this).addClass("current").siblings().removeClass("current"),m.parent().find(".tb_ui_dropdown_label").html(g(this).text()));c.Utils.hideOnClick(m)});m.find(".tb_selected_cat").click();
k.find("#tb_layout_search").on("keyup",function(){var a=g.trim(g(this).val()),d=b;""!==a&&(d=m.find("li.all"),d[0].classList.contains("current")||d.click(),b.hide(),d=b.find(".layout_title:contains("+a+")").closest(".layout_preview_list"));d.show();v(d)})[0].focus();new SimpleBar(k[0]);new SimpleBar(m[0]);t.body.one("themify_builder_lightbox_close.loadLayout",function(){k.off("click.loadLayout")[0].classList.remove("tb_predesigned_lightbox");n.find("#tb_layout_search").off("keyup");n=k=null;d.classList.remove("tb_load_layout_active");
d.classList.remove("tb_standalone_lightbox");e.removeClass("tb_current_menu_selected")})}var k=this.$lightbox,n=k.find("#tb_tabs_pre-designed");if(0===n.length)d.classList.remove("tb_load_layout_active"),d.classList.remove("tb_standalone_lightbox"),e.removeClass("tb_current_menu_selected"),a();else{k[0].classList.add("tb_predesigned_lightbox");this.setStandAlone(r.innerWidth/2,(r.document.documentElement.clientHeight-k.height())/2,!0);var m=n.find(".tb_ui_dropdown_items"),v=function(a){a.each(function(a){0===
a%4?this.classList.add("layout-column-break"):this.classList.remove("layout-column-break")})};if(b.layoutsList)h();else{var u=function(a,d){for(var c={},e=p.createDocumentFragment(),f=p.createDocumentFragment(),l=0,q=a.length;l<q;++l){var u=p.createElement("li"),r=p.createElement("div"),w=p.createElement("div"),z=p.createElement("img"),t=p.createElement("div"),x=p.createElement("div"),y=p.createElement("a"),B=p.createElement("i");u.className="layout_preview_list";u.dataset.category=a[l].category;
r.className="layout_preview";r.dataset.id=a[l].id;r.dataset.slug=a[l].slug;w.className="thumbnail";z.src=a[l].thumbnail;z.alt=a[l].title;z.title=a[l].title;t.className="layout_action";x.className="layout_title";x.textContent=a[l].title;y.className="layout-preview-link themify_lightbox";y.href=a[l].url;y.target="_blank";y.title=themifyBuilder.i18n.preview;B.className="ti-search";y.appendChild(B);t.appendChild(x);t.appendChild(y);w.appendChild(z);r.appendChild(w);r.appendChild(t);u.appendChild(r);e.appendChild(u);
if(a[l].category)for(u=String(a[l].category).split(","),r=0,w=u.length;r<w;++r)""!==u[r]&&1!==c[u[r]]&&(z=p.createElement("li"),z.textContent=u[r],f.appendChild(z),c[u[r]]=1,u[r]===d&&(z.className="tb_selected_cat"))}m[0].appendChild(f);n[0].getElementsByClassName("tb_layout_lists")[0].appendChild(e);e=f=c=null;k.find(".tb_tab").each(function(){v(g(this).find(".layout_preview_list"))});b.layoutsList=k[0].getElementsByClassName("tb_options_tab_wrapper")[0].cloneNode(!0);h()};g.ajax({type:"POST",url:themifyBuilder.ajaxurl,
dataType:"json",data:{action:"tb_load_predesigned_layouts",nonce:themifyBuilder.tb_load_nonce,src:themifyBuilder.paths.layouts_index,id:themifyBuilder.post_ID},beforeSend:function(){setTimeout(function(){l.showLoader("show")},500)},success:function(a){var b=JSON.parse(a.data);if(""===themifyBuilder.paths.layouts_index){var d=Object.keys(b);c.layouts_selected={};for(var e=d.length-1;-1<e;--e)c.layouts_selected[b[d[e]].slug]=b[d[e]].data}u(b,a.selected);l.showLoader("spinhide")},error:function(){l.LiteLightbox.alert(g("#tb_load_layout_error",
n).show().text());l.showLoader("spinhide")}})}}})},saveLayout:function(a){a.preventDefault();a.stopPropagation();var b={contructor:!0,loadMethod:"html",save:{},data:{save_as_layout:{options:[{id:"layout_title_field",type:"text",label:ThemifyConstructor.label.title},{id:"layout_img_field",type:"image",label:ThemifyConstructor.label.image_preview},{id:"layout_img_field_id",type:"hidden"},{id:"postid",type:"hidden",value:themifyBuilder.post_ID}]}}},d=g(a.currentTarget.closest("ul"));d.addClass("tb_current_menu_selected");
l.Lightbox.$lightbox[0].style.display="none";l.Lightbox.open(b,function(){r.document.body.classList.add("tb_standalone_lightbox")},function(){var b=this.$lightbox;b.find(".builder_save_button").one("click",function(a){a.stopPropagation();a.preventDefault();g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_save_custom_layout",nonce:themifyBuilder.tb_load_nonce,form_data:c.Forms.serialize(b[0])},beforeSend:function(){l.showLoader("show")},success:function(a){"success"===
a.status?(l.showLoader(),l.Lightbox.close()):(l.showLoader("error"),alert(a.msg))}})});b.addClass("tb_savead_lightbox");this.setStandAlone(a.clientX,a.clientY);t.body.one("themify_builder_lightbox_close",function(){b.removeClass("tb_savead_lightbox").find(".builder_save_button").off("click");r.document.body.classList.remove("tb_standalone_lightbox");d.removeClass("tb_current_menu_selected")})})},duplicate:function(a){function b(){d.Revisions.ajax({action:"tb_duplicate_page",tb_is_admin:"visual"!==
c.mode},function(a){a&&(r.location.href=g("<div/>").html(a).text())})}a.preventDefault();a.stopPropagation();var d=this;confirm(themifyBuilder.i18n.confirm_on_duplicate_page)&&c.Utils.saveBuilder(b)},addCustomCSS:function(a){a.preventDefault();a.stopPropagation();null!==c.activeModel&&ThemifyConstructor.saveComponent(!0);null===B&&(B=themifyBuilder.custom_css,delete themifyBuilder.custom_css);B||(B="");var b={contructor:!0,loadMethod:"html",save:{},data:{css:{options:[{id:"custom_css",type:"textarea",
rows:17,"class":"fullwidth"},{id:"custom_css_m",type:"message",label:"",comment:ThemifyConstructor.label.cus_css_m},{id:"postid",type:"hidden",value:themifyBuilder.post_ID}]}}},d=a.currentTarget;d.classList.add("tb_tooltip_active");l.Lightbox.$lightbox[0].style.display="none";r.document.body.classList.add("tb_standalone_lightbox");l.Lightbox.open(b,null,function(){var b=this.$lightbox,f=b[0].querySelector("#custom_css"),h=b[0].querySelector(".tb_close_lightbox"),g=b[0].querySelector(".builder_save_button");
var n=f.value=B;f.addEventListener("input",function(){B=this.value.trim();if("visual"===c.mode){var a=p.getElementById("tb_custom_css_tmp");null===a&&(a=p.createElement("style"),a.type="text/css",a.id="tb_custom_css_tmp",p.head.appendChild(a));a.innerHTML=B}});h.addEventListener("click",function(){if(n!==f.value.trim()){var a=p.querySelector("#tb_custom_css_tmp");B=n;f.value=n;a&&(a.innerHTML=n)}});g.addEventListener("click",function(){n=f.value.trim();B=f.value.trim()});b.addClass("tb_custom_css_lightbox").find(".builder_save_button").one("click",
function(a){a.stopImmediatePropagation();a.preventDefault();l.Lightbox.close()});this.setStandAlone(a.clientX,a.clientY);t.body.one("themify_builder_lightbox_close",function(){B||d.classList.add("tb_tooltip_active");d=null;r.document.body.classList.remove("tb_standalone_lightbox")})})},Revisions:{init:function(){c.toolbar.$el.find(".tb_revision").on("click",this.revision.bind(this))},revision:function(a){a.preventDefault();a.stopPropagation();a.currentTarget.classList.contains("tb_save_revision")?
this.save():this.load(a)},load:function(a){var b=this,d=g("body",r.document),c=g(a.currentTarget.closest("ul")),f=c.offset();c.addClass("tb_current_menu_selected");l.Lightbox.$lightbox[0].style.display="none";t.body.off("themify_builder_lightbox_close.revisions");b.ajax({action:"tb_load_revision_lists"},function(a){l.Lightbox.open({contructor:!0,loadMethod:"html",data:{revision:{html:g(a)[0]}}},function(){d.addClass("tb_standalone_lightbox")},function(){this.$lightbox[0].classList.add("tb_revision_lightbox");
this.setStandAlone(f.left,f.top,!0);d.on("click.revision",".js-builder-restore-revision-btn",b.restore.bind(b)).on("click.revision",".js-builder-delete-revision-btn",b["delete"].bind(b));t.body.one("themify_builder_lightbox_close.revisions",function(){c.removeClass("tb_current_menu_selected");d.off(".revision").removeClass("tb_standalone_lightbox");l.Lightbox.$lightbox[0].classList.remove("tb_revision_lightbox");d=null})})})},ajax:function(a,b){a=g.extend({},a,{tb_load_nonce:themifyBuilder.tb_load_nonce,
postid:themifyBuilder.post_ID});return g.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:a,beforeSend:function(){l.showLoader("show")},complete:function(){l.showLoader("hide")},success:function(a){g.isFunction(b)&&b.call(this,a)}})},save:function(a){var b=this;l.LiteLightbox.prompt(themifyBuilder.i18n.enterRevComment,function(d){null!==d&&c.Utils.saveBuilder(function(){b.ajax({action:"tb_save_revision",rev_comment:d},a)},0,!0)})},restore:function(a){a.preventDefault();a.stopPropagation();var b=
g(a.currentTarget).data("rev-id"),d=this,e=function(){d.ajax({action:"tb_restore_revision_page",revid:b},function(a){a.builder_data?(c.Forms.reLoad(a.builder_data,themifyBuilder.post_ID),l.Lightbox.close()):(l.showLoader("error"),alert(a.data))})};l.LiteLightbox.confirm(themifyBuilder.i18n.confirmRestoreRev,function(a){"yes"===a?d.save(e):e()},{buttons:{no:{label:ThemifyConstructor.label.save_no},yes:{label:ThemifyConstructor.label.save}}})},"delete":function(a){a.preventDefault();a.stopPropagation();
if(confirm(themifyBuilder.i18n.confirmDeleteRev)){var b=g(a.currentTarget);a=b.data("rev-id");this.ajax({action:"tb_delete_revision",revid:a},function(a){a.success?b.closest("li").remove():(l.showLoader("error"),alert(a.data))})}}},save:function(a){a.preventDefault();a.stopPropagation();var b=0<g(a.currentTarget).closest(".tb_toolbar_backend_edit").length?g(a.currentTarget).prop("href"):!1;themifyBuilder.is_gutenberg_editor&&!1!==b?(c.undoManager.reset(),c._backendSwitchFrontend(b)):(c.Utils.saveBuilder(function(a,
e){"success"!==e?alert(themifyBuilder.i18n.errorSaveBuilder):!1!==b&&("visual"===c.mode?(sessionStorage.setItem("focusBackendEditor",!0),r.location.href=b):(c.undoManager.reset(),c._backendSwitchFrontend(b)))}),q!==themifyBuilder.globalStyleData&&(c.toolbar.el.getElementsByClassName("tb_toolbar_builder_preview")[0].click(),c.GS.openStylingPanel()))},libraryItems:{items:[],is_init:null,init:function(){g(p).one("tb_panel_tab_tb_module_panel_library_wrap",this.load.bind(this))},load:function(a,b){var d=
this;b=g(b).find(".tb_module_panel_library_wrap");b.addClass("tb_busy");g.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"tb_get_library_items",nonce:themifyBuilder.tb_load_nonce,part:"all",pid:themifyBuilder.post_ID},success:function(a){d.setData(a);b.removeClass("tb_busy");d.is_init=!0},error:function(){b.removeClass("tb_busy");l.showLoader("error");d.init();c.toolbar.$el.find(".tb_library_item_list").html("<h3>Failed to load Library Items.</h3>")}})},get:function(a,b,d){if(this.items[a]!==
q)d(this.items[a]);else{var e=this;g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_get_library_item",nonce:themifyBuilder.tb_load_nonce,type:b,id:a},beforeSend:function(a){l.showLoader("show")},success:function(b){if(b.content.gs){for(var f=Object.keys(b.content.gs),g=f.length-1;-1<g;--g)c.GS.styles[f[g]]==q&&(c.GS.styles[f[g]]=b.content.gs[f[g]]),"visual"===c.mode&&!0!==c.GS.styles[f[g]].cssLoaded&&(c.liveStylingInstance.setCss(c.GS.styles[f[g]].data,q,c.GS.styles[f[g]]["class"]),
c.GS.styles[f[g]].cssLoaded=!0);delete b.content.gs}l.showLoader("hide");"success"===b.status?(e.items[a]=b.content,d(b.content)):l.showLoader("error")},error:function(){l.showLoader("error")}})}},template:function(a){for(var b="",d=0,c=a.length;d<c;++d){var f="part";-1!==a[d].post_type.indexOf("_rows",5)?f="row":-1!==a[d].post_type.indexOf("_module",5)&&(f="module");b+='<div class="tb_library_item tb_item_'+f+'" data-type="'+f+'" data-id="'+a[d].id+'">';b+='<div class="tb_library_item_inner"><span>'+
a[d].post_title+"</span>";b+='<a href="#" class="remove_item_btn tb_disable_sorting" title="Delete"></a></div></div>'}return b},bindEvents:function(a){"visual"===c.mode?(c.Mixins.Builder.initModuleVisualDrag(".tb_item_module,.tb_item_part"),c.Mixins.Builder.initRowVisualDrag(".tb_item_row")):(c.Mixins.Builder.initRowDraggable(c.toolbar.$el.find(".tb_module_panel_library_wrap").first(),".tb_item_row"),c.Mixins.Builder.initModuleDraggable(c.toolbar.$el.find(".tb_library_item_list").first(),".tb_item_module,.tb_item_part"));
if(c.toolbar.common.btn||"visual"===c.mode&&(c.toolbar.common.is_init||a))c.Mixins.Builder.initRowDraggable(c.toolbar.common.btn.find(".tb_module_panel_library_wrap").first(),".tb_item_row"),c.Mixins.Builder.initModuleDraggable(c.toolbar.common.btn.find(".tb_library_item_list").first(),".tb_item_module,.tb_item_part")},setData:function(a){a='<span class="tb_no_content" style="display:none">No library content found.</span>'+this.template(a);var b=g(".tb_library_item_list");"visual"===c.mode&&(b=b.add(c.toolbar.$el.find(".tb_library_item_list")));
for(var b=b.get(),d=b.length-1;-1<d;--d)b[d].insertAdjacentHTML("afterbegin",a),new SimpleBar(b[d]),b[d].previousElementSibling.getElementsByClassName("current")[0].click();t.body.on("click",".remove_item_btn",this["delete"].bind(this));if("visual"===c.mode)c.toolbar.$el.on("click",".remove_item_btn",this["delete"].bind(this));this.bindEvents()},"delete":function(a){a.preventDefault();a.stopPropagation();var b=g(a.currentTarget).closest(".tb_library_item"),d=b.data("type");if(confirm(themifyBuilder.i18n[d+
"LibraryDeleteConfirm"])){var e=b.data("id");g.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"tb_remove_library_item",nonce:themifyBuilder.tb_load_nonce,id:e},beforeSend:function(a){l.showLoader("show")},success:function(a){l.showLoader("hide");if(a){var f=0<b.closest("#"+c.toolbar.common.btn.prop("id")).length?c.toolbar.$el.find(".tb_item_"+d+'[data-id="'+e+'"]'):c.toolbar.common.btn.find(".tb_item_"+d+'[data-id="'+e+'"]');b=b.add(f);if("part"===d){b=b.add(g(".themify_builder_content-"+
e).closest(".active_module"));for(var f=ThemifyConstructor.layoutPart.data,k=f.length-1;-1<k;--k)if(f[k].post_name===a){ThemifyConstructor.layoutPart.data.splice(k,1);break}}a=b.parent().siblings(".tb_library_types").find(".current");b.remove();a.trigger("click")}else l.showLoader("error")},error:function(){l.showLoader("error")}})}}},preDesignedRows:{is_init:null,rows:{},items:{},currentCategory:"All",categories:{All:{isLoaded:!1}},loadingItems:!1,init:function(){setTimeout(function(){var a=r.document.createElement("meta"),
b=r.document.createDocumentFragment(),d=[{href:"//themify.me",rel:"dns-prefetch preconnect"},{href:"//fonts.googleapis.com",rel:"dns-prefetch"},{href:"//maps.googleapis.com",rel:"dns-prefetch"},{href:themifyBuilder.paths.rows_index,rel:"prefetch"},{href:themifyBuilder.paths.layouts_index,rel:"prefetch"}];a.content="on";a.setAttribute("http-equiv","x-dns-prefetch-control");b.appendChild(a);for(var c in d)a=r.document.createElement("link"),a.setAttribute("crossorigin",!0),a.rel=d[c].rel,a.href=d[c].href,
b.appendChild(a);r.document.head.appendChild(b)},7E3);g(p).one("tb_panel_tab_tb_module_panel_rows_wrap",this.load.bind(this))},load:function(a,b){var d=this;b=g(b).find(".tb_predesigned_rows_list");b.addClass("tb_busy");g.getJSON(themifyBuilder.paths.rows_index).done(function(a){d.setData(a,b)}).fail(function(a,f,h){d.setData({},b);d.is_init=null;l.showLoader("error");c.toolbar.$el.find(".tb_predesigned_rows_container").append("<h3>"+ThemifyConstructor.label.rows_fetch_error+"</h3>");g(p).one("tb_panel_tab_tb_module_panel_rows_wrap",
d.load.bind(d))})},masonry:function(a){for(var b=a.querySelectorAll('.predesigned_row:not([data-masonry="done"])'),d=b.length,c=0;c<d;c++){var f=b[c],h=parseInt(x.top.getComputedStyle(a).getPropertyValue("grid-row-gap")),g=parseInt(x.top.getComputedStyle(a).getPropertyValue("grid-auto-rows"));if(!isNaN(h)&&!isNaN(g)){var n=f.getElementsByClassName("tb_predesigned_rows_image")[0].getBoundingClientRect().height+f.getElementsByClassName("tb_predesigned_rows_title")[0].getBoundingClientRect().height,
h=Math.ceil((n+h)/(g+h));f.style.gridRowEnd="span "+h;5<h&&(f.dataset.masonry="done")}}},loadItems:function(a){this.loadingItems=!0;var b=this.currentCategory,d=p.createDocumentFragment();if(!0===this.categories.All.isLoaded||!0===this.categories[b].isLoaded)return this.loadingItems=!1,d;for(var c=0,f=Object.keys(this.items),h=f.length,g=0;g<h&&!(10<=c&&q==a);g++){var n=this.items[f[g]],m=""!==a?new RegExp(a,"i"):!1;if(m&&m.test(n.title)){var v=n.category.split(",");if("All"===b||-1!==v.indexOf(b)){delete this.items[f[g]];
for(var m="",l=0,r=v.length;l<r;++l)m+=this.categories[v[l]].hash;var v=p.createElement("div"),l=p.createElement("figure"),r=p.createElement("div"),z=new Image,t=p.createElement("a");v.className="predesigned_row "+m;v.setAttribute("data-slug",n.slug);l.className="tb_predesigned_rows_image";r.className="tb_predesigned_rows_title";r.textContent=z.alt=z.title=n.title;z.src=n.thumbnail===q||""===n.thumbnail?"https://placeholdit.imgix.net/~text?txtsize=24&txt="+encodeURI(n.title)+"&w=181&h=77":n.thumbnail;
z.width=500;z.height=300;t.href="#";t.className="add_module_btn tb_disable_sorting";t.dataset.type="predesigned";l.appendChild(z);l.appendChild(t);v.appendChild(l);v.appendChild(r);d.appendChild(v);c++}}}this.categories[b].isLoaded=10>c&&q===a;return d},setData:function(a){this.items=a;a=null;var b=[];a=p.createDocumentFragment();for(var d=0,e=this.items.length;d<e;++d)for(var f=this.items[d].category.split(","),h=0,k=f.length;h<k;++h){var n=t.hash(f[h]);-1===b.indexOf(f[h])&&(b.push(f[h]),this.categories[f[h]]=
{hash:"tb"+n})}b.sort();d=0;for(e=b.length;d<e;++d)f=p.createElement("li"),f.setAttribute("data-slug",t.hash(b[d])),f.textContent=b[d],a.appendChild(f);var b=g(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items"),e=g(".tb_predesigned_rows_container"),m=this;"visual"===c.mode&&(e=e.add(c.toolbar.$el.find(".tb_predesigned_rows_container")),b=b.add(c.toolbar.$el.find(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items")));b=b.get();e=e.get();f=this.loadItems();for(d=b.length-
1;-1<d;--d)b[d].appendChild(a.cloneNode(!0)),e[d].appendChild(f.cloneNode(!0)),h=e[d].getElementsByTagName("img"),0<h.length?(h=h[h.length-1],g(h).one("load",function(){m.initCallback(g(this).closest(".tb_predesigned_rows_container")[0],!0)})):m.initCallback(e[d],!0);t.body.on("click",".tb_module_panel_container .tb_ui_dropdown_items li",this.filter.bind(this));if("visual"===c.mode)g("body",r.document).on("click",".tb_module_panel_container .tb_ui_dropdown_items li",this.filter.bind(this))},initCallback:function(a,
b){if(b){var d=new SimpleBar(a);var e=a.getElementsByClassName("simplebar-content");d=e.length?d.getScrollElement():a;d.addEventListener("scroll",this.scrollLoadMore.bind(this));this.is_init=!0}e=g(a);"visual"===c.mode?c.Mixins.Builder.initRowVisualDrag(".predesigned_row"):c.Mixins.Builder.initRowDraggable(c.toolbar.$el.find(".tb_predesigned_rows_container").first(),".predesigned_row");c.toolbar.common.is_init&&c.Mixins.Builder.initRowDraggable(c.toolbar.common.btn.find(".tb_predesigned_rows_container").first(),
".predesigned_row");b&&(new SimpleBar(e.closest(".tb_module_panel_tab").find(".tb_ui_dropdown_items")[0]),e.closest(".tb_predesigned_rows_list").removeClass("tb_busy").closest(".tb_module_panel_tab").find(".tb_ui_dropdown").css("visibility","visible"));g(a).parents("#tb_module_panel_dropdown").length&&(e=a.getElementsByClassName("simplebar-content"),this.masonry(e.length?e[0]:a));this.loadingItems=!1},get:function(a,b){l.showLoader("show");if(this.rows[a]!==q)"function"===typeof b&&b(this.rows[a]);
else{var d=this;g.getJSON(themifyBuilder.paths.row_template.replace("{SLUG}",a)).done(function(e){d.rows[a]=e;"function"===typeof b&&b(e);e=JSON.stringify(e);e.indexOf("global_styles")&&g.getJSON(themifyBuilder.paths.row_template.replace("{SLUG}",a+"-gs")).done(function(a){c.GS.loadingPosts=!0;g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_import_gs_posts_ajax",tb_load_nonce:themifyBuilder.tb_load_nonce,data:a},success:function(a){for(var b=Object.keys(a),d=b.length-
1;-1<d;--d)c.GS.styles[a[b[d]].id]=a[b[d]],"visual"===c.mode&&(c.liveStylingInstance.setCss(c.GS.styles[a[b[d]].id].data,q,c.GS.styles[a[b[d]].id]["class"]),c.GS.styles[a[b[d]].id].cssLoaded=!0);c.GS.loadingPosts=!1}})})}).fail(function(a,b,d){l.showLoader("error");alert(ThemifyConstructor.label.row_fetch_error)})}},filter:function(a){a.preventDefault();a.stopPropagation();a=g(a.currentTarget);var b=a.data("slug"),d=a.closest(".tb_module_panel_tab"),e=d.find(".tb_ui_dropdown_label"),f=d.find(".predesigned_row"),
h=a.text();this.currentCategory=h;this.addNewItems();e.text(h);d.find(".tb_module_panel_search_text").val("");var k=b?"tb"+b:!1;e.data("active",k);a.addClass("current").siblings().removeClass("current");f.each(function(){!k||this.classList.contains(k)?g(this).show():g(this).hide()}).filter(":visible").each(function(a){0===(a+1)%4?g(this).addClass("tb_column_break"):g(this).removeClass("tb_column_break")});c.Utils.hideOnClick(d.find(".tb_ui_dropdown_items"))},addNewItems:function(a){this.currentCategory=
q!==a?"All":this.currentCategory;if(!this.categories[this.currentCategory].isLoaded){var b=this,d=g(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items"),e=g(".tb_predesigned_rows_container");"visual"===c.mode&&(e=e.add(c.toolbar.$el.find(".tb_predesigned_rows_container")),d=d.add(c.toolbar.$el.find(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items")));d=d.get();e=e.get();a=b.loadItems(a);for(d=d.length-1;-1<d;--d){var f=e[d].getElementsByClassName("simplebar-content");
f.length&&(e[d]=f[0]);e[d].appendChild(a.cloneNode(!0));f=e[d].getElementsByTagName("img");0<f.length?(f=f[f.length-1],g(f).one("load",function(){b.initCallback(g(this).closest(".tb_predesigned_rows_container")[0])})):b.initCallback(e[d])}}},scrollLoadMore:function(a){this.loadingItems||!0===this.categories[this.currentCategory].isLoaded||(a=a.target,a=Math.max(a.scrollHeight-(a.scrollTop+a.offsetHeight),0),0<a&&200>=a&&this.addNewItems())}},pageBreakModule:{init:function(){"visual"===c.mode?c.Mixins.Builder.initRowVisualDrag(".tb_page_break_module"):
c.Mixins.Builder.initRowDraggable(c.toolbar.$el.find(".tb_module_panel_modules_wrap").first(),".tb_page_break_module")},countModules:function(){for(var a="visual"===c.mode?p.getElementsByClassName("module-page-break"):p.getElementsByClassName("tb-page-break"),b=a.length-1;-1<b;--b)"visual"===c.mode?a[b].getElementsByClassName("page-break-order")[0].textContent=b+1:a[b].getElementsByClassName("page-break-overlay")[0].textContent="PAGE BREAK - "+(b+1)},get:function(){return[{cols:[{grid_class:"col-full first last",
modules:[{mod_name:"page-break"}]}],column_alignment:"col_align_middle",styling:{custom_css_row:"tb-page-break"}}]}},common:{btn:null,is_init:null,clicked:null,init:function(){var a=p.createElement("div"),b=c.toolbar.$el;a.className="tb_modules_panel_wrap";a.id="tb_module_panel_dropdown";this.btn=g(a);a=null;b=b.add(l.Lightbox.$lightbox);"visual"!==c.mode&&null!==p.querySelector(".edit-post-layout__content")?g(".edit-post-layout__content")[0].appendChild(this.btn[0]):t.body[0].appendChild(this.btn[0]);
var d=this;if("visual"===c.mode)c.toolbar.$el.find(".tb_module_types li").on("click",this.tabs.bind(this));t.body.on("click",".tb_module_types li",this.tabs.bind(this)).on("click",".tb_column_btn_plus",this.show.bind(this));b.on("click",".tb_clear_input",this.clear);c.toolbar.$el.find(".tb_module_panel_search_text").on("keyup",this.search.bind(this));this.btn.on("click",".add_module_btn,.js-tb_module_panel_acc",function(a){a.preventDefault();a.stopPropagation();var b=null,e=this.classList,k=this.dataset.type;
d.clicked||(d.clicked=c.Instances.Builder[c.builderIndex].newRowAvailable(1,!0),b=!0);if("module"===k){var n=d.clicked.hasClass("tb_module_btn_plus")?d.clicked.parent():d.clicked.closest(".module_column").find(".tb_holder").last();c.toolbar.Panel.add_module(a,n)}else if("row"===k)n=d.clicked.hasClass("tb_module_btn_plus")?d.clicked.parent():d.clicked.closest(".module_column").find(".tb_holder").first(),c.toolbar.Panel.click_add_sub_row(a,n);else if(e.contains("js-tb_module_panel_acc"))c.toolbar.toggleAccordion(a);
else if("predesigned"===k||"page_break"===k)n=d.clicked.closest(".module_row"),"page_break"===k?c.toolbar.Panel.click_add_page_break(a,n):c.toolbar.preDesignedRows.get(g(a.currentTarget).closest(".predesigned_row").data("slug"),function(a){c.Mixins.Builder.rowDrop(a,b?n:g("<div>").insertAfter(n),!0)});e.contains("js-tb_module_panel_acc")||d.hide(!0)}).on("keyup",".tb_module_panel_search_text",this.search.bind(this)).on("click",".tb_clear_input",this.clear)},run:function(){var a=c.toolbar.$el.find("#tb_module_panel");
this.btn[0].insertAdjacentHTML("beforeend",a[0].innerHTML);this.btn.find(".tb_module_outer").show();a=this.btn.find(".tb_module_types").closest("div")[0];a.parentNode.parentNode.insertBefore(a,a.parentNode);a.parentNode.removeChild(a.nextElementSibling);a=this.btn.find(".tb_compact_tabs").removeClass("tb_compact_tabs").find(".tb_ui_dropdown_items").removeClass("tb_ui_dropdown_items");this.btn.find(".tb_module_panel_search_text").val("");new SimpleBar(this.btn.find(".tb_module_panel_modules_wrap")[0]);
a.find(".simplebar-scroll-content").length&&(new SimpleBar(a[0])).recalculate();c.Mixins.Builder.initModuleDraggable(this.btn,".tb_module");c.Mixins.Builder.initModuleDraggable(this.btn.find(".tb_rows_grid").first(),".tb_row_grid");c.Mixins.Builder.initRowDraggable(this.btn,".tb_page_break_module");if(c.toolbar.libraryItems.is_init||"visual"===c.mode)c.Mixins.Builder.initModuleDraggable(this.btn.find(".tb_library_item_list").first(),".tb_item_module,.tb_item_part"),c.Mixins.Builder.initRowDraggable(this.btn.find(".tb_library_item_list").first(),
".tb_item_row");(c.toolbar.preDesignedRows.is_init||"visual"===c.mode)&&c.Mixins.Builder.initRowDraggable(this.btn.find(".tb_predesigned_rows_container").first(),".predesigned_row");this.is_init=!0;c.Mixins.Builder.initRowDraggable(this.btn.find(".tb_module_panel_rows_wrap").first(),".tb_page_break_module")},tabs:function(a){a.preventDefault();a.stopPropagation();a=g(a.currentTarget);var b=a.closest("ul"),d=a.data("target"),e=a.closest(".tb_modules_panel_wrap");e.find("."+a.data("hide")).hide();var f=
e.find("."+d),h=e.find(".tb_no_content");0<f.length?(h.hide(),f.show()):h.show();a.closest("li").addClass("current").siblings().removeClass("current");e.find(".tb_module_panel_search_text").val("").focus().trigger("keyup");g(p).triggerHandler("tb_panel_tab_"+d,e);d=b.parent().find(".tb_ui_dropdown_label");0<d.length&&d.text(a.text());c.Utils.hideOnClick(b)},show:function(a,b){a.preventDefault();a.stopPropagation();!c.activeModel&&r.document.body.classList.contains("tb_standalone_lightbox")&&l.Lightbox.close();
null===this.is_init&&this.run();this.clicked&&this.clicked[0].classList.remove("clicked");this.clicked=b?b:g(a.currentTarget);var d=this.clicked.offset(),e=t.body,f=d.left+this.clicked.width()/2,d=d.top,h="visual"!==c.mode?g(".edit-post-layout__content"):!1;!1!==h&&0<h.length&&(d+=h.scrollTop()-70,f=h.width()/2);f-=this.btn.outerWidth()/2;0>f&&(f=0);this.clicked.parents(".sub_column").length?this.btn[0].classList.add("tb_subrow_open"):this.btn[0].classList.remove("tb_subrow_open");this.btn.css({top:d,
left:f}).show();this.resize();var k=this.btn[0].getElementsByClassName("tb_predesigned_rows_container")[0];k.getElementsByClassName("simplebar-scroll-content").length&&(f=new SimpleBar(k),f.recalculate(),k=f.getScrollElement());k.addEventListener("scroll",c.toolbar.preDesignedRows.scrollLoadMore.bind(c.toolbar.preDesignedRows));"visual"===c.mode&&(e=e.add(g("body",r.document)),"desktop"!==c.activeBreakPoint&&(g("body",r.document).height(p.body.scrollHeight+this.btn.outerHeight(!0)),t.body.css("padding-bottom",
180)));e.addClass("tb_panel_dropdown_openend");this.clicked.addClass("clicked");"desktop"===c.activeBreakPoint&&setTimeout(function(){this.btn.find(".tb_module_panel_search_text").focus()}.bind(this),50);this.hide();c.ActionBar.clear();null!==c.activeModel&&(e=l.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0],e!==q&&e.click());var e=k.getElementsByTagName("img"),n=k.getElementsByClassName("simplebar-content");0<e.length?(e=e[e.length-1],g(e).one("load",function(){c.toolbar.preDesignedRows.masonry(n.length?
n[0]:k)})):c.toolbar.preDesignedRows.masonry(n.length?n[0]:k)},resize:function(){null!==this.btn&&c.Utils.addViewPortClass(this.btn[0])},hide:function(a){function b(){if(!0===a||!d.btn.is(":hover")){var e=t.body;null!==d.btn&&(d.btn.hide().css("width",""),d.clicked&&d.clicked[0].classList.remove("clicked"),d.clicked=null);g(p).off("click",b);g(r.document).off("click",b);"visual"===c.mode&&(e=e.add(g("body",r.document)),"desktop"!==c.activeBreakPoint&&(g("body",r.document).height(p.body.scrollHeight),
t.body.css("padding-bottom","")));e.removeClass("tb_panel_dropdown_openend")}}var d=this;if(!0===a)b();else{if("visual"===c.mode)g(r.document).on("click",b);g(p).on("click",b)}},search:function(a){var b=g(a.currentTarget);a=b.closest(".tb_modules_panel_wrap");var d=a.find(".tb_module_types .current").first().data("target"),e=!1,f=!1,h=!1,k=!1,b=g.trim(b.val());"tb_module_panel_modules_wrap"===d?(e=a.find(".tb_module_outer"),h=!0):"tb_module_panel_rows_wrap"===d&&c.toolbar.preDesignedRows.is_init?
(c.toolbar.preDesignedRows.addNewItems(b),f=a.find(".tb_ui_dropdown_label").data("active"),e=a.find(".predesigned_row")):"tb_module_panel_library_wrap"===d&&(e=a.find(".tb_library_item"),f=a.find(".tb_library_types .current").data("target"),k=!0);if(!1!==e){var n=""===b,m=n?!1:new RegExp(b,"i");e.each(function(){if(f&&!this.classList.contains(f))return!0;var a=h?g(this).find(".module_name"):k?g(this).find(".tb_library_item_inner span"):g(this).find(".tb_predesigned_rows_title");n||m.test(a.text())?
g(this).show():g(this).hide()});n?a.removeClass("tb_module_panel_searching"):a.addClass("tb_module_panel_searching");h&&a.find(".tb_module_category_content").each(function(){this.parentElement.style.display="block";g(this).find(".tb_module_outer:visible").length||(this.parentElement.style.display="none")})}},clear:function(a){a.preventDefault();a.stopPropagation();a=g(this).parent().children("input").first();0<a.length&&(a.val(""),a[0].hasAttribute("data-search")?a.trigger("keyup").focus():(a.trigger("change"),
t.triggerEvent(a[0],"change")))}},help:{init:function(){g(".tb_help_btn",c.toolbar.$el).on("click",this.show.bind(this))},show:function(a){a.preventDefault();a.stopPropagation();var b=this;l.showLoader("show");return g.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{tb_load_nonce:themifyBuilder.tb_load_nonce,action:"tb_help"},complete:function(){l.showLoader("spinhide")},success:function(a){r.document.body.insertAdjacentHTML("beforeend",a);a=g("#tb_help_lightbox",r.document.body);g(".tb_help_tab_link",
a).on("click",b.mainTabs.bind(b));g(".tb_player_btn",a).on("click",b.play.bind(b));g(".tb_help_menu a",a).on("click",b.tabs.bind(b));g(".tb_close_lightbox",a).on("click",b.close.bind(b));a.slideDown()}})},play:function(a){a.preventDefault();a.stopPropagation();a=g(a.currentTarget).closest("a");var b=a.prop("href"),d=p.createElement("iframe");d.setAttribute("frameborder","0");d.setAttribute("allow","autoplay; fullscreen");d.setAttribute("src",b+"?rel=0&showinfo=0&autoplay=1&enablejsapi=1&html5=1&version=3");
a.replaceWith(d)},tabs:function(a){a.preventDefault();a.stopPropagation();a=g(a.currentTarget);var b=g(".tb_help_video_wrapper",r.document),d=b.find(a.attr("href")),c=d.find(".tb_player_btn");b.find(".tb_player_wrapper").removeClass("current").hide();d.addClass("current").show();a.closest("li").addClass("current").siblings().removeClass("current");this.stopPlay();0<c.length?c.trigger("click"):this.startPlay()},execute:function(a,b){a.contentWindow.postMessage('{"event":"command","func":"'+b+'","args":""}',
"*")},stopPlay:function(){var a=this;g(".tb_player_wrapper",r.document).each(function(){if(!this.classList.contains("current")){var b=g(this).find("iframe");0<b.length&&a.execute(b[0],"pauseVideo")}})},startPlay:function(){var a=g(".tb_player_wrapper.current",r.document).find("iframe");0<a.length&&this.execute(a[0],"playVideo")},close:function(a,b){a.preventDefault();a.stopPropagation();g(a.currentTarget).closest("#tb_help_lightbox").slideUp("normal",function(){g(this).next(".tb_overlay").remove();
g(this).empty().remove();b&&b()})},mainTabs:function(a){a.preventDefault();a.stopPropagation();a=g(a.currentTarget);var b=g(".tb_help_lightbox_inner_wrapper",r.document);a.hasClass("tb_help_active_tab")||(b.find(".tb_help_active_tab").removeClass("tb_help_active_tab"),a.addClass("tb_help_active_tab"),b.attr("data-active-tab",a.data("type")))}},deviceSwitcher:function(a){var b=a.target,d=b.parentNode.previousElementSibling;d.classList.contains("tb_breakpoint_switcher")&&(a.tb_device=[b.dataset.width,
b.dataset.height],a.target=d,a.currentTarget=d,this.breakpointSwitcher(a))},breakpointSwitcher:function(a){a.preventDefault();a.stopPropagation();var b=this,d="desktop",e=a.currentTarget,f=g("body",r.document),h="visual"===c.mode&&c.iframe[0].classList.contains("tb_resizing_start"),k=c.activeBreakPoint,n=function(){b.responsive_grids(d,k);var a=function(){c.Utils.setCompactMode(p.getElementsByClassName("module_column"));c.toolbar.el.getElementsByClassName("tb_compact_switcher")[0].getElementsByTagName("i")[0].className=
e.getElementsByTagName("i")[0].className;f.removeClass("tb_start_animate").toggleClass("tb_responsive_mode","desktop"!==d).removeClass("builder-breakpoint-"+k).addClass("builder-breakpoint-"+d);t.body.triggerHandler("themify_builder_change_mode",[k,d]);"visual"===c.mode&&(c.iframe[0].style.willChange="",setTimeout(function(){r.document.body.style.height="desktop"!==d?p.body.scrollHeight+"px":"";!h&&c.scrollTo&&(g(x).add(r.document).scrollTop(c.scrollTo.offset().top),c.scrollTo=!1)},150));c.ActionBar.disable=
c.clearOnModeChange=null};"visual"===c.mode?c.Utils._onResize(!0,function(){b.iframeScroll("desktop"!==d);"desktop"!==k&&"desktop"!==d||c.Mixins.Builder.updateModuleSort(null,"desktop"===d?"enable":"disable");c.ActionBar.hoverCid=null;c.EdgeDrag.clearEdges();setTimeout(a,h?1:100)}):a()};e.classList.contains("breakpoint-tablet")?d="tablet":e.classList.contains("breakpoint-tablet_landscape")?d="tablet_landscape":e.classList.contains("breakpoint-mobile")&&(d="mobile");if(q!==a.tb_device||!t.body[0].classList.contains("builder-breakpoint-"+
d)){var m="desktop"!==d?q!==a.tb_device?"tablet_landscape"===d?a.tb_device[1]:a.tb_device[0]:c.Utils.getBPWidth(d)-1:"";if(k===d&&a.originalEvent!==q&&(m?m+"px":m)===c.iframe[0].style.width)return!1;c.ActionBar.disable=!0;if("visual"===c.mode){null===c.clearOnModeChange&&c.ActionBar.clear();if(!h&&!c.isPreview){var v=c.Instances.Builder[0].el.children;var u=[];for(var w=x.innerHeight,z=function(a){if(null!==a&&a!==q){var b=a.getBoundingClientRect();if(0>b.bottom&&0>b.top||b.top>w)a.style.display=
"none",u.push(a)}},A=v.length-1;-1<A;--A)z(v[A]);z(p.getElementById("headerwrap"));z(p.getElementById("footerwrap"));v=w=null}f=f.add(t.body)}c.activeBreakPoint=d;f.addClass("tb_start_animate");if("visual"===c.mode){c.iframe[0].style.willChange="width";v=r.document.getElementsByClassName("tb_toolbar_zoom_menu")[0];v.classList.remove("tb_toolbar_zoom_active");v.getElementsByClassName("tb_toolbar_zoom_menu_toggle")[0].dataset.zoom=100;"tablet_landscape"===d&&l.Lightbox.dockMode.get()&&(v=g(".tb_workspace_container",
r.document).width(),v<m&&(m=v));if(c.isPreview&&(v={tablet_landscape:[1024,768],tablet:[768,1024],mobile:[375,667]},v[d]!==q)){m=q==a.tb_device?v[d][0]:"tablet_landscape"===d?a.tb_device[1]:a.tb_device[0];var C=q==a.tb_device?v[d][1]:"tablet_landscape"===d?a.tb_device[0]:a.tb_device[1]}c.iframe[0].parentNode.classList.remove("tb_zoom_bg");h?n():(r.document.body.offsetHeight,c.iframe.one(c.Utils.transitionPrefix(),function(){if(!c.isPreview){for(var a=u.length-1;-1<a;--a)u[a].style.display="";u=null}setTimeout(n,
10)}),c.iframe[0].style.width=m?m+"px":m,c.iframe[0].style.height=c.isPreview?C?C+"px":C:"")}else n()}},iframeScroll:function(a){var b=g(r.document);b.off("scroll.themifybuilderresponsive");if(a)b.on("scroll.themifybuilderresponsive",function(){x.scrollTo(0,g(this).scrollTop())})},responsive_grids:function(a,b){for(var d=p.querySelectorAll(".row_inner,.subrow_inner"),c="desktop"===a,f=c||"desktop"===b,h=d.length-1;-1<h;--h){var k=d[h].getAttribute("data-basecol");if(null!==k){var n=d[h].children,
m=d[h].dataset["col_"+a],l=n[0],u=n[n.length-1];if(!c){if("desktop"!==b){d[h].classList.remove("tb_3col");var r=d[h].getAttribute("data-col_"+b);r&&d[h].classList.remove(g.trim(r.replace("tb_3col","").replace("mobile","column").replace("tablet","column")))}if(m&&"-auto"!==m&&m!==a+"-auto"){if(m=d[h].getAttribute("data-col_"+a))for(d[h].classList.add("tb_grid_classes"),d[h].classList.add("col-count-"+k),m=m.split(" "),k=0,r=m.length;k<r;++k)d[h].classList.add(g.trim(m[k].replace("mobile","column").replace("tablet",
"column")))}else d[h].classList.remove("tb_grid_classes"),d[h].classList.remove("col-count-"+k)}if(f)for(k=0,m=n.length;k<m;++k)r=g(n[k]).data("w"),r!==q&&(n[k].style.width=c?r+"%":"");"rtl"===d[h].getAttribute("data-"+a+"_dir")?(l.classList.remove("first"),l.classList.add("last"),u.classList.remove("last"),u.classList.add("first"),d[h].classList.add("direction-rtl")):(l.classList.remove("last"),l.classList.add("first"),u.classList.remove("first"),u.classList.add("last"),d[h].classList.remove("direction-rtl"))}}},
Panel:{el:null,init:function(){this.el=c.toolbar.$el.find(".tb_toolbar_add_modules_wrap");this.el.on("click",".add_module_btn",this.initEvents.bind(this));this.compactToolbar();"visual"===c.mode&&l.Lightbox.dockMode.setDoc()},initEvents:function(a){a.preventDefault();a.stopPropagation();var b=a.currentTarget.dataset.type;"module"===b?this.add_module(a):"row"===b?this.click_add_sub_row(a):"page_break"===b?this.click_add_page_break(a):"predesigned"===b&&c.toolbar.preDesignedRows.get(a.currentTarget.closest(".predesigned_row").dataset.slug,
function(a){var b=c.Instances.Builder[c.builderIndex].$el.find(".module_row").last();c.Mixins.Builder.rowDrop(a,g("<div>").insertAfter(b),!0)})},setFocus:function(){c.toolbar.el.getElementsByClassName("tb_module_panel_search_text")[0].focus()},add_module:function(a,b){a.preventDefault();a.stopPropagation();b&&0!==b.length||(b=c.Instances.Builder[c.builderIndex].newRowAvailable(1,!0).find(".tb_holder").first());c.Mixins.Builder.moduleDrop(g(a.currentTarget).closest(".tb_module"),b)},click_add_sub_row:function(a,
b){a.preventDefault();a.stopPropagation();var d=b?!0:!1;b=b||c.Instances.Builder[c.builderIndex].$el.find(".module_row").last();var e=g(a.currentTarget).closest(".tb_row_grid").data("slug");d?b.hasClass("tb_module_front")?c.Mixins.Builder.subRowDrop(e,g("<div>").insertAfter(b)):c.Mixins.Builder.subRowDrop(e,g("<div>").appendTo(b)):c.Mixins.Builder.rowDrop(c.Utils.grid(e),g("<div>").insertAfter(b),!0,!0)},click_add_page_break:function(a,b){a.preventDefault();a.stopPropagation();b=b||c.Instances.Builder[c.builderIndex].$el.find(".module_row").last();
c.Mixins.Builder.rowDrop(c.toolbar.pageBreakModule.get(),g("<div>").insertAfter(b),!0);c.toolbar.pageBreakModule.countModules()},compactToolbar:function(){function a(){c.toolbar.$el.outerWidth()<b?r.document.body.classList.add("tb_compact_toolbar"):r.document.body.classList.remove("tb_compact_toolbar");c.toolbar.common.resize()}var b="visual"===c.mode?850:750;g(r).on("tfsmartresize.compact",a);if("visual"===c.mode)r.jQuery("body").one("themify_builder_ready",a);else a()}},toggleFavoriteModule:function(){var a=
g(this),b=a.closest(".tb_module_outer"),d=a.parent().data("module-slug");g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_module_favorite",module_name:d,module_state:+!b.hasClass("favorited")},beforeSend:function(a){function e(a,b){function f(){var f;if(a.length){b&&(f=0<a.closest("#tb_module_panel_dropdown").length?c.toolbar.$el:g("#tb_module_panel_dropdown"));a.removeAttr("style");var h=a.data("categories").split(","),k=a.closest(".tb_module_panel_modules_wrap"),n=
k.find('.tb_module_category_content[data-category="favorite"]');if(a.hasClass("favorited")){for(var m=h.length-1;0<=m;m--){var l=k.find('.tb_module_category_content[data-category="'+h[m]+'"]').parent();l.find(".tb_module_outer.tb-module-"+d).css({opacity:0,transform:"scale(0.5)"}).remove();l.find(".tb_module_outer").length||l.css({display:"none"})}n.parent().css({display:"block"});a.clone().css({opacity:0,transform:"scale(0.5)"}).appendTo(n).css({opacity:1,transform:"scale(1)"})}else for(m=h.length-
1;0<=m;m--){l=k.find('.tb_module_category_content[data-category="'+h[m]+'"]');var q=a.clone().css({opacity:0,transform:"scale(0.5)"}).appendTo(l);l.parent().css({display:"block"});q.css({opacity:1,transform:"scale(1)"})}b&&e(f.find(".tb-module-type-"+d).closest(".tb_module_outer"),!1);a.remove();n.find(".tb_module_outer").length||n.parent().css({display:"none"})}}if(a.length&&!a.is(":visible"))a.toggleClass("favorited"),f();else a.css({opacity:0,transform:"scale(0.5)"}).one(h,function(){a.toggleClass("favorited").one(h,
f)})}var h=c.Utils.transitionPrefix();e(b,!0)}})},zoom:function(a){function b(){c.Utils._onResize(!0)}a.preventDefault();if("desktop"!==c.activeBreakPoint)return!0;var d=g(a.currentTarget);a=d.data("zoom");var e=g(".tb_iframe",r.document),f=d.closest(".tb_toolbar_zoom_menu");d.hasClass("tb_toolbar_zoom_menu_toggle")?(a="100"==a?50:100,d.data("zoom",a),d=d.next("ul").find('[data-zoom="'+a+'"]')):f.find(".tb_toolbar_zoom_menu_toggle").data("zoom",a);e.removeClass("tb_zooming_50 tb_zooming_75");d.parent().addClass("selected-zoom-size").siblings().removeClass("selected-zoom-size");
"50"==a||"75"==a?(d="50"==a?2:1.25,e.addClass("tb_zooming_"+a).one(c.Utils.transitionPrefix(),b).parent().addClass("tb_zoom_bg").css("height",Math.max(r.innerHeight*d,600)),f.addClass("tb_toolbar_zoom_active"),c.zoomMeta.isActive=!0,c.zoomMeta.size=a,t.body.addClass("tb_zoom_only")):(e.addClass("tb_zooming_"+a).one(c.Utils.transitionPrefix(),b).parent().css("height",""),f.removeClass("tb_toolbar_zoom_active"),c.zoomMeta.isActive=!1,t.body.removeClass("tb_zoom_only"))},previewBuilder:function(a){a.preventDefault();
g(a.currentTarget).toggleClass("tb_toolbar_preview_active");c.isPreview=!c.isPreview;c.isPreview||(c.iframe[0].style.height="");t.body.toggleClass("tb_preview_only themify_builder_active");g("body",r.document).toggleClass("tb_preview_parent");if(c.isPreview){a=p.getElementsByClassName("row_inner");for(var b=a.length-1;-1<b;--b)if(a[b].classList.contains("col-count-1")&&0===a[b].getElementsByClassName("active_module").length){var d=a[b].getElementsByClassName("module_column")[0];if((d=c.Models.Registry.lookup(d.getAttribute("data-cid")))&&
0===Object.keys(d.get("styling")).length){var d=a[b].closest(".module_row"),e=c.Models.Registry.lookup(d.getAttribute("data-cid"));e&&0===Object.keys(e.get("styling")).length&&d.classList.add("tb_hide")}}}else g(".tb_hide.module_row").removeClass("tb_hide");"visual"===c.mode&&!r.document.body.classList.contains("tb_panel_minimized")&&l.Lightbox.dockMode.get()&&c.Utils._onResize(!0);c.vent.trigger("dom:preview")},toggleAccordion:function(a){g(a.currentTarget).closest(".tb_module_panel_tab_acc_component").toggleClass("tb_collapsed")},
closeFloat:function(a){a&&(a.preventDefault(),a.stopPropagation(),localStorage.setItem("tb_panel_closed",!0));r.document.body.classList.add("tb_panel_closed")},openFloat:function(a){a&&(a.preventDefault(),a.stopPropagation(),localStorage.removeItem("tb_panel_closed"));r.document.body.classList.remove("tb_panel_closed");c.toolbar.common.hide(!0)}});c.Forms={Data:{},Validators:{},parseSettings:function(a,b){var d;var e="";var f=a.classList;if(!f.contains("tb_row_js_wrapper")){var h=a.closest(".tb_field");
if(null!==h&&!h.classList.contains("_tb_hide_binding")&&("none"!==h.style.display||-1===h.className.indexOf("tb_group_element_"))&&(h=h.parentNode,h.classList.contains("tb_multi_fields")&&h.parentNode.classList.contains("_tb_hide_binding")))return!1}h=b?a.getAttribute("data-input-id"):a.getAttribute("id");if(f.contains("tb_lb_wp_editor"))tinyMCE!==q?(e=a.id,f=tinyMCE.get(e),e=null!==f?!1===f.hidden?f.getContent():switchEditors.wpautop(tinymce.DOM.get(e).value):a.value):e=a.value;else if(f.contains("themify-checkbox")){e=
[];var k=a.getElementsByClassName("tb-checkbox");var n=f.contains("tb_switcher");for(var f=0,m=k.length;f<m;++f)!0!==n&&!0!==k[f].checked||""===k[f].value||e.push(k[f].value);e=0<e.length?e.join("|"):n?"":!1}else if(f.contains("themify-layout-icon"))e=a.getElementsByClassName("selected")[0],e=e!==q?e.id:"";else if(f.contains("tb_search_input"))e=a.getAttribute("data-value"),f.contains("query_category_single")&&(f=a.closest(".tb_input").getElementsByClassName("query_category_multiple")[0],f=f===q?
"":f.value.trim(),e=""!==f?f+"|"+(-1!==f.indexOf(",")?"multiple":"single"):e+"|single");else if(f.contains("tb_radio_input_container")){m=a.getElementsByTagName("input");k=null;for(f=m.length-1;-1<f;--f)if(!0===m[f].checked){k=m[f];break}null===k||"desktop"!==c.activeBreakPoint&&k.classList.contains("responsive_disable")||(e=k.value)}else if(f.contains("tb_search_container"))e=a.previousElementSibling.dataset.value;else if(f.contains("tb_row_js_wrapper")){e=[];var l=a.getElementsByClassName("tb_repeatable_field_content");
f=0;for(m=l.length;f<m;++f){k=l[f].getElementsByClassName("tb_lb_option_child");e[f]={};var u=0;for(d=k.length;u<d;++u)(n=this.parseSettings(k[u],!0))&&(e[f][n.id]=n.v)}}else if(f.contains("module-widget-form-container"))e=g(a).find(":input").themifySerializeObject();else if(f.contains("tb_widget_select"))e=a.getElementsByClassName("selected")[0],e=e!==q?e.dataset.value:"";else if(f.contains("tb_sort_fields_parent")){k=a.children;e=[];f=0;for(m=k.length;f<m;++f)if(n=k[f].getAttribute("data-type")){u=
k[f].getElementsByClassName("tb_sort_field_dropdown")[0];n={type:n,id:k[f].getAttribute("data-id")};if(u!==q)for(n.val={},l=u.getElementsByClassName("tb_lb_sort_child"),u=l.length-1;-1<u;--u)(d=this.parseSettings(l[u],!0))&&(n.val[d.id]=d.v);else d=k[f].getElementsByTagName("input")[0],u=d.value,""!==u&&(n.val=JSON.parse(u));e.push(n)}0===e.length&&(e="")}else if(f.contains("tb_accordion_fields"))for(k=a.children,e={},f=0,m=k.length;f<m;++f){if(l=k[f].getAttribute("data-id"))d=k[f].getElementsByTagName("input")[0],
u=k[f].getElementsByClassName("tb_accordion_fields_options")[0],n={},u!==q?n.val=this.serialize(u,null,!0):(u=d.value,""!==u&&(n.val=JSON.parse(u))),e[l]=n}else if(f.contains("tb_toggleable_fields"))for(k=a.children,e={},f=0,m=k.length;f<m;++f){if(l=k[f].getAttribute("data-id"))d=k[f].getElementsByTagName("input")[0],u=k[f].getElementsByClassName("tb_toggleable_fields_options")[0],n={on:k[f].getElementsByClassName("tb_switcher")[0].getElementsByClassName("toggle_switch")[0].value},u!==q?n.val=this.serialize(u,
null,!0):(u=d.value,""!==u&&(n.val=JSON.parse(u))),e[l]=n}else e=a.value,""!==e&&(f=a.getAttribute("data-opacity"),null!==f&&""!==f&&1!=f&&"0.99"!=f&&(e+="_"+f));if(e===q||null===e)e="";return{id:h,v:e}},serialize:function(a,b,d){d=d||!1;var c={};a="object"===typeof a?a:r.document.getElementById(a);if(null!==a){a=a.getElementsByClassName(d?"tb_lb_option_child":"tb_lb_option");for(var f=a.length-1;-1<f;--f){var h=this.parseSettings(a[f],d);!1===h||!0!==b&&""===h.v||(c[h.id]=h.v)}}return c},LayoutPart:{cache:[],
undo:null,old_id:null,isReload:null,id:null,init:!1,html:null,el:null,options:null,isSaved:null,scrollTo:function(a,b){c.scrollTo=c.Forms.LayoutPart.el},edit:function(a){function b(a){c.ActionBar.clear();p.getElementById("themify_builder_content-"+themifyBuilder.post_ID).insertAdjacentHTML("afterbegin",'<div class="tb_overlay"></div>');f.addClass("tb_active_layout_part").closest(".row_inner").find(".active_module").each(function(){this.classList.contains("tb_active_layout_part")||this.insertAdjacentHTML("afterbegin",
'<div class="tb_overlay"></div>')});var b="themify_builder_content-"+e.id;e.html=f[0].innerHTML;themifyBuilder.post_ID=ThemifyStyles.builder_id=e.id;f[0].insertAdjacentHTML("afterbegin",k.replace("#postID#",e.id));g("."+b).each(function(){g(this).closest(".active_module").find(".themify-builder-generated-css").first().prop("disabled",!0)});f.removeClass("active_module module").closest(".tb_holder").removeClass("tb_holder").addClass("tb_layout_part_parent").closest(".module_row").addClass("tb_active_layout_part_row");
h.attr("id",b).removeClass("not_editable_builder").addClass("tb_active_builder").empty();e.el=f;c.id=e.id;var d=[];c.builderIndex=1;c.Instances.Builder[c.builderIndex]=new c.Views.Builder({el:h,collection:new c.Collections.Rows(a),type:c.mode});a=c.Instances.Builder[c.builderIndex].render().el.querySelectorAll("[data-cid]");for(var b=0,n=a.length;b<n;++b)d[a[b].dataset.cid]=1;a=null;c.bootstrap(d,function(){f.triggerHandler("tb_layout_part_before_init");d=c.activeModel=null;c.Utils.loadContentJs(h);
c.id=!1;t.body.on("themify_builder_change_mode",e.scrollTo);c.hasChanged=null;c.Instances.Builder[c.builderIndex].$el.triggerHandler("tb_init");f.find(".tb_toolbar_save").on("click",e.save.bind(e));f.find(".tb_toolbar_close_btn").on("click",e.close.bind(e));f.find(".tb_load_layout").on("click",c.Views.Toolbar.prototype.loadLayout);f.find(".tb_toolbar_import ul a").on("click",c.Views.Toolbar.prototype["import"]);l.showLoader("hide");e.init=!1;e.undo=c.undoManager.stack;c.undoManager.btnUndo=f[0].getElementsByClassName("tb_undo_btn")[0];
c.undoManager.btnRedo=f[0].getElementsByClassName("tb_redo_btn")[0];c.undoManager.reset();f.find(".tb_undo_redo").on("click",function(a){c.undoManager.do_change(a)});"desktop"!==c.activeBreakPoint&&c.Mixins.Builder.updateModuleSort(null,"disable");"visual"===c.mode&&setTimeout(function(){c.Utils.checkAllimageSize()},500);c.ActionBar.disable=c.ActionBar.hoverCid=null;f.triggerHandler("tb_layout_part_after_init")})}c.ActionBar.disable=!0;l.showLoader("show");p.body.classList.add("tb_layout_part_edit");
if(null!==c.activeModel){var d=l.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];d!==q&&d.click();d=null}r.document.body.classList.add("tb_layout_part_edit");var e=this,f=g(a).closest(".active_module"),h=f.find(".themify_builder_content"),k=l.templateCache.get("tmpl-small_toolbar");this.id=h.data("postid");this.old_id=themifyBuilder.post_ID;this.init=!0;this.isSaved=null;this.cache[this.id]!==q?b(this.cache[this.id]):g.ajax({type:"POST",dataType:"json",url:themifyBuilder.ajaxurl,
data:{action:"tb_layout_part_swap",nonce:themifyBuilder.tb_load_nonce,id:e.id},success:function(a){if(a.data){e.cache[e.id]=a.data;if(a.gs)for(var d=Object.keys(a.gs),f=d.length-1;-1<f;--f)c.GS.styles[d[f]]===q&&(c.GS.styles[d[f]]=a.gs[d[f]]),"visual"===c.mode&&!0!==c.GS.styles[d[f]].cssLoaded&&(c.liveStylingInstance.setCss(c.GS.styles[d[f]].data,q,c.GS.styles[d[f]]["class"]),c.GS.styles[d[f]].cssLoaded=!0);b(a.data)}}})},close:function(a){function b(){d.el.removeClass("tb_active_layout_part").addClass("active_module module").closest(".tb_layout_part_parent").addClass("tb_holder").removeClass("tb_layout_part_parent").closest(".module_row").removeClass("tb_active_layout_part_row");
g("#tb_small_toolbar",d.el).remove();for(var a=e[0].querySelectorAll("[data-cid]"),b=a.length-1;-1<b;--b){var f=a[b].dataset.cid,m=c.Models.Registry.lookup(f);m&&(m.destroy(),c.Models.Registry.remove(f))}e.removeAttr("id").addClass("not_editable_builder").removeClass("tb_active_builder");p.body.classList.remove("tb_layout_part_edit");r.document.body.classList.remove("tb_layout_part_edit");g(".tb_overlay").remove();c.undoManager.stack=d.undo;c.undoManager.index=d.undo.length-1;c.undoManager.btnUndo=
c.toolbar.el.getElementsByClassName("tb_undo_btn")[0];c.undoManager.btnRedo=c.toolbar.el.getElementsByClassName("tb_redo_btn")[0];themifyBuilder.post_ID=ThemifyStyles.builder_id=d.old_id;d.undo=d.isSaved=d.old_id=d.html=d.id=d.options=d.isReload=d.el=c.Instances.Builder[c.builderIndex]=null;delete c.Instances.Builder[c.builderIndex];c.builderIndex=0;t.body.off("themify_builder_change_mode",d.scrollTo);c.Mixins.Builder.updateModuleSort();c.undoManager.updateUndoBtns();"desktop"!==c.activeBreakPoint&&
c.Mixins.Builder.updateModuleSort(null,"disable");c.ActionBar.hoverCid=null;c.ActionBar.clear();c.Instances.Builder[c.builderIndex].lastRowAddBtn()}a.preventDefault();a.stopPropagation();if(!c.hasChanged&&!c.undoManager.hasUndo()||null!==this.isSaved||confirm(themifyBuilder.i18n.layoutEditConfirm)){null!==c.activeModel&&l.Lightbox.close();var d=this,e=this.el.find(".themify_builder_content");if(null!==this.options){l.showLoader("show");a=c.Models.Registry.lookup(this.el.data("cid"));this.cache[this.id]=
this.options;g(p).ajaxComplete(function k(a,f,v){if(-1!==v.data.indexOf("tb_load_module_partial",3))if(g(this).off("ajaxComplete",k),200===f.status){d.el=c.liveStylingInstance.$liveStyledElmt;e=d.el.children(".themify_builder_content");var n=e[0].innerHTML,m="";d.el.children(".themify-builder-generated-css").each(function(){m+=this.outerHTML});g(".themify_builder_content-"+d.id).each(function(){var a=g(this).closest(".module");a.children("link.themify-builder-generated-css").remove();""!==m&&a[0].insertAdjacentHTML("afterbegin",
m);this.innerHTML=n;c.Utils.loadContentJs(g(this))});m=n=null;l.showLoader("hide");b()}else l.showLoader("error")});var f=g.extend(!0,{},a.get("mod_settings"));f.unsetKey=!0;a.trigger("custom:preview:refresh",f);f=null}else this.el[0].innerHTML=d.html,b(),g(".themify_builder_content-"+d.id).each(function(){g(this).closest(".active_module").find(".themify-builder-generated-css").removeAttr("disabled")}),c.Utils.loadContentJs(e)}},save:function(a,b){a.preventDefault();a.stopPropagation();if(null!==
c.activeModel){var d=l.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];d!==q&&d.click();d=null}if(c.undoManager.hasUndo()||null!==this.isReload||b){var e=this;this.old_settings=this.html=null;l.showLoader("show");c.Utils.saveBuilder(function(d){d.success&&(e.options=d.data.builder_data,c.hasChanged=null,e.isSaved=!0,b&&e.close(a))},1)}else l.showLoader("show"),setTimeout(function(){l.showLoader("hide")},100)}},reLoad:function(a,b,d){function e(){"visual"===c.mode&&(c.liveStylingInstance.setCss(c.Mixins.Builder.toJSON(c.Instances.Builder[h].el)),
c.Utils.loadContentJs(c.Instances.Builder[h].$el),c.id=!1);c.Instances.Builder[c.builderIndex].$el.triggerHandler("tb_init");l.showLoader("hide");"visual"===c.mode&&"desktop"!==c.activeBreakPoint&&(g("body",r.document).height(p.body.scrollHeight),setTimeout(function(){g("body",r.document).height(p.body.scrollHeight)},2E3));d&&d();c.hasChanged=!0;"visual"===c.mode&&setTimeout(function(){c.Utils.checkAllimageSize()},500)}var f=null!==c.Forms.LayoutPart.id,h=c.builderIndex,k=null,n="";c.Mixins.Builder.updateModuleSort(null,
"destroy");f||(c.Models.Registry.destroy(),c.Instances.Builder={});"visual"===c.mode?(n="#themify_builder_content-"+b,c.id=b,f||(c.liveStylingInstance.reset(),c.editing=!1,t.body.addClass("sidebar-none full_width"),g("#sidebar,.page-title").remove())):n="#tb_row_wrapper";if(f){b=c.Instances.Builder[h].el.querySelectorAll("[data-cid]");c.Forms.LayoutPart.isReload=!0;for(var m=0,v=b.length;m<v;++m){var q=b[m].dataset.cid,w=c.Models.Registry.lookup(q);w&&(w.destroy(),c.Models.Registry.remove(q))}b=null;
c.Instances.Builder[h].$el.empty()}c.Instances.Builder[h]=new c.Views.Builder({el:n,collection:new c.Collections.Rows(a),type:c.mode});c.Instances.Builder[h].render();c.undoManager.reset();if(f){k=[];b=c.Instances.Builder[h].el.querySelectorAll("[data-cid]");m=0;for(v=b.length;m<v;++m)k[b[m].dataset.cid]=1;b=null}"visual"===c.mode?c.bootstrap(k,e):e()},isValidate:function(a){var b=a.getElementsByClassName("tb_must_validate"),d=b.length;if(0===d)return!0;for(var e=!0,d=d-1;-1<d;--d){var f=b[d].getElementsByClassName("tb_lb_option")[0],
g=b[d].getAttribute("data-validation"),k=f.value;if(c.Forms.get_validator(g)(k))for(f.classList.remove("tb_field_error"),f=b[d].getElementsByClassName("tb_field_error_msg"),g=f.length-1;-1<g;--g)f[g].parentNode.removeChild(f[g]);else f.classList.contains("tb_field_error")||(e=p.createElement("span"),e.className="tb_field_error_msg",e.textContent=b[d].getAttribute("data-error-msg"),f.classList.add("tb_field_error"),f="SELECT"===f.tagName?f.parentNode:f,f.parentNode.insertBefore(e,f.nextSibling)),e=
!1}!1===e&&(a=l.Lightbox.$lightbox.find('[href="#'+a.getAttribute("id")+'"]')[0],a.parentNode.classList.contains("current")||a.click());return e}};c.Utils={onResizeEvents:[],gridClass:"col-full col2-1 col3-1 col4-1 col5-1 col6-1 col4-2 col4-3 col3-2".split(" "),_onResize:function(a,b){var d=g._data(x,"events").resize;g(r).off("tfsmartresize.tb_visual").on("tfsmartresize.tb_visual",function(a){""===tbLocalScript.fullwidth_support&&(g(x).triggerHandler("tfsmartresize.tbfullwidth"),g(x).triggerHandler("tfsmartresize.tfVideo"))}).off("tfsmartresize.zoom").on("tfsmartresize.zoom",
function(){if(c.zoomMeta.isActive){var a="50"==c.zoomMeta.size?2:1.25;g(".tb_workspace_container",r.document).css("height",Math.max(r.innerHeight*a,600))}});if(d!==q)for(var e=0,f=d.length;e<f;++e)d[e].handler!==q&&this.onResizeEvents.push(d[e].handler);g(x).off("resize");if(a){d=g.Event("resize",{type:"resize",isTrigger:!1});e=0;for(f=this.onResizeEvents.length;e<f;++e)try{this.onResizeEvents[e].apply(x,[d,g])}catch(h){}"function"===typeof b&&b()}},_addNewColumn:function(a,b){var d=c.Views.init_column({grid_class:a.newclass,
component_name:a.component});b.appendChild(d.view.render().el)},filterClass:function(a){a=a.split(" ");for(var b=[],d=a.length-1;-1<d;--d)-1!==this.gridClass.indexOf(a[d])&&b.push(a[d]);return b.join(" ")},_getRowSettings:function(a,b){var d={};b=b||"row";var e={};var f,g=c.Models.Registry.lookup(a.getAttribute("data-cid"));if(g){var k=a.getElementsByClassName(b+"_inner")[0];e=k.children;for(var n=this,m=function(a){a=a.children;for(var b=0,d=a.length;b<d;++b){a[b].classList.contains("active_module")||
m(a[b]);var e=c.Models.Registry.lookup(a[b].getAttribute("data-cid"));e&&(f=e.get("mod_settings"),e=t.push({mod_name:e.get("mod_name"),element_id:e.get("element_id")})-1,f&&0<Object.keys(f).length&&(delete f.cid,t[e].mod_settings=f),a[b].classList.contains("module_subrow")&&(t[e]=n._getRowSettings(a[b],"subrow")))}},l=0,u=e.length;l<u;++l){var p={};var r=c.Models.Registry.lookup(e[l].getAttribute("data-cid"));if(r){p=e[l].getElementsByClassName("tb_holder")[0];var t=[];p!==q&&m(p);d[l]={element_id:r.get("element_id"),
grid_class:this.filterClass(e[l].className)};t&&0<t.length&&(d[l].modules=t);p=parseFloat(e[l].style.width);0<p&&!isNaN(p)&&(d[l].grid_width=p);(f=r.get("styling"))&&0<Object.keys(f).length&&(delete f.cid,d[l].styling=f)}}e={element_id:g.get("element_id"),cols:d,column_alignment:g.get("column_alignment"),gutter:g.get("gutter"),column_h:g.get("column_h")};u={gutter:"gutter-default",column_alignment:E?"col_align_middle":"col_align_top"};d={desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",
mobile_dir:"ltr",col_tablet_landscape:"-auto",col_tablet:"-auto",col_mobile:"-auto"};for(l in e)""!==e[l]&&null!==e[l]&&e[l]!==u[l]||delete e[l];f=g.get("styling");for(l in d)g=k.getAttribute("data-"+l),null===g||""===g||g===d[l]||"-auto"===d[l]&&-1!==g.indexOf("-auto")||(e[l]=g.trim());f&&0<Object.keys(f).length&&(delete f.cid,e.styling=f)}return e},selectedGridMenu:function(a,b){var d=ThemifyConstructor.breakpointsReverse,e=c.Models.Registry.lookup(a.getAttribute("data-cid")),f=a.getElementsByClassName(b+
"_inner")[0],g=e.get("gutter"),k=e.get("column_alignment"),n=e.get("column_h");var m=e.get("desktop_dir");var l="row"===b?e.get("styling"):null,p=[],r={};var t=f.children;for(var A=0,C=t.length;A<C;++A)t[A].className=t[A].className.replace(/first|last/ig,""),1!==C&&(0===A?t[A].className+="rtl"===m?" last":" first":A===C-1&&(t[A].className+="rtl"===m?" first":" last"));t=t.length;p.push("col-count-"+t);r["data-basecol"]=t;null!==l&&l.row_anchor!==q&&""!==l.row_anchor&&(a.getElementsByClassName("tb_row_anchor")[0].textContent=
l.row_anchor);"gutter-default"!==g&&p.push(g);n&&p.push("col_auto_height");k||(k="col_align_top");p.push(k);"ltr"!==m&&p.push("direction-rtl");for(g=d.length-1;-1<g;--g)m=e.get(d[g]+"_dir"),"ltr"!==m&&""!==m&&(r["data-"+d[g]+"_dir"]=m),"desktop"!==d[g]&&(t=e.get("col_"+d[g]),"-auto"!==t&&""!==t&&t!==q&&(r["data-col_"+d[g]]=t));for(A=p.length-1;-1<A;--A)p[A]&&f.classList.add(p[A]);for(A in r)f.setAttribute(A,r[A])},clear:function(a,b,d){b===q&&(b=Array.isArray(a));var c=!0===b?[]:{},f;for(f in a)if(Array.isArray(a[f])){var h=
this.clear(a[f],!0,1);0<h.length&&(!0===b?c.push(h):c[f]=h)}else if("object"===typeof a[f])h=this.clear(a[f],!1,1),g.isEmptyObject(h)||(c[f]=h);else if(null!==a[f]&&a[f]!==q&&""!==a[f]&&"def"!==a[f]&&""!==f&&"pixels"!==a[f]&&"default"!==a[f]&&"|"!==a[f]&&!("show"===a[f]&&0===f.indexOf("visibility_")||"unstick_when_condition"===f&&"hits"===a[f]||("stick_at_pos_val_unit"===f||"unstick_when_pos_val_unit"===f)&&"px"===a[f]))if("custom_parallax_scroll_speed"!==f||a[f]&&"0"!=a[f])if("unstick_when_element"===
f&&"builder_end"===a[f]||"stick_at_check"===f&&"stick_at_check"!==a[f])delete c.unstick_when_el_row_id,delete c.unstick_when_el_mod_id,delete c.unstick_when_condition,delete a.unstick_when_el_row_id,delete a.unstick_when_el_mod_id,delete a.unstick_when_condition,delete c.unstick_when_pos,delete c.unstick_when_pos_val,delete c.unstick_when_element,delete c.unstick_when_pos_val_unit,delete a.unstick_when_pos,delete a.unstick_when_pos_val,delete a.unstick_when_pos_val_unit,delete a.unstick_when_element,
"stick_at_check"===f&&(delete a[f],delete c[f],delete a.stick_at_position,delete c.stick_at_position);else if("stick_at_position"===f&&"top"===a[f]||"__dc__"===f&&"{}"===a[f]||"background_gradient-css"===f||"cover_gradient-css"===f||"cover_gradient_hover-css"===f||"background_image-type_image"===f||"custom_parallax_scroll_reverse_reverse"===f||"|single"===a[f]||"|multiple"===a[f]||("custom_parallax_scroll_reverse"===f||"custom_parallax_scroll_fade"===f||"visibility_all"===f||"sticky_visibility"===
f)&&!a[f])delete a[f],delete c[f];else{if(1===d){var k=[];if("px"===a[f]&&-1!==f.indexOf("_unit",2))h=f.replace("_unit",""),a[h]||k.push(f);else if(0===f.indexOf("checkbox_")&&-1!==f.indexOf("_apply_all",6)){a[f]?c[f]=a[f]:k.push(f);h=f.replace("_apply_all","").replace("checkbox_","");for(var n=["top","left","right","bottom"],m=3;-1<m;--m){var l=h+"_"+n[m]+"_unit";"px"===a[l]?k.push(l):a[l]!==q&&null!==a[l]&&""!==a[l]&&(c[l]=a[l])}}else-1!==f.indexOf("gradient",3)?("180"==a[f]||"linear"===a[f]||a[f]===
g.ThemifyGradient["default"]||!1===a[f]&&-1!==f.indexOf("-circle-radial",3))&&k.push(f):("background_zoom"===f&&""===a[f]||"solid"===a[f]||!1===a[f]&&(-1!==f.indexOf("_user_role",3)||-1!==f.indexOf("_appearance",3)))&&k.push(f);if(0<k.length){for(m=k.length-1;-1<m;--m)delete c[k[m]],delete a[k[m]];k.length=0;continue}}!0===b?c.push(a[f]):c[f]=a[f]}else delete c.custom_parallax_scroll_reverse,delete c.custom_parallax_scroll_fade,delete c[f],delete a.custom_parallax_scroll_reverse,delete a.custom_parallax_scroll_fade,
delete a[f];return c},clearElementId:function(a,b){for(var d in a){!0===b?a[d].element_id=c.Utils.generateUniqueID():delete a[d].element_id;var e=a[d].styling!==q?a[d].styling:a[d].mod_settings;if(e!==q){if(e.custom_css_id!==q&&""!==e.custom_css_id)for(var f=2;;){var g=e.custom_css_id+"-"+f.toString(),k=p.getElementById(g);if(null===k||null===k.closest(".module_row")){e.custom_css_id=g;break}++f}e.builder_content!==q&&(f=JSON.parse(e.builder_content),this.clearElementId(f,!0),e.builder_content=JSON.stringify(f))}a[d].cols!==
q?this.clearElementId(a[d].cols,b):a[d].modules!==q&&this.clearElementId(a[d].modules,b)}},clearLastEmptyRow:function(a){for(var b=a.length-1;-1<b;--b){var d=a[b].attributes!==q?a[b].attributes:a[b];if(d.styling===q||null===d.styling||0===Object.keys(d.styling).length){var d=d.cols,e=!0,f;for(f in d)if(d[f].modules!==q&&(0<d[f].modules.length||0<Object.keys(d[f].modules).length)||d[f].styling!==q&&null!==d[f].styling&&0<Object.keys(d[f].styling).length){e=!1;break}if(!0===e)a[b].cid!==q&&(c.Models.Registry.remove(a[b].cid),
a[b].destroy()),a.splice(b,1);else break}else break}},builderPlupload:function(a,b){var d=b?!0:!1,e=d?[b]:l.Lightbox.$lightbox[0].getElementsByClassName("tb_plupload_upload_uic"),f=e.length;if(0<f){var h=d?!1:"new_elemn"===a?".plupload-clone":!1;this.pconfig===q&&(this.pconfig=JSON.parse(JSON.stringify(themify_builder_plupload_init)),this.pconfig.multipart_params._ajax_nonce=themifyBuilder.tb_load_nonce,this.pconfig.multipart_params.topost=themifyBuilder.post_ID);for(--f;-1<f;--f)if(!e[f].classList.contains("tb_plupload_init")&&
(!1===h||e[f].classList.contains(h))){var k=e[f],n=k.getAttribute("id").replace("tb_plupload_upload_ui",""),m=g.extend(!0,{},this.pconfig),p=k.getAttribute("data-extensions"),u=["browse_button","container","drop_element","file_data_name"];m.multipart_params.imgid=n;for(var w=u.length-1;-1<w;--w)m[u[w]]=n+this.pconfig[u[w]];m.filters[0].extensions=null!==p?p:null!==c.activeModel?m.filters[0].extensions.replace(/\,zip|\,txt/,""):"zip,txt";n=new r.plupload.Uploader(m);k.classList.add("tb_plupload_init");
d&&n.bind("init",function(a){g(a.settings.browse_button).click()});n.bind("FilesAdded",function(a,b){a.refresh();a.start();l.showLoader("show")});n.bind("Error",function(a,b){var d=g(".prompt-box .show-error");g(".prompt-box .show-login").hide();d.show();0<d.length&&d.html('<p class="prompt-error">'+b.message+"</p>");g(".overlay, .prompt-box").fadeIn(500)});n.bind("FileUploaded",function(a,b,f){var e=JSON.parse(f.response);a=g("#tb_alert",r.document);f=200!==f.status||e.error?"error":"done";if(e.error)l.showLoader(f),
alert(e.error);else if(d){var h=g("#tb_row_wrapper").children().clone(!0);a.promise().done(function(){c.Forms.reLoad(e.builder_data,themifyBuilder.post_ID);var a=g("#tb_row_wrapper").children().clone(!0);l.Lightbox.close();"visual"===c.mode&&q!==e.gsType&&(themifyBuilder.globalStyleData.type=e.gsType);if(e.used_gs)for(var b=Object.keys(e.used_gs),d=b.length-1;-1<d;--d)c.GS.styles[b[d]]==q&&(c.GS.styles[b[d]]=e.used_gs[b[d]]),"visual"===c.mode&&!0!==c.GS.styles[b[d]].cssLoaded&&(c.liveStylingInstance.setCss(c.GS.styles[b[d]].data,
q,c.GS.styles[b[d]]["class"]),c.GS.styles[b[d]].cssLoaded=!0);c.undoManager.push("","","","import",{before:h,after:a,bid:themifyBuilder.post_ID})})}else l.showLoader(f),a=this.getOption().container.closest(".tb_input"),f=a.getElementsByClassName("tb_uploader_input")[0],a=a.getElementsByClassName("thumb_preview")[0],f.value=e.large_url?e.large_url:e.url,a!==q&&ThemifyConstructor.file.setImage(a,e.thumb),t.triggerEvent(f,"change")});n.init();k.classList.remove("plupload-clone")}}},columnDrag:function(a,
b,d,e){var f=this;b&&(b=a?a.children(".module_column"):g(".module_column"),b.css("width",""),f.setCompactMode(b));if(d&&e){a=a.children(".module_column");var h=("gutter-narrow"===d?1.6:"gutter-none"===d?0:3.2)-("gutter-narrow"===e?1.6:"gutter-none"===e?0:3.2),h=parseFloat(h*(a.length-1)/a.length);a.each(function(a){g(this).prop("style").width&&(a=parseFloat(g(this).prop("style").width)+h,g(this).css("width",a+"%"))})}else{var k={"col6-1":14,"col5-1":17.44,"col4-1":22.6,"col4-2":48.4,"col2-1":48.4,
"col4-3":74.2,"col3-1":31.2,"col3-2":65.6},n={"col6-1":15.33,"col5-1":18.72,"col4-1":23.8,"col4-2":49.2,"col2-1":49.2,"col4-3":74.539,"col3-1":32.266,"col3-2":66.05},m={"col6-1":16.666,"col5-1":20,"col4-1":25,"col4-2":50,"col2-1":50,"col4-3":75,"col3-1":33.333,"col3-2":66.666};(a?a.children(".module_column").find(".tb_grid_drag"):g(".tb_grid_drag")).each(function(){var a,b,d,e,h=0,q,p=!1,r=0,x=!1,y,B,D,F=null,E=null,G;g(this).draggable({axis:"x",cursor:"col-resize",distance:0,scroll:!1,snap:!1,containment:".row_inner",
helper:function(d){a=g(d.currentTarget);b=a.closest(".subrow_inner");0===b.length&&(b=a.closest(".row_inner"));q=a[0].classList.contains("tb_drag_right")?"w":"e";y="w"===q?"tb_grid_drag_right_tooltip":"tb_grid_drag_left_tooltip";x=l.clone(b.closest(".module_row"));b.addClass("tb_drag_column_start");return g('<div class="ui-widget-header tb_grid_drag_tooltip '+y+'"></div><div class="ui-widget-header tb_grid_drag_tooltip"></div>')},start:function(f,g){c.ActionBar.disable=!0;c.ActionBar.clear();d=b.children(".module_column");
e=a.closest(".module_column");D=b[0].classList.contains("direction-rtl");"w"===q?(p=D?e.prev(".module_column"):e.next(".module_column"),h=a.outerWidth(),G=e.outerWidth()):(p=D?e.next(".module_column"):e.prev(".module_column"),G=h=e.outerWidth());h=parseInt(h);r=parseInt(p.outerWidth())-2;B=b.outerWidth();F=e.addClass("tb_drag_column_current").children("."+y)[0];E=e.children(".tb_grid_drag_tooltip").last()[0]},stop:function(a,l){g(".tb_grid_drag_tooltip").remove();b.removeClass("tb_drag_column_start");
var v=Math.ceil(100*(e.outerWidth()/B));e.removeClass("tb_drag_column_current").css("width",v+"%");var u=k,v=3.2;b[0].classList.contains("gutter-narrow")?(u=n,v=1.6):b[0].classList.contains("gutter-none")&&(u=m,v=0);var w=v*(d.length-1);d.each(function(a){a!==p.index()&&(g(this).prop("style").width?a=parseFloat(g(this).prop("style").width):(a=g.trim(f.filterClass(g(this).attr("class")).replace("first","").replace("last","")),a=u[a]),w+=a)});p.css("width",100-w+"%");p=p.add(e);f.setCompactMode(p);
var v=b.closest(".module_row"),z=!0===c.hasChanged;c.hasChanged=!0;c.undoManager.push(v.data("cid"),x,v,"row");c.hasChanged=z;t.body.triggerHandler("tb_grid_changed",[v]);setTimeout(function(){c.ActionBar.disable=null},5);F=E=h=r=B=G=p=y=e=q=D=b=d=null},drag:function(a,b){if(p&&0<p.length){var d=parseInt(b.position.left),d=h+("e"===q?-d:d),c=parseFloat(100*d/B);if(5<=c&&100>c){var f=r,f=f+("w"===q?-(d-G):G-d),g=parseFloat(100*f/B);5<g&&100>g&&(p.css("width",f+"px"),e.css("width",d+"px"),F.innerHTML=
c.toFixed(2)+"%",E.innerHTML=g.toFixed(2)+"%")}}}})})}},grid:function(a){var b=[];a=parseInt(a);if(1===a)b.push({grid_class:"col-full"});else for(var d=0;d<a;++d)b.push({grid_class:"col"+a+"-1"});return[{cols:b}]},setCompactMode:function(a){a instanceof jQuery&&(a=a.get());for(var b=a.length-1;-1<b;--b)185>a[b].clientWidth?a[b].classList.add("compact-mode"):a[b].classList.remove("compact-mode")},initNewEditor:function(a){if(3<parseInt(tinyMCE.majorVersion)){var b=tinyMCEPreInit.mceInit.tb_lb_hidden_editor;
b.elements=a;b.selector="#"+a;a=new tinyMCE.Editor(a,b,tinyMCE.EditorManager);a.render();return a}},initQuickTags:function(a){"function"===typeof r.QTags&&(r.quicktags({id:a}),r.QTags._buttonsInit())},_getColClass:function(a){for(var b=0,d=a.length;b<d;++b)if(-1!==this.gridClass.indexOf(a[b]))return a[b].replace("col","")},saveBuilder:function(a,b,d){b=b||0;if(0===b){if(null!==c.activeModel||0<l.Lightbox.$lightbox.length&&l.Lightbox.$lightbox[0].classList.contains("tb_custom_css_lightbox")){var e=
l.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];e!==q&&e.click();e=null}l.showLoader("show")}var f=Object.keys(c.Instances.Builder).length,h=c.Instances.Builder[b],k=this,e=h.$el.data("postid"),h=c.Mixins.Builder.toJSON(h.el);(function(a,b){var e=ThemifyStyles.createCss(b,null,!0);b=c.Utils.clear(b);if(Object.keys(c.GS.styles).length){var f=c.GS.findUsedItems(b);!1!==f&&(e=c.GS.attachCSS(e,f))}f={action:"tb_save_data",tb_load_nonce:themifyBuilder.tb_load_nonce,id:a,data:JSON.stringify(b),
custom_css:B,sourceEditor:"visual"===c.mode?"frontend":"backend"};d&&(f.only_data=d);g.ajax({type:"POST",url:themifyBuilder.ajaxurl,cache:!1,data:{css:JSON.stringify(e),action:"tb_save_css",custom_css:B,tb_load_nonce:f.tb_load_nonce,id:f.id}});return g.ajax({type:"POST",url:themifyBuilder.ajaxurl,cache:!1,data:f})})(e,h).always(function(e,h){++b;f===b?(g.isFunction(a)&&a.call(k,e,h),"success"!==h?l.showLoader("error"):(l.showLoader("hide"),c.editing=!0,t.body.triggerHandler("themify_builder_save_data",
[e,h]))):setTimeout(function(){k.saveBuilder(a,b,d)},50)})},loadContentJs:function(a,b){ThemifyBuilderModuleJs.loadOnAjax(a,b);if(!1===c.saving){var d=g("audio.wp-audio-shortcode, video.wp-video-shortcode",a);if(0<d.length){if(themifyBuilder.media_css){for(var e in themifyBuilder.media_css)t.LoadCss(themifyBuilder.media_css[e]);themifyBuilder.media_css=null}d.each(function(){var a=g(this).closest(".mejs-mediaelement");0<a.length&&(this.removeAttribute("style"),this.setAttribute("id",this.getAttribute("id").replace("_html5",
"")),a.closest(".widget").html(this))});d.mediaelementplayer("undefined"!==typeof r._wpmejsSettings?r._wpmejsSettings:{})}}t.body.triggerHandler("builder_load_module_partial",[a,b])},createClearBtn:function(a){a.siblings(".tb_clear_btn").click(function(){g(this).hide();a.val("").trigger("keyup")})},toRGBA:function(a){return ThemifyStyles.toRGBA(a)},getColor:function(a){var b=a.value;""!==b&&(null!==a.getAttribute("data-minicolors-initialized")?b=g(a).minicolors("rgbaString"):(a=a.getAttribute("data-opacity"),
""!==a&&null!==a&&"1"!=a&&"0.99"!=a&&(b=this.toRGBA(b+"_"+a))));return b},getIcon:function(a){var b=a.split("-")[0].trim();return"fa"===b||"ti"===b?b+" "+a:"fas fa"===b||"far fa"===b||"fab fa"===b?a:!1},getBPWidth:function(a){a=Array.isArray(themifyBuilder.breakpoints[a])?themifyBuilder.breakpoints[a]:themifyBuilder.breakpoints[a].toString().split("-");return a[a.length-1]},transitionPrefix:function(){if(this.transitionPrefix.pre===q){var a=p.createElement("fakeelement"),b={transition:"transitionend",
OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},d;for(d in b)if(a.style[d]!==q){this.transitionPrefix.pre=b[d];break}}return this.transitionPrefix.pre},generateUniqueID:function(){return(Math.random().toString(36).substr(2,4)+(new Date).getUTCMilliseconds().toString()).substr(0,7)},getUIDList:function(a){a=a||"row";var b=_.pluck(c.Models.Registry.items,"attributes");return _.where(b,{elType:a})||[]},scrollTo:function(a){("desktop"===c.activeBreakPoint?
g("html,body"):g("body",r.document)).scrollTop(a)},scrollToDropped:function(a,b){a||(a=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_element_cid_"+b)[0]);if(a)if("visual"===c.mode)this.scrollTo(g(a).offset().top-120);else{var d=p.getElementsByClassName("edit-post-layout__content")[0];if(d!==q){if(a.classList.contains("module_row"))var e=a.offsetTop;else e=a.closest(".module_row"),null!==e?(e=g(e),e=e.offset().top+200-e.offsetParent().offset().top):e=a.offsetTop;g(d).scrollTop(e)}}},
addViewPortClass:function(a){this.removeViewPortClass(a);var b=this.isInViewport(a);if(!1!==b)for(var b=b.split(" "),d=b.length-1;-1<d;--d)""!==b[d]&&a.classList.add(b[d])},removeViewPortClass:function(a){for(var b=["top","left","bottom","right"],d=4;-1<d;--d)a.classList.remove("tb_touch_"+b[d])},isInViewport:function(a){a=a.getBoundingClientRect();var b="";0>a.left?b="tb_touch_left":a.right-1>=p.documentElement.clientWidth&&(b="tb_touch_right");0>a.top?b+=" tb_touch_top":a.bottom+1>=p.documentElement.clientHeight&&
(b+=" tb_touch_bottom");return""===b?!1:b},checkImageSize:function(a){var b=a.getElementsByTagName("img")[0],d=function(d){b.width<d?a.classList.add("tb_disable_object_fit"):a.classList.remove("tb_disable_object_fit")};if(b!==q){var c=b.naturalWidth;if(c&&b.complete)d(c);else{var f=new Image;f.onload=function(){d(f.width)};f.src=b.src}}else a.classList.remove("tb_disable_object_fit")},checkAllimageSize:function(){var a=c.Instances.Builder[c.builderIndex].el,b=c.Models.Registry.items,d;for(d in b)if("image"===
b[d].attributes.mod_name){var e=a.getElementsByClassName("tb_element_cid_"+b[d].cid)[0];e!==q&&this.checkImageSize(e)}},hideOnClick:function(a){a[0]!==q&&(a=a[0]);if(a.classList.contains("tb_ui_dropdown_items")||a.classList.contains("tb_down"))a.classList.add("tb_hide_option"),a.previousElementSibling.blur(),setTimeout(function(){a.classList.remove("tb_hide_option")},500)},changeOptions:function(a,b){var d="INPUT"===a.tagName?"keyup":"change",e=this;"keyup"===d&&a.setAttribute("data-prev",a.value);
e.custom_css_id=function(a,b,d,c){a=p.getElementById(c);return null===a||d[0].getAttribute("id")===c||null===a.closest(".module_row")?(d[0].setAttribute("id",c),!0):!1};e.row_anchor=function(a,b,d,e){"visual"===c.mode&&(d.removeClass(c.liveStylingInstance.getRowAnchorClass(a.getAttribute("data-prev"))),""!==e&&d.addClass(c.liveStylingInstance.getRowAnchorClass(e)),d.data("anchor",e).attr("data-anchor",e));c.hasChanged=!0;d.find(".tb_row_anchor").first().text(e.replace("#",""));return!0};e.custom_css=
function(a,b,d,e){"visual"===c.mode&&d.removeClass(a.getAttribute("data-prev")).addClass(e);return!0};e.layout=function(a,b,d,e){"visual"===c.mode&&c.liveStylingInstance.bindRowWidthHeight(b,e,d);return!0};a.addEventListener(d,function(a){var f=null!==c.activeModel&&c.ActionBar.cid===c.activeModel.cid,k=!l.Lightbox.$lightbox[0].contains(this),n=this.id,m="custom_css_id"===n,r=!0!==m||!1!==k&&!0!==f?q:l.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];var u=!0===k&&!1===f?g(".tb_element_cid_"+
c.ActionBar.cid):"visual"===c.mode?c.liveStylingInstance.$liveStyledElmt:g(".tb_element_cid_"+c.activeModel.cid);var t=this.value;"keyup"===d&&"custom_css"!==b?((t=t.trim())&&(t=t.replace(/[^a-zA-Z0-9\-\_]+/gi,"")),this.value=t):"layout"===b&&(t=a.detail.val);if(e[b].call(e,this,n,u,t)){m&&(g(this).next(".tb_field_error_msg").remove(),r!==q&&r.classList.remove("tb_disable_save"));if(!0===k){var z=function(){var a=t;"keyup"===d&&(this.removeEventListener("change",z,{passive:!0,once:!0}),this.removeAttribute("data-isInit"),
a=this.value.trim());var b=c.Models.Registry.lookup(u.data("cid")),e=b.get("styling");e||(e={});e[n]=a;b.set({styling:e},{silent:!0})};"keyup"===d?this.getAttribute("data-isInit")||(this.setAttribute("data-isInit",1),this.addEventListener("change",z,{passive:!0,once:!0})):z()}c.hasChanged=!0}else m&&(a=p.createElement("span"),a.className="tb_field_error_msg",a.textContent=ThemifyConstructor.label.errorId,this.parentNode.insertBefore(a,this.nextSibling),r!==q&&r.classList.add("tb_disable_save"));!0===
f&&(f=k?l.Lightbox.$lightbox.find("#"+n):g("#"+c.ActionBar.el.id).find("#"+n),"keyup"===d?f.val(t).attr("data-prev",t):"layout"===b&&(f.find(".selected").removeClass("selected"),""!==t?f.find("#"+t).addClass("selected"):f.children().first().addClass("selected")));"keyup"===d&&this.setAttribute("data-prev",t)},{passive:!0})}};c.ActionBar={cid:null,topH:null,type:null,disable:null,prevExpand:null,needClear:!0,el:null,breadCrumbs:null,disablePosition:null,isInit:null,isHoverMode:!0,hoverCid:null,init:function(){if(null===
this.isInit){this.isInit=!0;this.el=p.createElement("div");this.breadCrumbs=p.createElement("ul");this.el.id="tb_component_bar";this.breadCrumbs.className="tb_action_breadcrumb";this.el.addEventListener("mousedown",this.mouseDown.bind(this));this.topH=c.toolbar.$el.height();"visual"===c.mode?p.body.appendChild(this.el):c.Instances.Builder[c.builderIndex].el.parentNode.appendChild(this.el);p.addEventListener("click",this.click.bind(this));p.addEventListener("dblclick",this.click.bind(this));c.Instances.Builder[0].el.addEventListener("mouseover",
this.enter);"visual"===c.mode&&r.document.addEventListener("click",this.click.bind(this));var a="visual"===c.mode?null:p.getElementById("tb_canvas_block");null===a?(p.addEventListener("keydown",this.actions.bind(this)),r.document.addEventListener("keydown",this.actions.bind(this))):a.addEventListener("keydown",this.actions.bind(this));this.changeMode()}},changeMode:function(){this.hoverCid=null;var a=this,b=function(b){a.actions(b)};!0===this.isHoverMode?(p.body.classList.remove("tb_click_mode"),
p.body.classList.add("tb_hover_mode"),this.el.removeEventListener("click",b)):(p.body.classList.remove("tb_hover_mode"),p.body.classList.add("tb_click_mode"),this.el.addEventListener("click",b))},enter:function(a){var b=c.ActionBar;c.Mixins.Builder.columnHover(a.target);if(!0===b.isHoverMode&&null===b.disablePosition&&null===b.disable){a.preventDefault();a.stopPropagation();var d=a.target,e=null,f=d.classList;if(null!==b.prevExpand&&b.prevExpand!==q)if(b.prevExpand.contains(d)){if(f.contains("tb_inner_action_more")){var h=
d.getElementsByTagName("UL");h.length&&c.Utils.addViewPortClass(h[0])}h=b.prevExpand.getElementsByClassName("tb_row_settings")[0];if(h!==q){var k=p.getElementById(h.getAttribute("data-href"));if(k.contains(d))return;k.classList.remove("selected");h.classList.remove("selected")}if("module"===b.type||"column"===b.type){"column"===b.type&&(b.hoverCid=d.parentNode.getAttribute("data-cid"));return}}else{h="module"!==b.type;if(!1===h)"visual"!==c.mode?(h=d.closest(".active_module"),h=null!==h?h.getAttribute("data-cid")!==
b.hoverCid:!0):(k=d.closest(".tb_dragger_top"),null!==k&&k.classList.contains("tb_dragger_padding")&&c.EdgeDrag.setModulePosition(k));else if(f.contains("tb_clicked"))return;!0===h&&b.clear()}if(null===d.closest(".tb_dragger_lightbox")){if(f.contains("tb_action_wrap"))e=!f.contains("tb_clicked");else{if("LI"===d.nodeName&&f.contains("tb_row_settings")&&!f.contains("selected")){b.actions(a);return}if(!f.contains("tb_grid_drag")){d=g(d).closest("[data-cid]")[0];if(d===q)return;f=d.getAttribute("data-cid");
if(b.hoverCid===f)return;b.hoverCid=f;h=c.Models.Registry.lookup(f);f=h.get("elType");if("module"===f){if(d.classList.contains("tb_element_selected"))return;e=!0}else if("visual"===c.mode){b.clear();c.EdgeDrag.addEdges(f,h,d);return}}}!0===e&&b.click(a)}}},mouseDown:function(a){if(1===a.which&&("row"===this.type||"subrow"===this.type)&&a.target.classList.contains("ti-move")){a.preventDefault();a.stopPropagation();var b=c.Instances.Builder[c.builderIndex].$el.find(".tb_element_cid_"+this.cid);if(0<
b.length){a="row"===this.type?b[0].getElementsByClassName("tb_row_action")[0]:b[0];var b=b.offset();this.clear();if("function"===typeof Event)var d=new Event("mousedown",{bubbles:!0,cancelable:!1});else d=p.createEvent("Event"),d.initEvent("mousedown",!0,!1);d.pageX=b.left;d.pageY=b.top;d.which=1;a.dispatchEvent(d)}}},click:function(a){if(c.isPreview||!0===this.disable)return!0;var b=a.target,d=b.tagName;var e=c.Instances.Builder[c.builderIndex].lastRow;var f="visual"===c.mode&&b.ownerDocument===
r.document?q:g(b).closest("[data-cid]")[0],h=a.type;if("click"===h){if(r.document.body.classList.contains("tb_standalone_lightbox")&&!r.document.body.classList.contains("modal-open")){c.toolbar.el.contains(b)||l.Lightbox.$lightbox[0].contains(b)||l.Lightbox.$lightbox[0].classList.contains("tb_predesigned_lightbox")||l.Lightbox.close();var k=r.document.getElementsByClassName("tb_current_menu_selected")[0];k!==q&&k.classList.remove("tb_current_menu_selected");k=null}e&&!e.contains(b)&&e.classList.remove("expanded");
if(!0===this.isHoverMode&&!l.Lightbox.$lightbox[0].contains(b)){e=c.Instances.Builder[0].el.getElementsByClassName("tb_element_clicked");for(k=e.length-1;-1<k;--k)e[k].classList.remove("tb_element_clicked");e=null;f!==q&&f.classList.add("tb_element_clicked")}}else if("dblclick"===h&&null!==c.Forms.LayoutPart.id&&b.classList.contains("tb_overlay")){c.Forms.LayoutPart.save(a,!0);return}k=("click"===h||"dblclick"===h)&&"visual"===c.mode&&l.Lightbox.dockMode.get();if(f===q||!("dblclick"===h||!0===k&&
b.classList.contains("tb_dragger"))&&b.classList.contains("tb_disable_sorting")||f.classList.contains("tb_active_layout_part"))"LI"===d&&b.classList.contains("tb_bread")?(e=c.Models.Registry.lookup(b.getAttribute("data-id")),"setting"!==ThemifyConstructor.clicked&&"module"===ThemifyConstructor.component&&(a=l.Lightbox.$lightbox[0].getElementsByClassName("tb_lightbox_top_bar")[0].querySelector(".current a").getAttribute("href"),l.Lightbox.$lightbox.off("themify_opened_lightbox.tb_breadCrumbs").on("themify_opened_lightbox.tb_breadCrumbs",
function(){"row"===ThemifyConstructor.component?l.Lightbox.$lightbox.off("themify_opened_lightbox.tb_breadCrumbs")[0].getElementsByClassName("tb_lightbox_top_bar")[0].querySelector('a[href="'+this+'"]').click():null===c.activeModel&&l.Lightbox.$lightbox.off("themify_opened_lightbox.tb_breadCrumbs")}.bind(a)),a=null),e.trigger("edit",null)):this.el.contains(b)||"click"===a.type&&b.classList.contains("tb_dragger")||this.clear();else{"visual"!==c.mode||"A"!==d&&null===b.closest("a")||a.preventDefault();
var n=f.getAttribute("data-cid");e=c.Models.Registry.lookup(n);var m=e.get("elType"),v="row"===m&&f.classList.contains("tb-page-break");if(e){if("dblclick"===h){if((!0===k||"INPUT"===d||!0===v||b.classList.contains("tb_dragger_lightbox")||null!==b.closest(".tb_clicked"))&&"tb_row_options"!==b.id)return;a.preventDefault();a.stopPropagation();f.classList.remove("tb_element_selected");!1===k&&!0!==this.isHoverMode&&(f.classList.add("tb_element_selected"),t.body[0].classList.add("tb_action_active"),"visual"===
c.mode&&c.EdgeDrag.addEdges("module"===m?e.get("mod_name"):m,e,f));if(!b.classList.contains("tb_row_settings")){e.trigger("edit",a,b);return}}else if("click"===h&&!1===k&&(b.classList.contains("tb_dragger")||null!==b.closest(".tb_dragger_options")))return;var u=!0===this.isHoverMode;var w=!0!==u&&null!==this.cid,d="module"!==m?b.classList.contains("tb_action_wrap"):!0===u;this.cid=n;this.type=m;if(!0===v&&"row"===m)this.clear(),b.classList.contains("tb_row_anchor")&&(a.preventDefault(),a.stopPropagation(),
e.trigger("delete",a,b));else if((!1===d||"module"===m&&!0===u)&&null!==b.closest(".tb_action_wrap"))"click"===h&&this.actions(a);else if(!0===u&&"click"===h&&!0===this.needClear)!0===k&&e.trigger("edit",a,b);else if(this.clear(),!0===w&&"click"===h&&!1===k&&!0===this.needClear){t.body[0].classList.add("tb_action_active");var z=this,x=function(){p.removeEventListener("mousemove",x,{passive:!0,once:!0});null===z.cid&&t.body[0].classList.remove("tb_action_active")};p.removeEventListener("mousemove",
x,{passive:!0,once:!0});p.addEventListener("mousemove",x,{passive:!0,once:!0})}else{this.cid=n;this.type=m;h="tmpl-builder_"+m+"_action";n=l.is_template_support?p.getElementById(h).content.cloneNode(!0):l.templateCache.get(h);if(!0===d){this.prevExpand="module"===m?f.getElementsByClassName("tb_module_action")[0]:b;if(this.prevExpand===q){this.clear();return}l.is_template_support?this.prevExpand.appendChild(n):this.prevExpand.insertAdjacentHTML("beforeend",n);this.prevExpand.setAttribute("id",this.el.id);
this.prevExpand.style.top="";this.prevExpand.closest(".tb_action_wrap").classList.add("tb_clicked");!0===u&&"module"===m&&"visual"===c.mode&&(c.EdgeDrag.addEdges(e.get("mod_name"),e,f),null===f.nextElementSibling&&(h=f.parentNode.nextElementSibling,null!==h&&(h=this.prevExpand.getBoundingClientRect().bottom-h.getBoundingClientRect().top,0<=h&&(this.prevExpand.style.top=this.prevExpand.offsetTop-h+"px"))))}else"row"!==m&&this.setBreadCrumbs(f),this.el.className="tb_show_toolbar tb_"+m+"_action",h=
p.createElement("div"),h.className="tb_action_label_wrap",l.is_template_support?h.appendChild(n):h.insertAdjacentHTML("beforeend",n),"visual"===c.mode&&("module"===m?(n=e.get("mod_name"),this.el.className+=" tb_"+n+"_action",n=themifyBuilder.modules[n].name):(n=m,"row"===m&&(v=e.get("styling").row_anchor,v!==q&&(v=v.trim(),""!==v&&(n+=" #"+v)))),v=p.createElement("div"),v.className="tb_data_mod_name",v.textContent=n.charAt(0).toUpperCase()+n.slice(1),h.appendChild(v)),this.el.appendChild(h);f.classList.add("tb_element_selected");
!0!==u&&(t.body[0].classList.add("tb_action_active"),"visual"===c.mode&&c.EdgeDrag.addEdges("module"===m?e.get("mod_name"):m,e,f));if(!0===k&&(e.trigger("edit",a,b),!0===u||null!==this.disablePosition&&!1!==d&&!0===u))return;null===this.disablePosition&&(!1===d&&!0!==u?(u=a.pageX,b=a.pageY,"visual"!==c.mode&&(b=c.Instances.Builder[0].el.getBoundingClientRect(),u=a.clientX-b.left,b=a.clientY-b.top+30),this.setPosition(this.el,{left:u,top:b})):c.Utils.addViewPortClass(this.prevExpand))}}else!0!==u&&
this.clear()}},setBreadCrumbs:function(a){for(;null!==this.breadCrumbs.firstChild;)this.breadCrumbs.removeChild(this.breadCrumbs.firstChild);this.breadCrumbs.appendChild(this.getBreadCrumbs(a));null===this.el.firstChild?this.el.appendChild(this.breadCrumbs):this.el.insertBefore(this.breadCrumbs,this.el.firstChild)},getBreadCrumbs:function(a){var b=[],d=p.createDocumentFragment();if(q===a)return d;for(;;){a=a.parentNode;var e=a.getAttribute("data-cid");e&&b.push(e);if(a.classList.contains("module_row"))break}for(a=
b.length-1;-1<a;--a){var e=p.createElement("li"),f=c.Models.Registry.lookup(b[a]),g=f.get("elType");e.textContent="column"===g?f.get("component_name"):g;e.className="tb_bread tb_bread_"+g;e.setAttribute("data-id",b[a]);d.appendChild(e)}return d},actions:function(a){var b=a.target;var d=b.tagName;if("keydown"===a.type){if("INPUT"!==d&&"TEXTAREA"!==d&&!themifyBuilder.disableShortcuts&&!l.Lightbox.$lightbox[0].contains(b)){var e=a.keyCode;d=!0===this.isHoverMode?"tb_element_clicked":"tb_element_selected";
var f=p.getElementsByClassName(d)[0];if(f!==q){a.preventDefault();a.stopPropagation();var h=d=null;if(46===e||8===e)d="delete","visual"!==c.mode&&themifyBuilder.is_gutenberg_editor&&(e=p.getElementById("tb_canvas_block"),null!==e&&e.closest(".wp-block").classList.contains("is-selected")&&(a.preventDefault(),a.stopPropagation()));else if(a.ctrlKey||a.metaKey)if(67===e)d="copy";else if(68===e)d="duplicate";else if(86===e)d="paste",a.shiftKey&&(h="style");else if(38===e||40===e){e=38===a.which?"up":
"down";var k="up"===e?f.previousElementSibling:f.nextElementSibling;if(null===k)return;if(f.classList.contains("module_row")){if(!k.classList.contains("module_row"))return;var n=c.Instances.Builder[c.builderIndex].$el}else if(f.classList.contains("active_module")){if(!k.classList.contains("active_module"))return;n=g(f.parentNode.closest(".tb_holder"))}else return;k&&(k=g(f),n.sortable("option","beforeStart")(null,null,{item:k}),n.sortable("option","start")(null,{item:k}),"up"===e?k.prev().before(k):
k.next().after(k),n.sortable("option","update")({type:"sortupdate"},{item:k}),n.sortable("option","stop")(null,{item:k,helper:null}),!0!==c.ActionBar.isHoverMode&&(c.ActionBar.clear(),f.classList.add("tb_element_selected")))}null!==d&&(a.preventDefault(),a.stopPropagation(),f=c.Models.Registry.lookup(g(f).closest("[data-cid]")[0].getAttribute("data-cid")),f.trigger(d,a,h),"delete"===d&&this.clear())}}if(b.classList.contains("tb_range"))return a.preventDefault(),a.stopPropagation(),!1}else if(a.preventDefault(),
a.stopPropagation(),null!==this.cid&&("LI"===d||"SPAN"===d||"A"===d)&&(n=(h=b.parentNode.classList.contains("tb_action_breadcrumb"))?b.getAttribute("data-id"):this.cid,e=null,f=c.Models.Registry.lookup(n),k=b.classList,f))if(t.body[0].classList.remove("tb_component_menu_active"),!0===h)this.needClear=null,this.disablePosition=!0,p.getElementsByClassName("tb_element_cid_"+n)[0].click(),this.disablePosition=null,"visual"===c.mode&&(b=this.el.getBoundingClientRect(),b.right>=p.body.clientWidth&&this.setPosition(this.el,
{left:b.left,top:this.el.offsetTop+55})),this.needClear=!0;else if(e=b.getAttribute("data-href"))for(a=b.parentNode.getElementsByTagName("li"),b=a.length-1;-1<b;--b)h=(d=a[b].getAttribute("data-href"))?p.getElementById(d):null,f=a[b].classList.contains("selected"),a[b].classList.remove("selected"),null!==h&&h.classList.remove("selected"),d!==e||f||("tb_row_options"===d||"tb_rgrids"===d?this.gridMenu(h):"tb_roptions"===d&&0===h.children.length&&this.setRowOptions(h),h.classList.add("selected"),a[b].classList.add("selected"),
c.Utils.addViewPortClass(h),t.body[0].classList.add("tb_component_menu_active"));else{if(k.contains("tb_edit")||k.contains("tb_styling")||k.contains("tb_visibility_component")||k.contains("tb_swap"))e="edit";else if(k.contains("tb_duplicate"))e="duplicate";else if(k.contains("tb_save_component"))e="save";else if(k.contains("tb_delete"))e="delete";else if(k.contains("ti-import")||k.contains("ti-export"))e="importExport";else if(k.contains("tb_copy_component"))e="copy";else if(k.contains("tb_paste_component")||
k.contains("tb_paste_style"))e="paste";else{if("LI"===d||"SPAN"===d||k.contains("tb_action_more")||k.contains("tb_inner_action_more")){a=b.closest("li");if(null===a)return;f=a.parentNode;e=f.classList;d=e.contains("tb_grid_list")||e.contains("tb_column_alignment")||e.contains("tb_column_gutter")||e.contains("tb_column_direction")||e.contains("tb_column_height")||e.contains("grid_tabs");h=b.classList.contains("selected");f=f.children;if(d&&h)return;for(b=f.length-1;-1<b;--b)if(f[b].classList.remove("selected"),
!1===d)for(n=f[b].getElementsByClassName("selected"),k=n.length-1;-1<k;--k)n[k].classList.remove("selected");h||(a.classList.add("selected"),t.body[0].classList.add("tb_component_menu_active"));if(d)e.contains("tb_column_alignment")?this._columnAlignmentClicked(a):e.contains("tb_column_gutter")?this._gutterChange(a):e.contains("tb_column_direction")?this._columnDirectionClicked(a):e.contains("tb_column_height")?this._columnHeight(a):e.contains("grid_tabs")?this._switchGridTabs(a):e.contains("tb_grid_list")&&
this._gridClicked(a);else{f=null!==this.prevExpand?this.prevExpand.children:this.el.getElementsByClassName("tb_action_label_wrap")[0].children;for(b=f.length-1;-1<b;--b)f[b].classList.remove("selected");h||null!==this.prevExpand&&"column"!==this.type||(f=a.getElementsByTagName("ul")[0],f!==q&&c.Utils.addViewPortClass(f))}}return}if(!0!==this.isHoverMode)this.clear();else{var m=b.closest(".tb_action_more");null!==m&&(m=m.getElementsByTagName("ul")[0],m.style.display="none",setTimeout(function(){null!==
m&&(m.style.display="")},100))}f.trigger(e,a,b)}},_switchGridTabs:function(a){c.ActionBar.disable=c.clearOnModeChange=!0;c.ActionBar.hoverCid=null;c.scrollTo=g(p.getElementsByClassName("tb_element_cid_"+this.cid)[0]);ThemifyConstructor.lightboxSwitch(a.getAttribute("data-id"))},_gridClicked:function(a){var b=g(a),d=b.data("grid"),e=this.type,f=g(".tb_element_cid_"+this.cid).first(),h=!1,k=c.activeBreakPoint,n="desktop"===k;a=l.clone(f.closest(".module_row"));h="subrow"===e;var m=f.find("."+e+"_inner").first();
if(n){e=m;var v=b.data("col");e=e.add(g("#tb_rgrids"));v===q&&(v=1,b.data("col",v));for(k=6;0<k;--k)e.removeClass("col-count-"+k);e.addClass("col-count-"+v);m.attr("data-basecol",v);n&&b.closest(".tb_grid_menu").find(".tb_grid_reposnive .tb_grid_list").each(function(){var a=g(this).find(".selected"),b=g(this).data("type"),d=a.data("col");d!==q&&(d>v||4===v&&3===d||4<=v&&4<=d&&v!=d)&&(a.removeClass("selected"),m.removeClass("tb_grid_classes col-count-"+m.attr("data-basecol")+" "+m.attr("data-col_"+
b)).attr("data-col_"+b,""),g(this).closest(".tb_grid_list").find("."+b+"-auto").addClass("selected"))})}else return"-auto"!==d[0]?(a="column"+d.join("-"),v=b.data("col"),3===v&&m.attr("data-basecol")>v&&(a+=" tb_3col"),m.removeClass(m.attr("data-col_tablet")+" "+m.attr("data-col_tablet_landscape")+" "+m.attr("data-col_mobile")).addClass(a+" tb_grid_classes col-count-"+m.attr("data-basecol")).attr("data-col_"+k,a)):m.removeClass("tb_grid_classes tb_3col col-count-"+m.attr("data-basecol")+" "+m.attr("data-col_"+
k)).attr("data-col_"+k,""),"visual"===c.mode&&g("body",r.document).height(p.body.scrollHeight),c.Utils.setCompactMode(m.children(".module_column")),!1;b=m.children(".module_column");n=d.length;e="module_column"+(h?" sub_column":"")+" col";for(k=0;k<n;++k)f=b.eq(k),0<f.length?f.removeClass(c.Utils.gridClass.join(" ")).addClass(e+d[k]):c.Utils._addNewColumn({newclass:e+d[k],component:h?"sub-column":"column"},m[0]);n<m.children().length&&m.children(".module_column").eq(n-1).nextAll().each(function(){g(this).find(".tb_holder").first().children().appendTo(g(this).prev().find(".tb_holder").first());
g(this).remove()});d=m.children();d.removeClass("first last");m.hasClass("direction-rtl")?(d.last().addClass("first"),d.first().addClass("last")):(d.first().addClass("first"),d.last().addClass("last"));c.Utils.columnDrag(m,!0);f=m.closest(".module_row");c.hasChanged=!0;c.Mixins.Builder.updateModuleSort(f);c.undoManager.push(f.data("cid"),a,f,"row");t.body.triggerHandler("tb_grid_changed",[f])},_columnHeight:function(a){a=g(a).data("value");if(a!==q){var b=g(".tb_element_cid_"+this.cid).first(),d=
c.Models.Registry.lookup(this.cid),e=l.clone(b),b=b.find("."+this.type+"_inner").first();""===a?b.removeClass("col_auto_height"):b.addClass("col_auto_height");d.set({column_h:a},{silent:!0});c.undoManager.push(this.cid,e,g(".tb_element_cid_"+this.cid).first(),"row")}},_columnAlignmentClicked:function(a){a=g(a);if(a=a.data("alignment")){var b=g(".tb_element_cid_"+this.cid).first(),d=c.Models.Registry.lookup(this.cid),e=l.clone(b);b.find("."+this.type+"_inner").first().removeClass(d.get("column_alignment")).addClass(a);
d.set({column_alignment:a},{silent:!0});c.undoManager.push(this.cid,e,g(".tb_element_cid_"+this.cid).first(),"row")}},_columnDirectionClicked:function(a){a=g(a);if(a=a.data("dir")){var b=g(".tb_element_cid_"+this.cid).first().find("."+this.type+"_inner").first(),d=b.children(".module_column"),e=d.first(),d=d.last(),f=c.Models.Registry.lookup(this.cid),h={};h[c.activeBreakPoint+"_dir"]=a;f.set(h,{silent:!0});"rtl"===a?(e.removeClass("first").addClass("last"),d.removeClass("last").addClass("first"),
b.addClass("direction-rtl")):(e.removeClass("last").addClass("first"),d.removeClass("first").addClass("last"),b.removeClass("direction-rtl"));b.attr("data-"+c.activeBreakPoint+"_dir",a)}},_gutterChange:function(a){if(a=g(a).data("value")){var b=g(".tb_element_cid_"+this.cid).first(),d=c.Models.Registry.lookup(this.cid),e=d.get("gutter"),f=l.clone(b),b=b.find("."+this.type+"_inner").first();c.Utils.columnDrag(b,!1,e,a);b.removeClass(e).addClass(a);d.set({gutter:a},{silent:!0});c.undoManager.push(this.cid,
f,g(".tb_element_cid_"+this.cid).first(),"row")}},gridMenu:function(a){for(var b=c.activeBreakPoint,d="desktop"===b,e=c.Models.Registry.lookup(this.cid),f=e.get(b+"_dir"),h=e.get("column_alignment"),k=e.get("column_h"),e=e.get("gutter"),l=p.getElementsByClassName("tb_element_cid_"+this.cid)[0].getElementsByClassName(this.type+"_inner")[0],m=!0===d?q:l.getAttribute("data-col_"+b),r=l.children,t=r.length,w=[],l=0;l<t;++l)w.push(c.Utils._getColClass(r[l].className.split(" ")));r="tb_rgrids"===a.id?a:
g(a).find("#tb_rgrids")[0];for(l=6;-1<l;--l)r.classList.remove("col-count-"+l);r.classList.add("col-count-"+t);w="grid-layout-"+w.join("-");a=a.getElementsByClassName("tb_grid_"+b)[0];r=a.getElementsByClassName("tb_grid_list")[0].getElementsByTagName("li");m="-auto"!==m&&m?"grid-layout-"+m.replace(/column|tb_3col/ig,"").trim():!1;!1!==d||!1!==m&&1!==t||(m=b+"-auto");for(l=r.length-1;-1<l;--l)!0===d&&r[l].classList.contains(w)||!1===d&&r[l].classList.contains(m)?r[l].classList.add("selected"):r[l].classList.remove("selected");
if("ltr"!==f)for(r=a.getElementsByClassName("tb_column_direction")[0].getElementsByTagName("li"),l=r.length-1;-1<l;--l)r[l].getAttribute("data-dir")===f?r[l].classList.add("selected"):r[l].classList.remove("selected");if(!0===d){if("col_align_top"!==h||!0===E)for(b=a.getElementsByClassName("tb_column_alignment")[0].getElementsByTagName("li"),l=b.length-1;-1<l;--l)b[l].getAttribute("data-alignment")===h?b[l].classList.add("selected"):b[l].classList.remove("selected");if("gutter-default"!==e)for(h=
a.getElementsByClassName("tb_column_gutter")[0].getElementsByTagName("li"),l=h.length-1;-1<l;--l)h[l].getAttribute("data-value")===e?h[l].classList.add("selected"):h[l].classList.remove("selected");if(k)for(h=a.getElementsByClassName("tb_column_height")[0].getElementsByTagName("li"),l=h.length-1;-1<l;--l)h[l].getAttribute("data-value")==k?h[l].classList.add("selected"):h[l].classList.remove("selected")}},setRowOptions:function(a){var b=null,d=c.activeModel,e=ThemifyConstructor.component,f=c.Models.Registry.lookup(this.cid),
g=f.get("styling");g||(g={});null!==d&&(b="module"===c.activeModel.get("elType")?"mod_settings":"styling",b=c.activeModel.get(b));if(a.children[0]!==q)for(;a.firstChild;)a.removeChild(a.firstChild);ThemifyConstructor.values=g;ThemifyConstructor.component=this.type;c.activeModel=f;a.appendChild(ThemifyConstructor.create(ThemifyConstructor.data.row.setting.options.slice(0,5)));ThemifyConstructor.values=b;c.activeModel=d;ThemifyConstructor.component=e},clear:function(){if(null!==this.type){this.cid=
this.type=null;for(this.el.classList.remove("tb_show_toolbar");this.el.firstChild;)this.el.removeChild(this.el.firstChild);if(null!==this.prevExpand&&this.prevExpand!==q){for(;null!==this.prevExpand.firstChild;)this.prevExpand.removeChild(this.prevExpand.firstChild);this.prevExpand.removeAttribute("id");this.prevExpand.closest(".tb_action_wrap").classList.remove("tb_clicked");this.prevExpand=null}this.clearSelected();t.body[0].classList.remove("tb_action_active");t.body[0].classList.remove("tb_component_menu_active")}},
clearSelected:function(){for(var a=c.Instances.Builder[0].el.getElementsByClassName("tb_element_selected"),b=a.length-1;-1<b;--b)a[b].classList.remove("tb_element_selected");"visual"===c.mode&&c.EdgeDrag.clearEdges()},setPosition:function(a,b){a.removeAttribute("data-top");var d=a.getBoundingClientRect();var e=d.width,f=d.height+40,h="visual"===c.mode?x.pageYOffset:c.toolbar.el.offsetTop+this.topH,k="visual"===c.mode?p.body:c.Instances.Builder[0].el,l=k.clientWidth;d=b.nodeType!==q?g(b).offset():
b;d.right=d.bottom="";d.left-=parseFloat(e/2);d.top-=f;d.left+e>l?(d.left="auto",d.right=10):0>d.left&&(d.left=30);d.top>k.clientHeight?"visual"!==c.mode&&(d.top="auto",d.bottom=50):h>d.top&&(a.dataset.top=!0,d.top+=2*f-25,"visual"!==c.mode&&(d.top-=f/2));for(var m in d)a.style[m]="auto"!==d[m]&&""!==d[m]?d[m]+"px":d[m]}};c.Forms.register_validator=function(a,b){this.Validators[a]=b};c.Forms.get_validator=function(a){return this.Validators[a]!==q?this.Validators[a]:this.Validators.not_empty};c.Forms.register_validator("email",
function(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;a=a.split(",");for(var d=a.length-1;-1<d;--d)if(!b.test(a[d]))return!1;return!0});c.Forms.register_validator("not_empty",function(a){return!(!a||""===a.trim())});c.GS={styles:{},allLoaded:!1,initContent:!1,loadingPosts:!1,el:null,dropdown:null,field:null,currentStyles:null,initVars:null,previousModel:null,init:function(){q===
themifyBuilder.globalStyleData?this.styles=this.extend(this.styles,themifyBuilder.globalStyles):(t.body[0].className+=" gs_post",c.toolbar.el.getElementsByClassName("tb_import_btn")[0].addEventListener("click",function(a){a.currentTarget.setAttribute("data-component","file");c.toolbar["import"](a)}),c.toolbar.el.getElementsByClassName("tb_export_link")[0].setAttribute("href",themifyBuilder.globalStyleData.exportURL),this.openStylingPanel())},extend:function(a,b){for(var d in b)b.hasOwnProperty(d)&&
(a[d]=b[d]);return a},findBySlug:function(a){for(var b=Object.keys(this.styles),d=0;d<b.length;d++)if(a===this.styles[b[d]]["class"])return this.styles[b[d]];return!1},isEmpty:function(a){return a===q||null===a||"object"===typeof a&&0===Object.keys(a).length||"string"===typeof a&&0===a.trim().length},openStylingPanel:function(){var a=themifyBuilder.globalStyleData.type;c.Models.Registry.lookup(c.Instances.Builder[c.builderIndex].el.getElementsByClassName(("row"===a||"column"===a?"module_":"module-")+
a)[0].dataset.cid).trigger("edit",null);c.toolbar.el.getElementsByClassName("tb_toolbar_builder_preview")[0].click()},attachCSS:function(a,b,d){if(d){this.init();d=Object.keys(this.styles);for(var c=d.length-1;-1<c;--c)b.push(d[c])}for(var f,c=b.length-1;-1<c;--c){if("undefined"===typeof this.styles[b[c]]||"undefined"===typeof this.styles[b[c]].data)return;this.isEmpty(this.styles[b[c]].css)&&(this.styles[b[c]].css=ThemifyStyles.createCss(this.styles[b[c]].data,null,!0,this.styles[b[c]]["class"]));
f=this.styles[b[c]].css;d=Object.keys(f);for(var g=d.length-1;-1<g;--g)a[d[g]]=a.hasOwnProperty(d[g])?a[d[g]]:{},a[d[g]]=this.extend(a[d[g]],f[d[g]])}return a},findUsedItems:function(a){a=JSON.stringify(a);for(var b=/"global_styles":"(.*?)"/mg,d,c="";null!==(d=b.exec(a));)c+=" "+d[1].trim();c=c.trim();if(""!==c){c=g.unique(c.split(" "));a=[];for(b=c.length-1;-1<b;--b)(d=this.findBySlug(c[b]))&&a.push(d.id);return a}return!1},globalStylesHTML:function(){if(q!==themifyBuilder.globalStyleData||!this.isEmpty(c.activeModel.attributes.gs))return!1;
var a=p.createElement("div");a.className="tb_gs_container";a.className+=this.isEmpty(ThemifyConstructor.getStyleVal("global_styles"))?"":" tb_gs_not_empty";var b=p.createElement("div");b.className="tb_gs_icon ti-brush-alt";b.tabIndex="-1";b.addEventListener("blur",function(a){c.GS.el.classList.add("tb_gs_dropdown_opened");setTimeout(function(){c.GS.el.querySelector('[data-action="insert"]')!==x.top.document.activeElement&&c.GS.el.classList.remove("tb_gs_dropdown_opened")},300)});var d=p.createElement("span");
d.className="tb_gs_tooltip";d.textContent=themifyBuilder.i18n.gs;b.appendChild(d);a.appendChild(b);a.addEventListener("mousedown",this.initClickEvent.bind(this));this.el=a;this.initContent=this.initVars=!1;a=null;return this.el},initHTML:function(){var a=ThemifyConstructor.getStyleVal("global_styles");var b=p.createDocumentFragment(),d=p.createElement("div");d.className="tb_gs_selected_styles";a=a===q?"":a.trim();if(""!==a){a=a.split(" ");for(var e=a.length-1;-1<e;--e){var f=this.findBySlug(a[e]);
f&&(f=this.createSelectedItem(f.id),b.appendChild(f),f=null);f=null}}d.appendChild(b);this.el.appendChild(d);a=a=b=d=null;b=l.is_template_support?p.getElementById("tmpl-global_styles").content.cloneNode(!0):l.templateCache.get("tmpl-global_styles");d=this.el.getElementsByClassName("tb_gs_icon")[0];l.is_template_support?d.appendChild(b):d.insertAdjacentHTML("afterbegin",b);b=null;b=this.el.querySelector('[data-action="insert"]');b.addEventListener("focus",function(){this.el.classList.add("tb_gs_dropdown_opened");
this.el.classList.add("tb_gs_searching")}.bind(this));b.addEventListener("blur",function(){setTimeout(function(){c.GS.el.querySelector("#global-style-search")!==x.top.document.activeElement&&(c.GS.el.classList.remove("tb_gs_dropdown_opened"),c.GS.el.classList.remove("tb_gs_searching"))},100)}.bind(this))},createSelectedItem:function(a){var b=this.styles[a],d=p.createElement("div");d.className="tb_selected_style";d.dataset.css=b["class"];d.dataset.id=a;a=p.createElement("span");a.className="tb_gs_edit ti-pencil";
d.appendChild(a);a=p.createElement("span");a.innerText=b.title;d.appendChild(a);b=p.createElement("span");b.className="tb_delete_gs ti-close";d.appendChild(b);return d},initCurrentStyles:function(){this.currentStyles=""!==this.field.value?this.field.value.split(" "):[];if(this.currentStyles.length)for(var a=this.currentStyles.length-1;-1<a;--a)this.findBySlug(this.currentStyles[a])||this["delete"](this.currentStyles[a])},saveAs:function(){var a=this;l.LiteLightbox.prompt(themifyBuilder.i18n.enterGlobalStyleName,
function(b){if(null!==b){if(""===b)return alert(themifyBuilder.i18n.enterGlobalStyleName),a.saveAs(),!1;a.saveAsCallback(b)}})},saveAsCallback:function(a){ThemifyConstructor.setStylingValues(c.activeBreakPoint);var b=c.activeModel.get("elType"),d=c.Utils.clear(ThemifyConstructor.values),b="module"===b?c.activeModel.get("mod_name"):b;d.global_styles="";var e=this;g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_save_as_new_global_style",tb_load_nonce:themifyBuilder.tb_load_nonce,
type:b,styles:d,title:a},beforeSend:function(){l.showLoader("show")},error:function(){l.showLoader("error")},success:function(a){l.showLoader("hide");"success"===a.status&&(e.styles[a.post_data.id]=a.post_data,e.addItemToDropdown(a.post_data.id));var b=a.post_data.data,b=c.Utils.clear(b),b=ThemifyStyles.createCss(b,null,!0);g.ajax({type:"POST",url:themifyBuilder.ajaxurl,cache:!1,data:{css:JSON.stringify(b),action:"tb_save_css",tb_load_nonce:themifyBuilder.tb_load_nonce,id:a.post_data.id}});b=null;
l.LiteLightbox.confirm(themifyBuilder.i18n.addSavedGS,function(b){"yes"===b&&(l.Lightbox.$lightbox[0].getElementsByClassName("reset-styling")[0].click(),e.insert(a.post_data.id))},{buttons:{no:{label:ThemifyConstructor.label.no},yes:{label:ThemifyConstructor.label.y}}})}})},"delete":function(a,b){var d=this.el.querySelector('.global_style_item[data-class="'+a+'"]');null!==d&&d.classList.remove("selected");d=this.field.value.trim();d=d.split(" ");d.splice(d.indexOf(a),1);this.currentStyles=d;this.currentStyles.length||
(this.el.classList.remove("tb_gs_not_empty"),0<ThemifyBuilderCommon.Lightbox.$lightbox[0].getElementsByClassName("tb_gs_options_overlay").length&&ThemifyBuilderCommon.Lightbox.$lightbox[0].getElementsByClassName("tb_gs_options_overlay")[0].click());b!==q&&this.updated();this.field.value=d.join(" ");"visual"===c.mode&&(t.triggerEvent(this.field,"keyup"),ThemifyConstructor.styles.global_styles=d.join(" "));return!0},insert:function(a){"visual"===c.mode&&!0!==this.styles[a].cssLoaded&&(c.liveStylingInstance.setCss(this.styles[a].data,
q,this.styles[a]["class"]),this.styles[a].cssLoaded=!0);this.insertCallback(a)},insertCallback:function(a){null!==this.dropdown&&this.dropdown.querySelector('.global_style_item[data-class="'+this.styles[a]["class"]+'"]').classList.add("selected");var b=this.createSelectedItem(a);this.el.getElementsByClassName("tb_gs_selected_styles")[0].appendChild(b);b=this.field.value;b=b+" "+this.styles[a]["class"];this.field.value=b.trim();this.currentStyles=this.field.value.split(" ");this.currentStyles.length&&
this.el.classList.add("tb_gs_not_empty");this.updated();"visual"===c.mode&&(t.triggerEvent(this.field,"keyup"),ThemifyConstructor.styles.global_styles=b.trim())},search:function(){var a=this.el.querySelector("#global-style-search");a.addEventListener("input",function(a){a=a.target.value.toUpperCase();for(var b=l.Lightbox.$lightbox.find(".tb_gs_list")[0].getElementsByClassName("global_style_item"),c=0;c<b.length;c++){var f=b[c].getElementsByClassName("global_style_title")[0];f&&(-1<f.innerHTML.toUpperCase().indexOf(a)?
b[c].style.display="":b[c].style.display="none")}});a.addEventListener("focus",function(){this.el.classList.add("tb_gs_dropdown_opened");this.el.classList.add("tb_gs_searching")}.bind(this));a.addEventListener("blur",function(){this.el.classList.remove("tb_gs_dropdown_opened");this.el.classList.remove("tb_gs_searching")}.bind(this))},addItemToDropdown:function(a){if(null!=this.dropdown){var b=this.styles[a],d=p.createElement("div");d.className="global_style_item";d.className+=-1!==this.currentStyles.indexOf(b["class"])?
" selected":"";d.dataset["class"]=b["class"];d.dataset.styleId=a;a=p.createElement("span");a.className="global_style_title";a.innerText=b.title;d.appendChild(a);a=p.createElement("span");a.className="global_style_type";a.innerText=b.type;d.appendChild(a);this.dropdown.insertBefore(d,this.dropdown.firstChild)}},loadMore:function(a){for(var b=[],d=this,c=Object.keys(this.styles),f=c.length-1;-1<f;--f)b.push(c[f]),a&&this.addItemToDropdown(c[f]);g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",
data:{action:"tb_get_gs_posts",tb_load_nonce:themifyBuilder.tb_load_nonce,loaded:b},success:function(a){d.styles=d.extend(d.styles,a);a=Object.keys(a);10>a.length&&(d.allLoaded=!0);for(var b=a.length-1;-1<b;--b)d.addItemToDropdown(a[b]);0===d.dropdown.querySelectorAll(".global_style_item:not(.selected)").length&&(d.dropdown.getElementsByClassName("tb_no_gs_item")[0].style.display="block");d.loadingPosts=!1}})},initDropdown:function(){this.dropdown=this.el.getElementsByClassName("tb_gs_list")[0];this.search();
if(10<Object.keys(this.styles).length||this.allLoaded){for(var a=Object.keys(this.styles),b=a.length-1;-1<b;--b)this.addItemToDropdown(a[b]);0===this.dropdown.querySelectorAll(".global_style_item:not(.selected)").length&&(this.dropdown.getElementsByClassName("tb_no_gs_item")[0].style.display="block")}else this.loadMore(!0);var a=new SimpleBar(this.dropdown),b=this.dropdown.getElementsByClassName("simplebar-content"),d=this.dropdown;b.length&&(this.dropdown=b[0],d=a.getScrollElement());d.addEventListener("scroll",
this.scrollLoadMore.bind(this))},initClickEvent:function(a){!0!==this.initVars&&(this.field=l.Lightbox.$lightbox[0].querySelector("#global_styles"),this.initCurrentStyles(),this.initVars=!0);this.initContent||(this.initHTML(),this.initContent=!0);var b=a.target,d=b.classList;if("insert"===b.dataset.action){if("LABEL"===b.nodeName||d.contains("tb_open_gs"))return!0;a.preventDefault();a.stopImmediatePropagation();"insert"===b.dataset.action&&(b.focus(),b.dataset.init===q?(this.initDropdown(),b.dataset.init=
!0):(a=this.dropdown.getElementsByClassName("tb_no_gs_item")[0],0===this.dropdown.querySelectorAll(".global_style_item:not(.selected)").length?a.style.display="block":a.style.display="none"))}else d.contains("global_style_title")?(a.preventDefault(),this.el.classList.remove("tb_gs_dropdown_opened"),g(b).parents(".tb_gs_icon").focus(),this.insert(b.parentElement.dataset.styleId),0===this.dropdown.querySelectorAll(".global_style_item:not(.selected)").length&&(this.dropdown.getElementsByClassName("tb_no_gs_item")[0].style.display=
"block")):d.contains("tb_delete_gs")?(a.preventDefault(),a.stopImmediatePropagation(),this["delete"](b.parentElement.getAttribute("data-css"),b.parentElement.getAttribute("data-id"))&&(b.parentElement.outerHTML=""),g(c.GS.el.querySelector(".tb_gs_icon")).focus()):"save"===b.dataset.action?(a.preventDefault(),a.stopImmediatePropagation(),this.saveAs()):d.contains("tb_gs_edit")&&this.liveEdit(b.parentNode.dataset.id)},scrollLoadMore:function(a){this.allLoaded||(a=a.target,a=Math.max(a.scrollHeight-
(a.scrollTop+a.offsetHeight),0),!this.loadingPosts&&0<a&&100>=a&&(this.loadingPosts=!0,this.loadMore()))},extraClass:function(){var a=!1,b=!1,d=this;this.currentStyles.some(function(c){if(b&&a)return!0;if(c=d.findBySlug(c))c="row"===d.styles[c.id].type?d.styles[c.id].data[0].styling.background_repeat:d.styles[c.id].data[0].cols[0].styling.background_repeat,"builder-parallax-scrolling"!==c||a||(a=!0),"builder-zoom-scrolling"!==c||b||(b=!0)});var e=p.querySelector('[data-cid="'+c.activeModel.cid+'"]');
a?e.classList.add("builder-parallax-scrolling"):"builder-parallax-scrolling"!==ThemifyConstructor.values.background_repeat&&e.classList.remove("builder-parallax-scrolling");b?e.classList.add("builder-zoom-scrolling"):"builder-zoom-scrolling"!==ThemifyConstructor.values.background_repeat&&e.classList.remove("builder-zoom-scrolling");d=null},updated:function(){if("visual"!==c.mode)return!1;var a=c.activeModel.get("elType"),a="subrow"===a?"row":a;if("row"===a||"column"===a)this.extraClass(),this.addOverlay(),
"row"===a&&this.addFrame()},addOverlay:function(){var a=c.activeModel.get("elType"),a="subrow"===a?"row":a;if(!c.liveStylingInstance.getComponentBgOverlay().length){var b=!1,d=this,e,f;this.currentStyles.some(function(c){if(b)return!0;if(c=d.findBySlug(c))c="row"===a?c.data[0].styling:c.data[0].cols[0].styling,f=q!==c["cover_color-type"]||"color"===c["cover_color-type"]?"color":"gradient",e="color"===f?c.cover_color:c["cover_gradient-gradient"],d.isEmpty(e)&&(f=q!==c.cover_color_hover||"hover_color"===
c["cover_color_hover-type"]?"color":"gradient",e="color"===f?c.cover_color_hover:c["cover_gradient_hover-gradient"]),d.isEmpty(e)||(b=!0)});b&&c.liveStylingInstance.addOrRemoveComponentOverlay(f,"cover_color",e)}},addFrame:function(){!0!==this.initVars&&(this.field=l.Lightbox.$lightbox[0].querySelector("#global_styles"),this.initCurrentStyles(),this.initVars=!0);for(var a=["top","bottom","left","right"],b=[],d=this,e=a.length-1;-1<e;--e){var f=c.liveStylingInstance.$liveStyledElmt.children(".tb_row_frame_"+
a[e]);f.length&&a.splice(e,1);f=null}if(0===a.length)return!0;var g={};this.currentStyles.some(function(c){if(c=d.findBySlug(c))g=c.data[0].styling,a.some(function(a){if(-1===b.indexOf(a)){var c=a+"-frame_type",d=a+"-frame_layout",e=a+"-frame_custom";q!==g[c]&&(g[c]===a+"-presets"&&q!==g[d]&&""!==g[d]||g[c]===a+"-custom"&&q!==g[e]&&""!==g[e])&&b.push(a)}})});for(e=b.length-1;-1<e;--e)c.liveStylingInstance.addOrRemoveFrame(b[e],g[b[e]+"-frame_location"])},liveEdit:function(a){var b=this.styles[a];
a={gs:a};this.previousModel=c.activeModel.cid;"row"===b.type?(a=this.extend(a,b.data[0]),b=tb_app.Views.init_row(a)):"column"===b.type?(a=this.extend(a,b.data[0].cols[0]),b=tb_app.Views.init_column(a)):(a=this.extend(a,b.data[0].cols[0].modules[0]),b=tb_app.Views.init_module(a));b.model.trigger("edit",null)},modulePanel:function(a){a?l.Lightbox.$lightbox[0].className+=" gs_post":l.Lightbox.$lightbox[0].classList.remove("gs_post")},saveLiveEdit:function(a){c.saving=!0;var b=this.styles[c.activeModel.attributes.gs];
b.css=null;delete ThemifyConstructor.values.cid;ThemifyConstructor.setStylingValues(c.activeBreakPoint);var d=c.Utils.clear(ThemifyConstructor.values);"row"===b.type?b.data[0].styling=d:"column"===b.type?b.data[0].cols[0].styling=d:b.data[0].cols[0].modules[0].mod_settings=d;g("."+b["class"]).removeClass("tb_visual_hover");var e=this;g.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_update_global_style",tb_load_nonce:themifyBuilder.tb_load_nonce,data:b.data,id:b.id},
beforeSend:function(){l.showLoader("show")},error:function(){l.showLoader("error");l.Lightbox.close()},success:function(){e.styles[b.id].data=b.data;l.Lightbox.close();e.reopenPreviousPanel(a);l.showLoader("hide");c.saving=!1}})},reopenPreviousPanel:function(a){q!==a?a.model.trigger("edit",a.e,a.target):null!==this.previousModel&&l.Lightbox.$lightbox[0].classList.contains("gs_post")&&(this.modulePanel(!1),c.Models.Registry.lookup(this.previousModel).trigger("edit",null),this.previousModel=null)},
stylingOverlay:function(){var a=p.createElement("div");a.className="tb_gs_options_overlay";var b=p.createElement("p");b.textContent=themifyBuilder.i18n.has_gs;a.appendChild(b);a.addEventListener("click",function(){this.parentNode.removeChild(this)},{once:!0});return a}}})(jQuery,Backbone,Themify,window,window.top,document,ThemifyBuilderCommon,void 0);
