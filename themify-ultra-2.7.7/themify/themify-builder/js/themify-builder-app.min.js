var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(h,z,v){h instanceof String&&(h=String(h));for(var x=h.length,u=0;u<x;u++){var r=h[u];if(z.call(v,r,u,h))return{i:u,v:r}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(h,z,v){h!=Array.prototype&&h!=Object.prototype&&(h[z]=v.value)};$jscomp.getGlobal=function(h){return"undefined"!=typeof window&&window===h?h:"undefined"!=typeof global&&null!=global?global:h};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(h,z,v,x){if(z){v=$jscomp.global;h=h.split(".");for(x=0;x<h.length-1;x++){var u=h[x];u in v||(v[u]={});v=v[u]}h=h[h.length-1];x=v[h];z=z(x);z!=x&&null!=z&&$jscomp.defineProperty(v,h,{configurable:!0,writable:!0,value:z})}};$jscomp.polyfill("Array.prototype.find",function(h){return h?h:function(h,v){return $jscomp.findInternal(this,h,v).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(h){return $jscomp.SYMBOL_PREFIX+(h||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var h=$jscomp.global.Symbol.iterator;h||(h=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[h]&&$jscomp.defineProperty(Array.prototype,h,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(h){var z=0;return $jscomp.iteratorPrototype(function(){return z<h.length?{done:!1,value:h[z++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(h){$jscomp.initSymbolIterator();h={next:h};h[$jscomp.global.Symbol.iterator]=function(){return this};return h};$jscomp.iteratorFromArray=function(h,z){$jscomp.initSymbolIterator();h instanceof String&&(h+="");var v=0,x={next:function(){if(v<h.length){var u=v++;return{value:z(u,h[u]),done:!1}}x.next=function(){return{done:!0,value:void 0}};return x.next()}};x[Symbol.iterator]=function(){return x};return x};
$jscomp.polyfill("Array.prototype.keys",function(h){return h?h:function(){return $jscomp.iteratorFromArray(this,function(h){return h})}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.values",function(h){return h?h:function(){return $jscomp.iteratorFromArray(this,function(h,v){return v})}},"es6","es3");var tb_app;
(function(h,z,v,x,u,r,n,t){"function"===typeof u.document.ondragstart&&(u.document.ondragstart=x.document.ondragstart=null);var K=h.ui.sortable.prototype._mouseStart,F=r.body.classList.contains("full-section-scrolling");h.ui.sortable.prototype._mouseStart=function(a,d,c){if("mousedown"===a.type&&1===a.which){var e=a.target.classList;if(e.contains("tb_subrow_holder")||e.contains("tb_grid_drag")||e.contains("tb_column_action")&&a.target.parentNode.classList.contains("sub_column")||("row"===b.ActionBar.type||
"subrow"===b.ActionBar.type)&&!e.contains("ti-move")&&null!==a.target.parentNode.closest(".tb_clicked"))return a.stopImmediatePropagation(),a.preventDefault(),!1;this._trigger("beforeStart",a,[this,this._uiHash()])}K.apply(this,[a,d,c])};Element.prototype.closest||(Element.prototype.closest=function(a){var b=null,c=null,e=null,f=this;0===a.indexOf(".")?(b=!0,a=a.replace(".","")):0===a.indexOf("#")?(c=!0,a=a.replace("#","")):e=!0;for(;;){var g=f;g=!0===b&&g.classList.contains(a)||!0===c&&g.id===a||
!0===e&&g.nodeName.toLowerCase()===a?g:null;if(null!==g)return g;f=f.parentElement;if(!f)return null}});String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(a,b){var c=this.toString(),d=c.length;if(b===t||b>d)b=d;b-=d;c=c.indexOf(a,b);return-1!==c&&c===b}});t===h.fn.themifySerializeObject&&(h.fn.themifySerializeObject=function(){for(var a={},b=this.length-1;-1<b;--b){var c=this[b].type;if(this[b].classList.contains("wp-editor-area")&&tinyMCE!==t){var e=tinyMCE.get(this[b].id);
e&&(this[b].value=e.getContent())}if(""!==this[b].value&&("text"===c||"number"===c||"radio"===c||"checkbox"===c||"textarea"===c||"select-one"===c||"hidden"===c||"email"===c||"select"===c||"select-multiple"===c)&&(this[b].name||this[b].id)){var e=this[b].name?this[b].name:this[b].id,f=this[b].value;"radio"===c||"checkbox"===c?f=this[b].checked&&f:"select-multiple"===c&&(f=h(this[b]).val());a[e]!==t&&"radio"!==c?(!a[e].push&&(a[e]=[a[e]]),f&&a[e].push(f)):f&&(a[e]=f)}}return a});var b=tb_app={activeModel:null,
Models:{},Collections:{},Mixins:{},Views:{Modules:{},Rows:{},SubRows:{},Columns:{}},Forms:{},Constructor:{},Utils:{},Instances:{Builder:{}}},C={},A=null;b.builderIndex=0;b.mode="default";b.autoSaveCid=null;b.hasChanged=null;b.editing=!1;b.scrollTo=!1;b.eventName=!1;b.beforeEvent=!1;b.saving=!1;b.activeBreakPoint="desktop";b.zoomMeta={isActive:!1,size:100};b.isPreview=!1;b.clearOnModeChange=null;b.Models.Module=z.Model.extend({defaults:{element_id:null,elType:"module",mod_name:"",mod_settings:{}},
initialize:function(){b.Models.Registry.register(this.cid,this);var a=this.get("element_id");a&&1!==C[a]||(a=b.Utils.generateUniqueID(),this.set({element_id:a},{silent:!0}));C[a]=1},toRenderData:function(){return{slug:this.get("mod_name"),name:themifyBuilder.modules[this.get("mod_name")].name,excerpt:this.getExcerpt()}},getExcerpt:function(a){a=a||this.get("mod_settings");return this.limitString(a.content_text||a.content_box||a.plain_text||"",100)},limitString:function(a,b){var c="";""!==a&&(a=this.stripHtml(a).toString(),
c=a.length>b?a.substr(0,b):a);return c},stripHtml:function(a){var b=r.createElement("div");b.innerHTML=a;return b.textContent||b.innerText||""},setData:function(a){b.Utils.clearElementId([a]);a=b.Views.init_module(a);a.model.trigger("custom:change",a)},backendLivePreview:function(){h(".tb_element_cid_"+this.cid).find(".module_excerpt").text(this.getExcerpt())},getPreviewSettings:function(){return _.extend({cid:this.cid},themifyBuilder.modules[this.get("mod_name")].defaults)},getIDattr:function(){return this.get("element_id")?
this.get("element_id"):b.Utils.generateUniqueID()}});b.Models.SubRow=z.Model.extend({defaults:{element_id:null,elType:"subrow",gutter:"gutter-default",column_alignment:F?"col_align_middle":"col_align_top",column_h:"",desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_mobile:"-auto",col_tablet_landscape:"-auto",col_tablet:"-auto",cols:{},styling:{}},initialize:function(){b.Models.Registry.register(this.cid,this);var a=this.get("element_id");a&&1!==C[a]||(a=b.Utils.generateUniqueID(),
this.set({element_id:a},{silent:!0}));C[a]=1},setData:function(a){b.Utils.clearElementId([a]);a=b.Views.init_subrow(a);a.model.trigger("custom:change",a)}});b.Models.Column=z.Model.extend({defaults:{element_id:null,elType:"column",grid_class:"",component_name:"column",modules:{},styling:{}},initialize:function(){b.Models.Registry.register(this.cid,this);var a=this.get("element_id");a&&1!==C[a]||(a=b.Utils.generateUniqueID(),this.set({element_id:a},{silent:!0}));C[a]=1},setData:function(a){b.Utils.clearElementId([a]);
a=b.Views.init_column(a);a.model.trigger("custom:change",a)}});b.Models.Row=z.Model.extend({defaults:{element_id:null,elType:"row",gutter:"gutter-default",column_alignment:F?"col_align_middle":"col_align_top",column_h:"",desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_mobile:"-auto",col_tablet_landscape:"-auto",col_tablet:"-auto",cols:{},styling:{}},initialize:function(){b.Models.Registry.register(this.cid,this);var a=this.get("element_id");a&&1!==C[a]||(a=b.Utils.generateUniqueID(),
this.set({element_id:a},{silent:!0}));C[a]=1},setData:function(a){b.Utils.clearElementId([a]);a=b.Views.init_row(a);a.model.trigger("custom:change",a)}});b.Collections.Rows=z.Collection.extend({model:b.Models.Row});b.Models.Registry={items:{},register:function(a,b){this.items[a]=b},lookup:function(a){return this.items[a]||null},remove:function(a){this.items[a]=null;delete this.items[a]},destroy:function(){for(var a in this.items)this.items[a].destroy();this.items={}}};b.Models.setValue=function(a,
d,c){c=c||!1;b.Models.Registry.lookup(a).set(d,{silent:c})};b.vent=_.extend({},z.Events);b.Views.register_module=function(a){"default"!==b.mode&&(this.Modules[b.mode]=this.Modules["default"].extend(a))};b.Views.init_module=function(a,d){if(themifyBuilder.modules[a.mod_name]===t)return!1;!0===d&&a.mod_settings===t&&themifyBuilder.modules[a.mod_name].defaults!==t&&(a.mod_settings=_.extend({},themifyBuilder.modules[a.mod_name].defaults));var c=a instanceof b.Models.Module?a:new b.Models.Module(a),e=
new (this.get_module())({model:c,type:b.mode});return{model:c,view:e}};b.Views.get_module=function(){return this.Modules[b.mode]};b.Views.unregister_module=function(){"default"!==b.mode&&(this.Modules[b.mode]=null,delete this.Modules[b.mode])};b.Views.module_exists=function(){return this.Modules.hasOwnProperty(b.mode)};b.Views.register_column=function(a){"default"!==b.mode&&(this.Columns[b.mode]=this.Columns["default"].extend(a))};b.Views.init_column=function(a){a=a instanceof b.Models.Column?a:new b.Models.Column(a);
var d=new (this.get_column())({model:a,type:b.mode});return{model:a,view:d}};b.Views.get_column=function(){return this.Columns[b.mode]};b.Views.unregister_column=function(){"default"!==b.mode&&(this.Columns[b.mode]=null,delete this.Columns[b.mode])};b.Views.column_exists=function(){return this.Columns.hasOwnProperty(b.mode)};b.Views.register_subrow=function(a){"default"!==b.mode&&(this.SubRows[b.mode]=this.SubRows["default"].extend(a))};b.Views.init_subrow=function(a){a=a instanceof b.Models.SubRow?
a:new b.Models.SubRow(a);var d=new (this.get_subrow())({model:a,type:b.mode});return{model:a,view:d}};b.Views.get_subrow=function(){return this.SubRows[b.mode]};b.Views.unregister_subrow=function(){"default"!==b.mode&&(this.SubRows[b.mode]=null,delete this.SubRows[b.mode])};b.Views.subrow_exists=function(){return this.SubRows.hasOwnProperty(b.mode)};b.Views.register_row=function(a){"default"!==b.mode&&(this.Rows[b.mode]=this.Rows["default"].extend(a))};b.Views.init_row=function(a){var d=a.attributes;
return d===t||d.cols!==t&&(0<Object.keys(d.cols).length||0<d.cols.length)||d.styling!==t&&0<Object.keys(d.styling).length?(a=a instanceof b.Models.Row?a:new b.Models.Row(a),d=new (this.get_row())({model:a,type:b.mode}),{model:a,view:d}):!1};b.Views.get_row=function(){return this.Rows[b.mode]};b.Views.unregister_row=function(){"default"!==b.mode&&(this.Rows[b.mode]=null,delete this.Rows[b.mode])};b.Views.row_exists=function(){return this.Rows.hasOwnProperty(b.mode)};b.Views.BaseElement=z.View.extend({type:"default",
initialize:function(){this.listenTo(this.model,"custom:change",this.modelChange);this.listenTo(this.model,"destroy",this.remove);this.listenTo(this.model,"edit",this.edit);this.listenTo(this.model,"duplicate",this.duplicate);this.listenTo(this.model,"save",this.save);this.listenTo(this.model,"importExport",this.importExport);this.listenTo(this.model,"delete",this["delete"]);this.listenTo(this.model,"copy",this.copy);this.listenTo(this.model,"visibility",this.visibility);this.listenTo(this.model,"paste",
this.paste);this.listenTo(this.model,"change:view",this.setView)},setView:function(a){this.setElement(a)},modelChange:function(){this.$el.attr(_.extend({},_.result(this,"attributes")));var a=this.render(),d=b.beforeEvent.data("cid"),c=r.getElementsByClassName("tb_element_cid_"+d)[0];c.parentNode.replaceChild(a.el,c);"visual"===b.mode?this.model.trigger("visual:change"):("row"===b.eventName&&(d=this.$el.data("cid")),b.undoManager.push(d,b.beforeEvent,this.$el,b.eventName),b.Mixins.Builder.update(this.$el))},
remove:function(){this.$el.remove()},visibility:function(a,b){var c="module"===this.model.get("elType")?"mod_settings":"styling",d=this.model.get(c),f=b.name;!0===b.checked?delete d[f]:d[f]=b.value;f={};f[c]=d;this.model.set(f,{silent:!0})},copy:function(a,d){var c=this.$el,e=this.model,f=e.get("elType");"column"===f&&(f=e.get("component_name"));null!==b.activeModel&&ThemifyConstructor.saveComponent();c=this.getData(c,f);Object.keys(b.GS.styles).length&&(e=b.GS.findUsedItems(c),!1!==e&&e.length&&
(c.attached_gs=e));b.Utils.clearElementId([c]);"sub-column"===f&&(f="column");n.Clipboard.set(f,c)},paste:function(a,d,c){a=this.$el;var e=this.model,f=e.get("elType"),g=null;"column"===f?f=e.get("component_name"):"module"===f&&(g=e.get("mod_name"));"sub-column"===f&&(f="column");var k="style"===d||null!==d&&d!==t&&d.classList.contains("tb_paste_style");d=n.Clipboard.get(f);!1===k&&!1===d&&"column"===f&&(d=n.Clipboard.get("module"),f="module",g=d.mod_name);if(!1===d||!0===k&&"module"===f&&g!==d.mod_name)!0!==
c&&n.alertWrongPaste();else{b.eventName="row";if(!0===k){var h=ThemifyStyles.getStyleOptions("module"===f?g:f);c="module"===f?"mod_settings":"styling";var m=this.getData(a,"column"===f?e.get("component_name"):f),q=function(a){if(-1!==a.indexOf("breakpoint_")||-1!==a.indexOf("_apply_all"))return!0;var b=-1!==a.indexOf("_color")?"color":-1!==a.indexOf("_style")?"style":!1;if(!1!==b){if(b=a.replace("_"+b,"_width"),h[b]!==t&&"border"===h[b].type)return!0}else if(-1!==a.indexOf("_unit")){if(b=a.replace(/_unit$/ig,
"",""),h[b]!==t)return!0}else if(-1!==a.indexOf("_w")){if(b=a.replace(/_w$/ig,"",""),h[b]!==t&&"font_select"===h[b].type)return!0}else if(h[a]!==t&&"radio"===h[a].type)return!0;return!1};m[c]===t&&(m[c]={});for(var p in d[c])h[p]!==t||q(p)?(m[c][p]=d[c][p],h[p]!==t&&(!0===h[p].isFontColor&&d[c][h[p].g+"-gradient"]!==t?m[c][h[p].g+"-gradient"]=d[c][h[p].g+"-gradient"]:(h[p].posId!==t&&d[c][h[p].posId]!==t&&(m[c][h[p].posId]=d[c][h[p].posId]),h[p].repeatId!==t&&d[c][h[p].repeatId]!==t&&(m[c][h[p].repeatId]=
d[c][h[p].repeatId])))):delete d[c][p];d.used_gs!==t&&(m.used_gs=d.used_gs);h=null;d=m;delete d.element_id}"column"===f&&(d.grid_class=b.Utils.filterClass(a.prop("class")),a.hasClass("first")?d.grid_class+=" first":a.hasClass("last")&&(d.grid_class+=" last"),p=a[0].style.width,d.grid_width=p?p.replace("%",""):null,d.component_name=e.get("component_name"));!1===k&&b.Utils.clearElementId([d]);b.hasChanged=!0;!1===k&&"module"===f&&"column"===e.get("elType")&&(e=b.Views.init_module({mod_name:g},!0),f=
e.view.render().$el,a[0].getElementsByClassName("tb_holder")[0].appendChild(f[0]),e=e.model,a=f,f=null);b.beforeEvent=n.clone(a);e.setData(d);null!==b.activeModel&&n.Lightbox.close()}},importExport:function(a,d){var c=d.classList.contains("ti-import")?"import":"export",e=this,f=this.$el,g=this.model,k=g.get("elType"),k="column"===k?g.get("component_name"):k,l=k.charAt(0).toUpperCase()+k.slice(1),m="subrow"===k?"Sub-Row":"sub-column"===k?"Sub-Column":l,l={contructor:!0,loadMethod:"html",data:{component_form:{name:ThemifyConstructor.label[c+
"_tab"].replace("%s",l),options:[{id:"tb_data_field",type:"textarea",label:ThemifyConstructor.label.import_label.replace("%s",m),help:ThemifyConstructor.label[c+"_data"].replace("%s",l),"class":"fullwidth",rows:13}]}}};"import"===c&&(l.save={});n.Lightbox.$lightbox[0].style.display="none";n.Lightbox.open(l,function(){u.document.body.classList.add("tb_standalone_lightbox")},function(){var d=this.$lightbox;d.addClass("tb_import_export_lightbox");this.setStandAlone(a.clientX,a.clientY);if("import"===
c)d.find(".builder_save_button").on("click.tb_import",function(a){a.preventDefault();a.stopPropagation();a=d.find("#tb_data_field");a=JSON.parse(a.val());if("column"===k&&"sub-column"===a.component_name||"sub-column"===k&&"column"===a.component_name)a.component_name=k,a.grid_class=f.closest(".module_column").prop("class");if(a.component_name===t||a.component_name!==k)n.alertWrongPaste();else{b.eventName="row";b.hasChanged=!0;b.beforeEvent=n.clone(f);var c=function(a){a=b.Utils.clear(a);g.setData(a);
n.Lightbox.close()};a.used_gs!==t?b.GS.setImport(a.used_gs,c,a):c(a)}});else{var l=e.getData(f,k);l.component_name=k;var m=b.GS.findUsedItems(l);if(!1!==m){for(var w={},E=m.length-1;-1<E;--E){var r=b.GS.styles[m[E]],D=h.extend(!0,{},r.data[0]);"row"===r.type||"subrow"===r.type?D=D.styling:D.cols!==t?(D=D.cols[0])&&(D="column"===r.type?D.styling:D.modules!==t?D.modules[0].mod_settings:t):D=t;D!==t&&0<Object.keys(D).length&&(w[m[E]]={title:r.title,type:r.type,data:b.Utils.clear(D,!1)})}Object.keys(w).length&&
(l.used_gs=w)}l=JSON.stringify(l);d.find("#tb_data_field").val(l).on("click",function(){h(this).trigger("focus").trigger("select")})}v.body.one("themify_builder_lightbox_close",function(){d.removeClass("tb_import_export_lightbox");u.document.body.classList.remove("tb_standalone_lightbox");"import"===c&&d.find(".builder_save_button").off("click.tb_import")})})},getData:function(a,d){var c={};switch(d){case "row":case "subrow":c=b.Utils._getRowSettings(a.closest(".module_"+d)[0],d);break;case "module":c=
b.Models.Registry.lookup(a.closest(".active_module").data("cid")).attributes;break;case "column":case "sub-column":var c=a.closest(".module_column"),e=c.closest("column"===d?".module_row":".module_subrow"),c=b.Utils._getRowSettings(e[0],"column"===d?"row":"subrow").cols[c.index()]}return b.Utils.clear(c)},duplicate:function(a,d){var c=this.$el,e=n.clone(c);null!==b.activeModel&&n.Lightbox.$lightbox.is(":visible")&&ThemifyConstructor.saveComponent();c.removeClass("tb_element_cid_"+this.model.cid);
e.hide().insertAfter(c);var f=this.getData(e,this.model.get("elType"));b.eventName="duplicate";b.beforeEvent=e;b.hasChanged=!0;this.model.setData(f);c.addClass("tb_element_cid_"+this.model.cid)},edit:function(a,d){var c;if(b.isPreview)return!0;"breadcrumb"!==a?b.ActionBar.breadCrumbsPath.lightbox=null:a=null;var e=c=b.hasChanged=!1,f=n.Lightbox.$lightbox,g=this.model.get("elType"),k=!1,h="module"===g?this.model.get("mod_name"):g;if(null!==a){var m=d.classList;var q=m.contains("tb_dragger")?d.getAttribute("data-id"):
null;if(null!==q&&""===d.getAttribute("data-v"))return;"dblclick"===a.type&&this.model.cid!==b.autoSaveCid&&b.ActionBar.clear();c=null!==q||m.contains("tb_styling");if(!0===c)this.model.set({styleClicked:!0},{silent:!0}),null!==q&&(k=function(a){var c=m.contains("tb_dragger_padding")?"padding":"margin",d="padding"===c?"p":"m",e=ThemifyConstructor.label[d],f=t;if("module"===g&&(f=a.getElementsByClassName("tb_styling_tab_nav")[0],f!==t)){if(b.EdgeDrag.modules[h]!==t&&b.EdgeDrag.modules[h][c]!==t&&(q=
q.replace(/_left|_right|_bottom|_top$/ig,""),b.EdgeDrag.modules[h][c][q]!==t&&(c=b.EdgeDrag.getTabId(ThemifyConstructor.data[h].styling.options.options,q,d),null!==c))){for(var d=f.getElementsByClassName("tb_tab_wrapper")[0].getElementsByTagName("a"),k=d.length-1;-1<k;--k)if(d[k].getAttribute("href")==="#tb_1_"+c){d[k].click();break}d=null}c=f.getElementsByClassName("current")[0].getElementsByTagName("a")[0].getAttribute("href");f=a.querySelector(c)}f===t&&(f=a);for(var l=f.getElementsByClassName("tb_style_toggle"),
k=l.length-1;-1<k;--k)if(l[k].textContent===e){l[k].classList.contains("tb_closed")&&l[k].click();setTimeout(function(){l[k].closest(".simplebar-scroll-content").scrollTop=l[k].offsetTop;l=null},10);break}});else if(m.contains("tb_visibility_component"))e=!0,this.model.set({visibileClicked:!0},{silent:!0});else if(!0===(m.contains("tb_swap")?!1:"layout-part"===h?!0:v.body.triggerHandler("tb_edit_"+h,[a,this.el,this.model]))&&"visual"===b.mode&&!b.Forms.LayoutPart.id&&("dblclick"===a.type||m.contains("tb_edit"))){b.activeModel=
this.model;b.Forms.LayoutPart.edit(this.el);return}}null!==b.activeModel&&null!==b.autoSaveCid&&this.model.cid!==b.autoSaveCid&&ThemifyConstructor.saveComponent(!0);b.activeModel=this.model;if(b.autoSaveCid===this.model.cid){var p=null;if(!0===c)p=f.find('a[href="#tb_options_styling"]'),this.model.unset("styleClicked",{silent:!0});else if(!0===e)p=f.find('a[href="#tb_options_visibility"]'),this.model.unset("visibileClicked",{silent:!0});else if("module"===g||"row"===g)p=f.find('a[href="#tb_options_setting"]');
null!==p&&0<p.length&&(p[0].click(),!1!==k&&!0===c&&k(n.Lightbox.$lightbox[0].querySelector("#tb_lightbox_container")))}else n.Lightbox.open({loadMethod:"inline",templateID:h},!1,k),!1===b.GS.isGSPage&&(b.ActionBar.hideContextMenu(),("row"!==h||"row"===h&&null!==b.ActionBar.breadCrumbsPath.lightbox)&&n.Lightbox.$lightbox[0].getElementsByClassName("tb_action_breadcrumb")[0].appendChild(b.ActionBar.getBreadCrumbs(b.Instances.Builder[b.builderIndex].el.getElementsByClassName("tb_element_cid_"+this.model.cid)[0])))},
"delete":function(a,d,c){var e;a=this.$el;d=this.model;var f=d.cid,g=d.get("elType");if(!0===c||confirm(themifyBuilder.i18n[g+"DeleteConfirm"])){c=a.closest(".module_row");var k="row",l="",m={},q=f;"row"===g?(m.pos_cid=c.next(".module_row"),m.pos="before",0===m.pos_cid.length&&(m.pos="after",m.pos_cid=c.prev(".module_row")),k="delete_row",m.pos_cid=m.pos_cid.data("cid")):f=c.data("cid");c=n.clone(c);"row"!==g&&(e=a.closest(".module_subrow"));d.destroy();"row"!==g&&0<e.length&&0===e.find(".active_module").length&&
e.addClass("tb_row_empty");"row"!==g&&(l=h(".tb_element_cid_"+f),e=l.closest(".module_row"),0===e.find(".active_module").length&&e.addClass("tb_row_empty"));b.hasChanged=!0;b.undoManager.push(f,c,l,k,m);null!==b.activeModel&&b.activeModel.cid===q&&n.Lightbox.$lightbox.find(".tb_close_lightbox")[0].click();b.toolbar.pageBreakModule.countModules()}},save:function(a){null!==b.activeModel&&null!==b.autoSaveCid&&ThemifyConstructor.saveComponent(!0);var d=this.model.get("elType"),c={contructor:!0,loadMethod:"html",
save:{done:"save"},data:{}},e=this.model.cid;c.data["s"+d]={options:[{id:"item_title_field",type:"text",label:ThemifyConstructor.label.title},{id:"item_layout_save",type:"checkbox",label:"",options:[{name:"layout_part",value:ThemifyConstructor.label.slayout_part}],new_line:!1,after:"",help:'Any changes made to a Layout Part are saved and reflected everywhere else they are being used (<a href="https://themify.me/docs/builder#layout-parts" target="_blank">learn more</a>)'}]};n.Lightbox.$lightbox[0].style.display=
"none";n.Lightbox.open(c,function(){u.document.body.classList.add("tb_standalone_lightbox")},function(c){var g=this.$lightbox,f=function(a){if("keypress"!==a.type||13===a.keyCode){a.preventDefault();a.stopPropagation();n.showLoader("show");a=b.Models.Registry.lookup(e);switch(d){case "row":var g=d;var f=b.Utils._getRowSettings(h(".tb_element_cid_"+e)[0]);b.Utils.clearElementId([f],!0);break;case "module":g=a.get("mod_name"),f={mod_name:g,element_id:b.Utils.generateUniqueID(),mod_settings:a.get("mod_settings")}}f=
b.Utils.clear(f);var k=ThemifyStyles.builder_id;a=h.extend(b.Forms.serialize(c),{action:"tb_save_custom_item",item:JSON.stringify(f),tb_load_nonce:themifyBuilder.tb_load_nonce,postid:k,type:d});g=b.GS.findUsedItems(f);!1!==g&&(a.usedGS=g);var l=a.item_layout_save;h.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:a,success:function(a){if("success"===a.status){var c=function(a){h("#tb_module_panel",u.document).find(".tb_module_panel_search_text").val("");if(l){b.hasChanged=!0;var c=
{mod_name:"layout-part",mod_settings:{selected_layout_part:a.post_name}};delete a.status;0<ThemifyConstructor.layoutPart.data.length&&ThemifyConstructor.layoutPart.data.push(a);var g=h(".tb_element_cid_"+e),f=n.clone(g);if("row"===d){c=b.Views.init_row({cols:[{grid_class:"col-full first last",element_id:b.Utils.generateUniqueID(),modules:[c]}]});var k=c.view.render();c=b.Models.Registry.lookup(k.$el.find(".active_module").data("cid"))}else c=b.Views.init_module(c),k=c.view.render(),c=c.model;g.replaceWith(k.el);
if("visual"===b.mode)h(r).ajaxComplete(function B(a,c,e){-1!==e.data.indexOf("tb_load_module_partial",3)&&(h(this).off("ajaxComplete",B),m="row"===d?b.liveStylingInstance.$liveStyledElmt.closest(".module_row"):b.liveStylingInstance.$liveStyledElmt,b.undoManager.push(k.$el.data("cid"),f,m,"row"))}),c.trigger("custom:preview:refresh",c.get("mod_settings"));else{var m=k.el;b.Mixins.Builder.updateModuleSort(k.$el);b.undoManager.push(k.$el.data("cid"),f,m,"row")}}if(!0===b.toolbar.libraryItems.is_init){g=
h(".tb_library_item_list");a=b.toolbar.libraryItems.template([a]);"visual"===b.mode&&(g=g.add(b.toolbar.$el.find(".tb_library_item_list")));g=g.get();c=0;for(var q=g.length;c<q;++c){var p=g[c].getElementsByClassName("simplebar-content");0<p.length?p[0].insertAdjacentHTML("afterbegin",a):g[c].insertAdjacentHTML("afterbegin",a);g[c].previousElementSibling.getElementsByClassName("current")[0].click()}b.toolbar.libraryItems.bindEvents(!0)}n.showLoader("hide");n.Lightbox.close()};l?(ThemifyStyles.builder_id=
a.id,b.Utils.saveCss([f],"",a.id).done(function(){ThemifyStyles.builder_id=k;c(a)})):c(a)}else alert(a.msg)}})}};g.addClass("tb_save_module_lightbox");this.setStandAlone(a.clientX,a.clientY);g.on("click.saveLayout",".builder_save_button",f).on("keypress.saveLayout","input",f);v.body.one("themify_builder_lightbox_close",function(){g.removeClass("tb_save_module_lightbox").off(".saveLayout");u.document.body.classList.remove("tb_standalone_lightbox")})})}});b.Views.BaseElement.extend=function(a){var b=
this,c=z.View.extend.apply(this,arguments);c.prototype.events=_.extend({},this.prototype.events,a.events);c.prototype.initialize=function(){"function"===typeof b.prototype.initialize&&b.prototype.initialize.apply(this,arguments);"function"===typeof a.initialize&&a.initialize.apply(this,arguments)};return c};b.Views.Modules["default"]=b.Views.BaseElement.extend({tagName:"div",attributes:function(){var a=this.model.get("mod_settings"),d={"data-cid":this.model.cid,"class":"active_module module-"+this.model.get("mod_name")+
" tb_"+this.model.get("element_id")+" tb_element_cid_"+this.model.cid};if("visual"===b.mode){if(d["class"]+=" tb_module_front","hide_all"===a.visibility_all||"hide"===a.visibility_desktop||"hide"===a.visibility_tablet||"hide"===a.visibility_tablet_landscape||"hide"===a.visibility_mobile)d["class"]+=" tb_visibility_hidden"}else d["class"]+=" tb_module";a.custom_css_id!==t&&""!==a.custom_css_id&&(d.id=a.custom_css_id);return d},template:"visual"===b.mode?null:wp.template("builder_module_item"),initialize:function(){this.listenTo(this.model,
"dom:module:unsaved",this.removeUnsaved)},removeUnsaved:function(){this.model.destroy()},render:function(){"visual"!==b.mode&&(this.el.innerHTML=this.template(this.model.toRenderData()));b.Utils.visibilityLabel(this.el);return this}});b.Views.Columns["default"]=b.Views.BaseElement.extend({tagName:"div",attributes:function(){var a={"class":"module_column tb-column tb_element_cid_"+this.model.cid+" tb_"+this.model.get("element_id")+" "+this.model.get("grid_class"),"data-cid":this.model.cid};this.model.get("grid_width")&&
(a.style="width:"+this.model.get("grid_width")+"%");"column"!==this.model.get("component_name")&&(a["class"]+=" sub_column");return a},render:function(){var a=this.model.get("component_name");this.el.innerHTML=n.templateCache.get("tmpl-builder_column_item");var d=this.model.get("modules");if(d){var c=this.el.getElementsByClassName("tb_holder")[0],e;for(e in d)if(d[e]!==t&&null!==d[e]){var f=d[e];(f=f.cols===t?b.Views.init_module(f):b.Views.init_subrow(f))&&c.appendChild(f.view.render().el)}"sub-column"===
a&&c.classList.add("tb_subrow_holder")}return this}});b.Views.SubRows["default"]=b.Views.BaseElement.extend({tagName:"div",attributes:function(){return{"class":"themify_builder_sub_row module_subrow active_module clearfix tb_element_cid_"+this.model.cid+" tb_"+this.model.get("element_id"),"data-cid":this.model.cid}},render:function(){var a=this.model.get("cols"),d=Object.keys(a).length;this.el.innerHTML=n.templateCache.get("tmpl-builder_subrow_item");if(0<d){for(var c=this.el.getElementsByClassName("subrow_inner")[0],
e=!1,f=0;f<=d;++f)a[f]!==t&&null!==a[f]&&(a[f].component_name="sub-column",c.appendChild(b.Views.init_column(a[f]).view.render().el),!1===e&&a[f].modules!==t&&0<a[f].modules.length&&(e=!0));!1===e&&this.el.classList.add("tb_row_empty")}b.Utils.selectedGridMenu(this.el,"subrow");b.Utils.visibilityLabel(this.el);return this}});b.Views.Rows["default"]=b.Views.BaseElement.extend({tagName:"div",attributes:function(){var a=this.model.get("styling"),b={"class":"themify_builder_row module_row clearfix tb_element_cid_"+
this.model.cid+" tb_"+this.model.get("element_id"),"data-cid":this.model.cid};null!==a&&(a.custom_css_row!==t&&""!==a.custom_css_row&&(b["class"]+=" "+a.custom_css_row),a.custom_css_id!==t&&""!==a.custom_css_id&&(b.id=a.custom_css_id));return b},render:function(){var a=this.model.get("cols"),d=Object.keys(a).length,c=!1;this.el.innerHTML=n.templateCache.get("tmpl-builder_row_item");var e=this.el.getElementsByClassName("row_inner")[0];if(0<d)for(var f=0;f<=d;++f)a[f]!==t&&null!==a[f]&&(a[f].component_name=
"column",e.appendChild(b.Views.init_column(a[f]).view.render().el),!1===c&&a[f].modules!==t&&(0<a[f].modules.length||"object"===typeof a[f].modules&&0<Object.keys(a[f].modules).length)&&(c=!0));else b.Utils._addNewColumn({newclass:"col-full",component:"column"},e);!1===c&&this.el.classList.add("tb_row_empty");b.Utils.selectedGridMenu(this.el,"row");b.Utils.visibilityLabel(this.el);return this}});b.Views.Builder=z.View.extend({type:"default",lastRow:null,events:{"click .tb_import_layout_button":"importLayoutButton"},
initialize:function(){this.$el.off("tb_init tb_new_row").on("tb_init",this.init.bind(this)).on("tb_init",this.newRowAvailable.bind(this))},init:function(a){b.Mixins.Builder.rowSort(this.$el);"visual"===b.mode?(b.Mixins.Builder.updateModuleSort(this.$el),setTimeout(function(){b.Utils._onResize(!0)},1500)):(b.Mixins.Builder.updateModuleSort(this.$el),b.Mixins.Builder.initModuleDraggable(b.toolbar.$el.find(".tb_module_panel_modules_wrap").first(),".tb_module"),b.Mixins.Builder.initModuleDraggable(b.toolbar.$el,
".tb_row_grid"));var d=this;setTimeout(function(){b.ActionBar.init();b.Utils.setCompactMode(d.el.getElementsByClassName("module_column"));d.insertLayoutButton();"visual"!==b.mode&&b.GS.init()},1E3);C={}},render:function(){var a=this.collection;b.Utils.clearLastEmptyRow(a.models);for(var d=0,c=a.models.length;d<c;++d){var e=b.Views.init_row(a.models[d]);!1!==e&&this.el.appendChild(e.view.render().el)}b.Utils.columnDrag(!1,!1);return this},insertLayoutButton:function(){this.removeLayoutButton();this.lastRowAddBtn();
var a=this.el.getElementsByClassName("module_row");a[0]!==t&&2>a.length&&a[0].classList.contains("tb_row_empty")&&(a=r.createElement("a"),a.className="tb_import_layout_button",a.href="#",a.textContent=themifyBuilder.i18n.text_import_layout_button,this.el.appendChild(a))},removeLayoutButton:function(){for(var a=this.el.getElementsByClassName("tb_import_layout_button"),b=a.length-1;-1<b;--b)a[b].parentNode.removeChild(a[b])},importLayoutButton:function(a){b.Views.Toolbar.prototype.loadLayout(a)},newRowAvailable:function(a,
d){var c=this.el.children,e=!0,f=c.length;a=a||1;if(0!==f&&!0!==d)for(--f;-1<f;--f)if(c[f].classList.contains("module_row")){e=!1;break}if(!0===e)return c=b.Views.init_row(b.Utils.grid(a)[0]).view.render().$el,c[0].className+=" tb_new_row",this.el.insertBefore(c[0],this.lastRow),b.Utils.setCompactMode(c[0].getElementsByClassName("module_column")),b.Mixins.Builder.update(c),b.Utils.calculateHeight(),c},lastRowShowHide:function(a){this.lastRow&&(a?this.lastRow.classList.remove("hide"):(this.lastRow.classList.remove("expanded"),
this.lastRow.classList.add("hide")))},lastRowAddBtn:function(){if(!0!==b.GS.isGSPage){var a=r.getElementById("tb_add_container");null!==a&&a.parentNode.removeChild(a);this.lastRow=r.createElement("div");var a=r.createElement("div"),d=null;this.lastRow.id="tb_add_container";a.className="tb_last_add_btn";a.textContent="+";this.lastRow.appendChild(a);this.lastRow.addEventListener("click",function(a){a.preventDefault();var c=a.target,f=c.closest(".tb_row_grid");null!==f?(this.classList.remove("expanded"),
b.Mixins.Builder.rowDrop(b.Utils.grid(f.dataset.col),h("<div>").insertBefore(this),!0,!0)):c.classList.contains("tb_add_blocks")?(this.classList.remove("expanded"),b.toolbar.common.show(a,h(this).find(".tb_last_add_btn")),b.toolbar.common.clicked=this.previousElementSibling?h(this.previousElementSibling):null,b.toolbar.common.btn[0].querySelector('[data-target="tb_module_panel_rows_wrap"]').click()):c.classList.contains("tb_last_add_btn")&&(null===d&&(d=!0,a=n.is_template_support?r.getElementById("tmpl-last_row_add_btn").content.cloneNode(!0):
n.templateCache.get("tmpl-last_row_add_btn"),n.is_template_support?this.appendChild(a):this.insertAdjacentHTML("beforeend",a)),this.classList.add("expanded"))});a=null;this.el.appendChild(this.lastRow)}}});b.Mixins.Builder={before:null,zindex:null,r:null,w:null,h:null,type:null,moduleHolderArgs:null,isFullWidth:null,update:function(a){if("visual"===b.mode){var d=null!==b.activeModel?b.activeModel.get("elType"):b.Models.Registry.lookup(a.data("cid")).get("elType");b.Utils.loadContentJs(a,d)}a=a.closest(".module_row");
b.Utils.columnDrag(a.find(".row_inner"),!1);b.Utils.columnDrag(a.find(".subrow_inner"),!1);b.Mixins.Builder.updateModuleSort(a)},dragScroll:function(a,d){function c(a,b){l=!0;if(null===k){k=!0;var d=this!==t?this.id:null;d||(d=b);var e=("tb_toolbar"===d||"wpadminbar"===d?"-":"+")+("="+g*m+"px");f.stop().animate({scrollTop:e},{duration:1,complete:function(){!0===l&&(10>m&&++m,k=null,c(null,d))}})}}var e=h("body",u.document);"visual"===b.mode&&(e=e.add(v.body));this.top===t&&(this.top=b.toolbar.$el,
this.top=this.top.add(h("#tb_fixed_bottom_scroll",u.document)),"visual"!==b.mode&&(this.top=this.top.add("#wpadminbar")));if(!0===d)this.top.off("mouseenter mouseleave"),"row"===a&&"visual"===b.mode&&b.toolbar.$el.find('.tb_zoom[data-zoom="100"]').trigger("click"),e.removeClass("tb_drag_start tb_drag_"+a);else{var f=null,g=1,k=null,l=!0,m=1;"visual"!==b.mode&&(f=h(".edit-post-layout__content").first(),0===f.length?f=null:g/=2);null===f&&(f="desktop"===b.activeBreakPoint?h("body,html"):h("body,html",
u.document));e.addClass("tb_drag_start tb_drag_"+a);"row"===a&&"visual"===b.mode&&b.toolbar.$el.find('.tb_zoom[data-zoom="50"]').trigger("click");if(0<g)this.top.off("mouseenter").on("mouseenter",c).off("mouseleave").on("mouseleave",function(){m=1;k=l=null;f.stop()})}},columnSort:function(a){var d,c;a.find(".row_inner, .subrow_inner").sortable({items:"> .module_column",handle:"> .tb_column_action .tb_column_dragger",axis:"x",placeholder:"tb_state_highlight",tolerance:"pointer",cursorAt:{top:20,left:20},
beforeStart:function(a,b,g){v.body.addClass("tb_drag_start");d=n.clone(g.item.closest(".module_row"));c=g.item.siblings();c.css("marginLeft",0)},start:function(a,b){h(".tb_state_highlight").width(b.item.width())},stop:function(a,b){v.body.removeClass("tb_drag_start");c.css("marginLeft","")},update:function(a,c){var e=c.item.closest(".ui-sortable"),f=e.children(".module_column");f.removeClass("first last");e[0].classList.contains("direction-rtl")?(f.last().addClass("first"),f.first().addClass("last")):
(f.first().addClass("first"),f.last().addClass("last"));b.Utils.columnDrag(e,!1);b.Utils.setCompactMode(f);e=e.closest(".module_row");b.undoManager.push(e.data("cid"),d,e,"row")}})},rowSort:function(a){var d=this,c,e={items:">.module_row",handle:">.tb_row_action",axis:"y",placeholder:"tb_state_highlight",containment:"visual"===b.mode?"parent":"body",tolerance:"pointer",forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!1,beforeStart:function(a,e,k){d.before||(b.ActionBar.hoverCid=null,c=b.ActionBar.disable=
!0,d.before=k.item.next(".module_row"),0===d.before.length&&(d.before=k.item.prev(".module_row"),c=!1),d.before=d.before.data("cid"),d.dragScroll("row"))},start:function(){a.sortable("refreshPositions")},stop:function(a,e){b.ActionBar.disable=null;d.before=c=null;d.dragScroll("row",!0)},update:function(a,e){if("visual"===b.mode&&!e.item[0].classList.contains("tb_row_grid")){var f="desktop"===b.activeBreakPoint?h("html,body"):h("body",u.document);f.scrollTop(e.item.offset().top);f=null}if("sortupdate"===
a.type&&d.before){b.hasChanged=!0;var f=e.item.next(".module_row"),g=!0;0===f.length&&(f=e.item.prev(".module_row"),c=g=!1);f=f.data("cid");b.undoManager.push(e.item.data("cid"),null,null,"row_sort",{bnext:c,before:d.before,anext:g,after:f})}else e.item[0].classList.contains("predesigned_row")||e.item[0].classList.contains("tb_page_break_module")||"row"===e.item.data("type")?"row"===e.item.data("type")?b.toolbar.libraryItems.get(e.item.data("id"),"row",function(a){Array.isArray(a)||(a=Array(a));d.rowDrop(a,
e.item)}):e.item[0].classList.contains("tb_page_break_module")?(d.rowDrop(b.toolbar.pageBreakModule.get(),e.item),b.toolbar.pageBreakModule.countModules()):b.toolbar.preDesignedRows.get(e.item.data("slug"),function(a){d.rowDrop(a,e.item)}):e.item[0].classList.contains("tb_row_grid")&&d.subRowDrop(e.item.data("slug"),e.item)}};"visual"===b.mode&&(e.helper=function(){return h('<div class="tb_sortable_helper"/>')});a.sortable(e)},updateModuleSort:function(a,d){if(!0!==b.GS.isGSPage){var c=h(".tb_holder",
a),e=this;if(d)return c.filter(".ui-sortable").sortable(d),!1;c.each(function(){h(this).data({uiSortable:null,sortable:null})});this.moduleHolderArgs={placeholder:"tb_state_highlight",items:">.active_module,>div>.active_module",connectWith:".tb_holder",revert:100,scroll:!1,cancel:".tb_disable_sorting,.tb_action_wrap:not(.tb_subrow_action)",cursorAt:{top:10,left:90},beforeStart:function(a,c,d){b.ActionBar.disable=!0;b.ActionBar.hoverCid=null;e.before||(e.r=d.item.closest(".module_row"),0<e.r.length?
(e.before=n.clone(e.r),e.zindex=e.r.css("zIndex"),"auto"===e.zindex&&(e.zindex=""),e.r.css("zIndex",2)):e.r=null,e.w=d.item[0].style.width,e.h=d.item[0].style.height,d.item.css({width:180,height:30}),e.type="module",d.item[0].classList.contains("module_subrow")?e.type+=" tb_drag_subrow":d.item[0].classList.contains("tb_row_grid")&&(e.type="column"),e.dragScroll(e.type))},start:function(a,b){if(b.item[0].classList.contains("module_subrow")||b.item[0].classList.contains("tb_row_grid"))h(".ui-sortable.tb_subrow_holder").sortable("disable"),
h(".ui-sortable.tb_holder").sortable("refresh")},stop:function(a,c){b.ActionBar.disable=null;b.ActionBar.clear();"visual"===b.mode&&c.helper&&h(c.helper).remove();c.item.css({width:e.w,height:e.h,display:""});e.dragScroll(e.type,!0);e.r&&e.r.css("zIndex",e.zindex);if(c.item[0].classList.contains("module_subrow")||c.item[0].classList.contains("tb_row_grid"))h(".ui-sortable.tb_subrow_holder").sortable("enable"),h(".ui-sortable.tb_holder").sortable("refresh");e.before=e.w=e.h=e.r=e.zindex=e.type=null},
update:function(a,d){d.item.css({width:e.w,height:e.h});if(d.item[0].classList.contains("tb_module_dragging_helper")){var f=h(d.item.clone(!1));if(d.item.data("id")){var g=d.item.closest(".module_row");0<g.length&&(e.before=n.clone(g),e.before.find(".tb_module_dragging_helper").remove())}d.item.after(f);e.moduleDrop(f,null,e.before)}else{if(d.sender&&(f=d.sender.closest(".module_row"),d.sender.closest(".module_row").toggleClass("tb_row_empty",0===f.find(".active_module").length),f=d.sender.closest(".module_subrow"),
0<f.length&&f.toggleClass("tb_row_empty",0===f.find(".active_module").length),d.item[0].classList.contains("module_subrow")&&0<d.item.parent().closest(".module_subrow").length)){c.sortable("cancel");return}e.before&&(b.hasChanged=!0,d.item[0].classList.contains("module_subrow")||d.item.closest(".module_subrow").removeClass("tb_row_empty"),f=d.item.closest(".module_row"),f.removeClass("tb_row_empty"),b.undoManager.push(d.item.data("cid"),e.before,f,"sort",{before:e.before.data("cid"),after:f.data("cid")}),
e.before=null,v.body.triggerHandler("tb_"+e.type+"_sort",[d.item]))}}};"visual"===b.mode&&(this.moduleHolderArgs.helper=function(){return h('<div class="tb_sortable_helper"/>')});c.sortable(this.moduleHolderArgs)}},initModuleDraggable:function(a,d){var c=this,e=h.extend(!0,{},this.moduleHolderArgs);e.update=!1;e.appendTo=r.body;e.items=d;".tb_row_grid"===d&&(e.connectWith=[e.connectWith,"visual"===b.mode?"#themify_builder_content-"+themifyBuilder.post_ID:"#tb_row_wrapper"]);e.stop=function(b,d){h(this).sortable("cancel");
d.item.removeClass("tb_sortable_helper tb_module_dragging_helper");c.moduleHolderArgs.stop(b,d);d.item[0].classList.contains("tb_row_grid")&&a.sortable("refresh")};e.start=function(b,d){d.item.addClass("tb_sortable_helper tb_module_dragging_helper");c.moduleHolderArgs.start(b,d);d.item[0].classList.contains("tb_row_grid")&&a.sortable("refresh")};e.helper=function(a,b){return h('<div class="tb_sortable_helper tb_module_dragging_helper">'+b.text()+"</div>")};a.sortable(e)},initRowDraggable:function(a,
d){var c=this;a.find(d).draggable({appendTo:v.body,helper:"clone",revert:"invalid",connectToSortable:"visual"===b.mode?"#themify_builder_content-"+themifyBuilder.post_ID:"#tb_row_wrapper",cursorAt:{top:10,left:40},start:function(a,b){c.dragScroll("row");b.helper.addClass("tb_module_dragging_helper tb_sortable_helper").find(".tb_predesigned_rows_image").remove()},stop:function(a,b){c.dragScroll("row",!0)}})},initModuleVisualDrag:function(a){var d=this;b.toolbar.$el.find(a).ThemifyDraggable({iframe:"#tb_iframe",
dropitems:".tb_holder",elements:".active_module",type:"module",onDragBefore:function(a,d){b.ActionBar.disable=!0},onDragEnd:function(){b.ActionBar.disable=null},onDrop:function(a,b,f){d.moduleDrop(b,!1,n.clone(f.closest(".module_row")))}})},initRowGridVisualDrag:function(){var a=this;b.toolbar.$el.find(".tb_row_grid").ThemifyDraggable({iframe:"#tb_iframe",dropitems:".tb_holder:not('.tb_subrow_holder'),.themify_builder_content:not('.not_editable_builder')>.module_row",elements:".active_module",cancel:".tb_subrow_holder",
append:!1,type:"column",onDragBefore:function(a,c){b.ActionBar.disable=!0},onDragEnd:function(){b.ActionBar.disable=null},onDrop:function(b,c,e){a.subRowDrop(c.data("slug"),c)}})},initRowVisualDrag:function(a){var d=this;b.toolbar.$el.find(a).ThemifyDraggable({iframe:"#tb_iframe",dropitems:".themify_builder_content:not('.not_editable_builder')>.module_row",append:!1,type:"row",onDragBefore:function(a,d){b.ActionBar.disable=!0;b.toolbar.$el.find('.tb_zoom[data-zoom="50"]').click()},onDragEnd:function(){b.ActionBar.disable=
null},onDrop:function(a,e,f){e.addClass("tb_state_highlight").find(".tb_predesigned_rows_image").remove();e.show();b.Utils.setCompactMode(e.offset().top);"row"===e.data("type")?b.toolbar.libraryItems.get(e.data("id"),"row",function(a){if(!Array.isArray(a)){a=Array(a);var c=b.GS.findUsedItems(a);!1!==c&&c.length&&(a[0].used_gs=c)}d.rowDrop(a,e)}):e[0].classList.contains("tb_page_break_module")?(d.rowDrop(b.toolbar.pageBreakModule.get(),e),b.toolbar.pageBreakModule.countModules()):b.toolbar.preDesignedRows.get(e.data("slug"),
function(a){d.rowDrop(a,e)})}})},subRowDrop:function(a,d){b.ActionBar.clear();var c=0<d.parent(".themify_builder_content,#tb_row_wrapper").length;if(c||0===d.closest(".sub_column").length){a=b.Utils.grid(a);if(!c){var e=n.clone(d.closest(".module_row"));e.find(".tb_row_grid").remove();var f="row"}var g=(c?b.Views.init_row({cols:a[0].cols}):b.Views.init_subrow({cols:a[0].cols})).view.render().$el;if(c||d[0].parentNode.classList.contains("tb_holder")||d[0].parentNode.parentNode.classList.contains("tb_holder"))d[0].parentNode.replaceChild(g[0],
d[0]),g[0].className+=" tb_element_clicked",b.ActionBar.type="subrow";else{var h=d.next(".tb_holder");0<h.length?h.prepend(g):(h=d.prev(".tb_holder"),h.append(g))}if(c){e=g.next(".module_row");var l=!0;0===e.length&&(l=!1,e=g.prev(".module_row"));e=e.data("cid");f="grid_sort"}b.Utils.setCompactMode(g[0].getElementsByClassName("module_column"));b.Mixins.Builder.update(g);d.remove();b.hasChanged=!0;h=g.closest(".module_row");c||h.removeClass("tb_row_empty");h.find(".tb_row_grid").remove();b.Utils.scrollToDropped(g[0]);
b.undoManager.push(h.data("cid"),e,h,f,{next:l})}else d.remove()},rowDrop:function(a,d,c,e){function f(){var a=d.prev(".module_row");if(0===a.length){var c="visual"===b.mode?d.closest(".themify_builder_content").data("postid"):null;a=!1}else a=a.data("cid");d[0].innerHTML="";b.ActionBar.type="row";d[0].parentNode.replaceChild(h,d[0]);b.hasChanged=!0;b.Instances.Builder[b.builderIndex].removeLayoutButton();b.undoManager.push("","","","predesign",{prev:a,rows:l,bid:c});a=0;for(c=l.length;a<c;++a){var e=
l[a][0].getElementsByClassName("module_column");0===a&&l[a][0].classList.add("tb_element_clicked");b.Utils.setCompactMode(e);b.Mixins.Builder.update(l[a])}b.Utils.scrollToDropped(l[0][0]);n.showLoader("hide");b.Utils.calculateHeight()}b.ActionBar.clear();var g=function(a){for(var b in a)if(a[b].styling&&0<Object.keys(a[b].styling).length||a[b].modules&&0<Object.keys(a[b].modules).length)return!0;return!1},h=r.createDocumentFragment(),l=[],m=[];e||b.Utils.clearLastEmptyRow(a);e=0;for(var q=a.length;e<
q;++e)if(!0===c||a[e].styling&&0<Object.keys(a[e].styling).length||a[e].cols&&g(a[e].cols)){var p=b.Views.init_row(a[e]);if(!1!==p){p=p.view.render();h.appendChild(p.el);if("visual"===b.mode){var y=p.el.querySelectorAll("[data-cid]");m[p.el.dataset.cid]=1;e=0;for(q=y.length;e<q;++e)m[y[e].dataset.cid]=1}l.push(p.$el)}}"visual"===b.mode?(b.bootstrap(m,f),m=null):f()},moduleDrop:function(a,d,c){function e(e){function f(e){k||h.model.set({is_new:1},{silent:!0});e=!0===e?h.model.getPreviewSettings():
h.model.get("mod_settings");d?d.hasClass("tb_module_front")?d.after(l.el):d.append(l.el):a.replaceWith(l.el);k?b.activeModel=h.model:h.model.trigger("edit",null);b.hasChanged=!0;var f=!1;if("visual"===b.mode)if("layout-part"!==h.model.get("mod_name")){if(1<=Object.keys(e).length){var m=e.cid;"part"===g||"ajax"===a.data("type")?(f=!0,h.model.trigger("custom:preview:refresh",e)):"module"!==g?h.model.trigger("custom:preview:live",e):b.Utils.loadContentJs(l.$el,"module")}}else b.Utils.loadContentJs(l.$el,
"module");k&&(f&&(e=h.view.$el.find(".tb_preview_component").detach(),h.view.$el.prepend(e)),c&&(m=l.$el.closest(".module_row"),m.removeClass("tb_row_empty").find(".tb_module_dragging_helper").remove(),l.$el.closest(".module_subrow").removeClass("tb_row_empty"),b.undoManager.push(m.data("cid"),c,m,"row"),m=m.data("cid"),b.Instances.Builder[b.builderIndex].removeLayoutButton(),b.activeModel=null),b.Utils.calculateHeight());b.Utils.scrollToDropped(null,m)}var h=b.Views.init_module(e,!0),l=h.view.render();
"visual"===b.mode&&k?(e=[],e[h.model.cid]=1,b.bootstrap(e,f)):f(!0);return l}b.ActionBar.clear();if(a[0].classList.contains("tb_row_grid"))this.subRowDrop(a.data("slug"),a);else{var f={mod_name:a.data("module-slug")},g=a.data("type"),k="part"===g||"module"===g;if(k)b.toolbar.libraryItems.get(a.data("id"),g,e);else return e(f);"visual"!==b.mode&&h(".themify-wp-editor-holder").addClass("themify-active-holder")}},toJSON:function(a){var d=[];a=a.children;for(var c=0,e=a.length;c<e;++c)if(a[c].classList.contains("module_row")){var f=
b.Utils._getRowSettings(a[c]);0<Object.keys(f).length&&d.push(f)}return d},columnHover:function(a){for(var d=a.closest(".sub_column"),c=b.Instances.Builder[b.builderIndex].el.getElementsByClassName("tb_hover_sub_column"),e=c.length-1;-1<e;--e)c[e].classList.remove("tb_hover_sub_column");c=b.Instances.Builder[b.builderIndex].el.getElementsByClassName("tb_action_overlap");for(e=c.length-1;-1<e;--e)c[e].classList.remove("tb_action_overlap");if(null!==d){var f=d.parentNode.closest(".module_column");if(!f.classList.contains("tb_hover_sub_column")&&
(f.classList.add("tb_hover_sub_column"),c=d.getElementsByClassName("tb_column_action")[0],c!==t)){var e=c.getBoundingClientRect(),g=!0,f=5>e.left?f.closest(".module_row").getElementsByClassName("tb_row_action")[0]:d.closest(".module_subrow").getElementsByClassName("tb_subrow_action")[0];f!==t&&(g=f.getBoundingClientRect(),g=Math.abs(e.left-g.left)<e.width?Math.abs(g.top-e.top)>e.height:!0);!0===g?c.classList.remove("tb_action_overlap"):c.classList.add("tb_action_overlap")}}!0!==this.isFullWidth&&
(d=null!==d?d.parentNode.closest(".module_column"):a.closest(".module_column"),!1!==this.isFullWidth&&(a=null!==d?d.closest(".module_row"):a.closest(".module_row"),null!==a&&(a.offsetWidth<r.body.clientWidth?(this.isFullWidth=!0,r.body.classList.remove("tb_page_row_fullwidth")):(this.isFullWidth=!1,r.body.classList.add("tb_page_row_fullwidth")))),null!==d&&null!==d.parentNode.parentNode.closest(".fullwidth")&&(a=d.getElementsByClassName("tb_column_action")[0],a!==t&&a.getBoundingClientRect().right>=
r.body.clientWidth&&a.classList.add("tb_action_outside")))}};b.undoManager={stack:[],is_working:!1,index:-1,btnUndo:null,btnRedo:null,compactBtn:null,init:function(){this.btnUndo=b.toolbar.el.getElementsByClassName("tb_undo_btn")[0];this.btnRedo=b.toolbar.el.getElementsByClassName("tb_redo_btn")[0];this.compactBtn=b.toolbar.el.getElementsByClassName("tb_compact_undo")[0];b.toolbar.$el.find(".tb_undo_redo").on("click",this.do_change.bind(this));if(!themifyBuilder.disableShortcuts&&(h(u.document).on("keydown",
this.keypres.bind(this)),"visual"===b.mode))h(r).on("keydown",this.keypres.bind(this))},push:function(a,d,c,e,f){b.hasChanged&&(b.editing=!1,c&&(c=n.clone(c)),"visual"!==b.mode||"duplicate"!==e&&"sort"!==e||h(x).triggerHandler("tfsmartresize.tfVideo"),this.stack.splice(this.index+1,this.stack.length-this.index),this.stack.push({cid:a,type:e,data:f,before:d,after:c}),this.index=this.stack.length-1,this.updateUndoBtns(),"visual"===b.mode&&(b.Forms.LayoutPart.isSaved=null,v.body.triggerHandler("builder_dom_changed",
[e])))},set:function(a){var d=a[0].querySelectorAll("[data-cid]"),d=Array.prototype.slice.call(d);d.unshift(a[0]);a=0;for(var c=d.length;a<c;++a){var e=b.Models.Registry.lookup(d[a].getAttribute("data-cid"));e&&e.trigger("change:view",d[a])}},doScroll:function(a){return a},keypres:function(a){if(90===a.which&&"INPUT"!==r.activeElement.tagName&&"TEXTAREA"!==r.activeElement.tagName)if(!0===a.ctrlKey&&!0===a.shiftKey||!0===a.metaKey&&!0===a.shiftKey)a.preventDefault(),this.hasRedo()&&this.changes(!1);
else if(!0===a.ctrlKey||!0===a.metaKey)a.preventDefault(),this.hasUndo()&&this.changes(!0)},changes:function(a){b.ActionBar.clearClicked();var d=a?0:1;if(null!==b.activeModel){if(!0===b.hasChanged){ThemifyConstructor.saveComponent(!1);h(this.btnUndo).triggerHandler("click");return}n.Lightbox.close()}var c=this.stack[this.index+d];if(c!==t){this.is_working=!0;var e="";var f=c.type;var g=h(".tb_element_cid_"+c.cid);d=!1;b.eventName=f;if("row"===f)a?(e=n.clone(c.before),d=c.cid):(e=n.clone(c.after),
d=c.before.data("cid"),g=h(".tb_element_cid_"+d)),this.doScroll(g),this.set(e),e.toggleClass("tb_row_empty",0===e.find(".active_module").length),g.replaceWith(e);else if("duplicate"===f)a?this.doScroll(h(".tb_element_cid_"+c.after.data("cid"))).remove():(this.doScroll(g),e=n.clone(c.after),d=c.before.data("cid"),this.set(e),g.after(e));else if("delete_row"===f)a?(e=n.clone(c.before),d=c.cid,g=h(".tb_element_cid_"+c.data.pos_cid),this.doScroll(g),this.set(e),"after"===c.data.pos?g.after(e):g.before(e)):
this.doScroll(g).remove();else if("sort"===f)d=c.cid,a?(g=c.data.before,e=n.clone(c.before)):(g=c.data.after,e=n.clone(c.after),"visual"===b.mode&&e.find(".active_module").css({display:"block",height:"auto"})),this.doScroll(e),this.set(e),c=h(".tb_element_cid_"+d).closest(".module_row"),h(".tb_element_cid_"+d).remove(),c.toggleClass("tb_row_empty",0===c.find(".active_module").length),c=null,h(".tb_element_cid_"+g).replaceWith(e),c=e.closest(".module_row"),c.toggleClass("tb_row_empty",0===c.find(".active_module").length),
c=null;else if("row_sort"===f){d=c.cid;var k=c.data[a?"bnext":"anext"];c=h(".tb_element_cid_"+c.data[a?"before":"after"]);g=h(".tb_element_cid_"+d);e=n.clone(g);g.remove();g=null;this.set(e);k?c.before(e):c.after(e);this.doScroll(e)}else if("save"===f){d=c.cid;var f=b.Models.Registry.lookup(d),l="module"===f.get("elType"),m=l?"mod_settings":"styling";if(l&&c.data.column)a?(c=h(".tb_element_cid_"+d).closest(".module_row"),d=!1,this.doScroll(g).remove()):(d=c.data.column.data("cid"),e=n.clone(c.data.column),
g=h(".tb_element_cid_"+d),this.doScroll(g),this.set(e),g.replaceWith(e),c=e.closest(".module_row")),c.toggleClass("tb_row_empty",0===c.find(".active_module").length),c=null;else{this.doScroll(g);l={};a?(e=n.clone(c.before),l[m]=c.data.bsettings):(e=n.clone(c.after),l[m]=c.data.asettings);if("visual"===b.mode){c=h.extend(!0,{},c.data.styles);for(var q in c){var p=ThemifyStyles.getSheet(q),p=p.cssRules?p.cssRules:p.rules;for(k in c[q])if(p[k])for(var y in c[q][k])p[k].style["backgroundClip"===y||"background-clip"===
y?"WebkitBackgroundClip":y]=a?c[q][k][y].b:c[q][k][y].a}c=b.activeModel;k=l[m][b.GS.key]!==t?l[m][b.GS.key].split(" "):[];b.activeModel=f;b.GS.liveInstance=null;b.GS.generateValues(null,k,!0);b.activeModel=c;b.GS.liveInstance=null}f.set(l,{silent:!0});l=null;this.set(e);g.replaceWith(e)}}else if("predesign"===f)if(g=c.data.rows,a)for(this.doScroll(h(".tb_element_cid_"+g[0].data("cid"))),k=0,f=g.length;k<f;++k)h(".tb_element_cid_"+g[k].data("cid")).remove();else{q=r.createDocumentFragment();e=[];k=
0;for(f=g.length;k<f;++k)y=n.clone(g[k]),q.appendChild(y[0]),e.push(y);!1!==c.data.prev?this.doScroll(h(".tb_element_cid_"+c.data.prev)).after(q):this.doScroll("visual"===b.mode?h("#themify_builder_content-"+c.data.bid):h("#tb_row_wrapper")).prepend(q);k=0;for(f=e.length;k<f;++k)this.set(e[k]),b.Mixins.Builder.update(e[k])}else if("import"===f){g=h('[data-postid="'+c.data.bid+'"]');c=a?c.data.before:c.data.after;var w=this;c=n.clone(c);g.children().remove();g.prepend(c);c.each(function(){w.set(h(this))})}else"grid_sort"===
f&&(a?h(".tb_element_cid_"+c.cid).remove():(g=h(".tb_element_cid_"+c.before),e=n.clone(c.after),d=c.cid,c.data.next?g.before(e):g.after(e),this.set(e)));d&&(b.ActionBar.hoverCid=null,b.Mixins.Builder.update(h(e)));a?--this.index:++this.index;this.is_working=!1;this.updateUndoBtns();b.toolbar.pageBreakModule.countModules();b.Utils.calculateHeight()}},hasRedo:function(){return this.index<this.stack.length-1},hasUndo:function(){return-1!==this.index},disable:function(){this.btnUndo.classList.add("tb_disabled");
this.btnRedo.classList.add("tb_disabled");this.compactBtn.classList.add("tb_disabled")},updateUndoBtns:function(){var a=this.hasUndo(),b=this.hasRedo();a?this.btnUndo.classList.remove("tb_disabled"):this.btnUndo.classList.add("tb_disabled");b?this.btnRedo.classList.remove("tb_disabled"):this.btnRedo.classList.add("tb_disabled");a||b?this.compactBtn.classList.remove("tb_disabled"):this.compactBtn.classList.add("tb_disabled")},reset:function(){this.stack=[];this.index=-1;this.updateUndoBtns()},do_change:function(a){a.preventDefault();
a.stopPropagation();!1!==this.is_working||a.currentTarget.classList.contains("tb_disabled")||this.changes(a.currentTarget.classList.contains("tb_undo_btn"))}};b.Views.Toolbar=z.View.extend({events:{"click .tb_import":"import","click .tb_load_layout":"loadLayout","click .tb_save_layout":"saveLayout","click .tb_dup_link":"duplicate","click .tb_toolbar_save":"save","click .tb_toolbar_backend_edit a":"save","click .tb_toolbar_close_btn":"panelClose","click .tb_breakpoint_switcher":"breakpointSwitcher",
"click .tb_popular_devices li":"deviceSwitcher","change .tb_change_mode input":"modChange","click .tb_float_minimize":"minimize","click .tb_float_close":"closeFloat","click .tb_toolbar_add_modules":"openFloat","click .tb_custom_css":"addCustomCSS","click .tb_zoom":"zoom","click .tb_toolbar_zoom_menu_toggle":"zoom","click .tb_toolbar_builder_preview":"previewBuilder","click .js-tb_module_panel_acc":"toggleAccordion"},lightboxStorageKey:"tb_module_panel",render:function(){var a=this,d={},c;for(c in themifyBuilder.modules){var e=
r.createElement("div");var f=r.createElement("div");var g=r.createElement("span"),h=r.createElement("strong"),l=r.createElement("a");e.className="tb_module_outer tb-module-"+c;e.dataset.categories=themifyBuilder.modules[c].category;themifyBuilder.modules[c].favorite&&(e.className+=" favorited");f.className="tb_module tb-module-type-"+c;g.className="tb_favorite ti-star tb_disable_sorting";h.className="module_name";h.textContent=themifyBuilder.modules[c].name;l.href="#";l.className="add_module_btn tb_disable_sorting";
l.dataset.type="module";l.title=themifyBuilder.i18n.add_module;f.dataset.moduleSlug=c;themifyBuilder.modules[c].type&&(f.dataset.type=themifyBuilder.modules[c].type);f.appendChild(g);f.appendChild(h);f.appendChild(l);e.appendChild(f);f=themifyBuilder.modules[c].favorite?["favorite"]:themifyBuilder.modules[c].category;g=0;for(h=f.length;g<h;++g)d[f[g]]===t&&(d[f[g]]=r.createDocumentFragment()),d[f[g]].appendChild(e.cloneNode(!0))}f=this.el.getElementsByClassName("tb_module_category_content");for(c=
f.length-1;-1<c;--c)if(e=f[c].getAttribute("data-category"))t!==d[e]?f[c].appendChild(d[e]):f[c].parentNode.style.display="none";f=null;"visual"===b.mode&&u.document.body.appendChild(this.el);d=function(){a.Panel.init();b.undoManager.init();new SimpleBar(a.el.getElementsByClassName("tb_module_panel_modules_wrap")[0]);a.pageBreakModule.init();a.preDesignedRows.init();a.libraryItems.init();a.common.init();setTimeout(function(){a.setMode();a.help.init();setTimeout(function(){a.Revisions.init()},1200);
"visual"===b.mode&&(b.Mixins.Builder.initModuleVisualDrag(".tb_module"),b.Mixins.Builder.initRowGridVisualDrag())},800);"visual"===b.mode&&(a.$el.on("click",".tb_favorite",a.toggleFavoriteModule),a.unload());v.body.on("click",".tb_favorite",a.toggleFavoriteModule);a.draggable();"true"===localStorage.getItem("tb_panel_closed")?a.closeFloat():a.Panel.setFocus()};if("visual"===b.mode)u.jQuery("body").one("themify_builder_ready",d);else d()},setMode:function(){localStorage.getItem("tb_mode")?b.ActionBar.isHoverMode=
null:(b.ActionBar.isHoverMode=!0,this.el.getElementsByClassName("tb_change_mode")[0].getElementsByClassName("tb-checkbox")[0].checked=!0);!0===b.ActionBar.isInit&&b.ActionBar.changeMode()},modChange:function(a){a.stopPropagation();a.currentTarget.classList.contains("tb_mode")?(!0===a.currentTarget.checked?(localStorage.removeItem("tb_mode"),b.ActionBar.isHoverMode=!0):(localStorage.setItem("tb_mode",1),b.ActionBar.isHoverMode=null),b.ActionBar.clear(),b.ActionBar.clearClicked(),b.ActionBar.clearSelected(),
b.ActionBar.changeMode()):a.currentTarget.classList.contains("tb_right_click_mode")?(!0===a.currentTarget.checked?localStorage.removeItem("tb_right_click"):localStorage.setItem("tb_right_click",1),b.ActionBar.initRightClick()):a.currentTarget.classList.contains("tb_padding_dragging_mode")&&(!0===a.currentTarget.checked?localStorage.removeItem("tb_disable_padding_dragging"):localStorage.setItem("tb_disable_padding_dragging",1),b.EdgeDrag.init())},getStorage:function(){var a=localStorage.getItem(this.lightboxStorageKey);
return a?JSON.parse(a):null},updateStorage:function(){var a=this.$el.find("#tb_module_panel"),b=a.position(),c=a.outerHeight();0>=c&&(c=(c=this.getStorage())?c.height:"");a={top:b.top,left:b.left,width:a.outerWidth(),height:c};localStorage.setItem(this.lightboxStorageKey,JSON.stringify(a))},getPanelClass:function(a){return 195>=a?"tb_float_xsmall":270>=a?"tb_float_small":400>=a?"tb_float_medium":"tb_float_large"},_setResponsiveTabs:function(a){for(var d=b.toolbar.el.getElementsByClassName("tb_module_types"),
c=d.length-1;-1<c;--c)"tb_float_xsmall"===a?(d[c].classList.add("tb_ui_dropdown_items"),d[c].parentNode.classList.add("tb_compact_tabs")):(d[c].classList.remove("tb_ui_dropdown_items"),d[c].parentNode.classList.remove("tb_compact_tabs"))},resize:function(){for(var a=this.el.getElementsByClassName("tb_modules_panel_wrap")[0],b=this,c,e,f,g,k=a.getElementsByClassName("tb_resizable"),l,m,q=null,p=function(d){var h=c+g-d.clientX,k=null;if("w"===m||"sw"===m||"nw"===m){var p=a.style.width;k=parseInt(a.style.left)+
parseInt(p)-h}if("w"!==m){if("y"===m||"-y"===m||"sw"===m||"se"===m||"nw"===m||"ne"===m)if(p="-y"===m||"ne"===m||"nw"===m?e+f-d.clientY:f+d.clientY-e,50<=p&&p<=q){if("-y"===m||"ne"===m||"nw"===m)a.style.top=parseInt(a.style.top)+parseInt(a.style.height)-p+"px";a.style.height=p+"px"}"sw"!==m&&"nw"!==m&&(h=g+d.clientX-c)}if("y"!==m&&"-y"!==m){if(500<h||120>h)p=h,h=120>h?120:500,null!==k&&(k=k+p-h);null!==k&&(a.style.left=k+"px");a.style.width=h+"px";d=b.getPanelClass(h);l!==d&&(l&&a.classList.remove(l),
a.classList.add(d),l=d,b._setResponsiveTabs(d))}},y=function(){u.document.body.classList.remove("tb_start_animate");u.document.body.classList.remove("tb_panel_resize");u.document.removeEventListener("mousemove",p,{passive:!0});u.document.removeEventListener("mouseup",y,{passive:!0});c=g=m=l=null;b.updateStorage()},w=k.length-1;-1<w;--w)k[w].addEventListener("mousedown",function(b){1===b.which&&(u.document.body.classList.add("tb_start_animate"),u.document.body.classList.add("tb_panel_resize"),m=this.dataset.axis,
c=b.clientX,e=b.clientY,q=h(x).height()-50,f=parseInt(h(a).outerHeight(),10),g=parseInt(h(a).outerWidth(),10),u.document.addEventListener("mousemove",p,{passive:!0}),u.document.addEventListener("mouseup",y,{passive:!0}))},{passive:!0})},setFloat:function(){var a=this.Panel.el.find("#tb_module_panel");a[0].classList.add("tb_panel_floating");var b=this.getStorage();b&&(a[0].style.width=b.width+"px",a[0].style.height=b.height+"px");b=this.getPanelClass(a.width());a[0].classList.add(b);this._setResponsiveTabs(b)},
removeFloat:function(){this.Panel.el.find("#tb_module_panel").css({top:"",width:"",height:"",left:"",right:"",bottom:""}).removeClass("tb_panel_floating tb_float_xsmall tb_float_small tb_float_medium tb_float_large tb_is_minimize")},draggable:function(){var a=this.$el.find("#tb_module_panel"),d=this;if(!n.Lightbox.dockMode.get()){a[0].classList.add("tb_panel_floating");var c=this.getStorage(),e=null;if(c){for(var f in c)a[0].style[f]=c[f]+"px";e=c.width}else e=a.width();c=this.getPanelClass(e);a[0].classList.add(c);
this._setResponsiveTabs(c)}a.draggable({handle:".tb_drag_handle",cancel:".tb_module_types",scroll:!0,start:function(a,c){u.document.body.classList.add("tb_panel_drag");d.setFloat();n.Lightbox.dockMode.get()&&(n.Lightbox.dockMode.close(),setTimeout(function(){b.Utils._onResize(!0)},100))},drag:function(a,c){"visual"===b.mode&&n.Lightbox.dockMode.drag(a,c)},stop:function(a,c){u.document.body.classList.remove("tb_panel_drag");n.Lightbox.dockMode.drag(a,c);if(n.Lightbox.dockMode.get())d.removeFloat(),
d._setResponsiveTabs(!1);else{var e=h(u).height()-30,f=c.position.top,g={};0>f?g.top=0:f>e&&(g.top=e);for(var k in g)c.helper[0].style[k]=g[k]+"px";d.updateStorage()}"visual"===b.mode&&h(r).triggerHandler("mouseup")}});this.resize()},minimize:function(a){a.preventDefault();a.stopPropagation();a=h(a.currentTarget).closest("#tb_module_panel");if(a.hasClass("tb_is_minimize")){a.removeClass("tb_is_minimize");var d=this.getStorage();a.css("height",d?d.height:"")}else a.addClass("tb_is_minimize");"visual"===
b.mode&&h(r).triggerHandler("mouseup")},"import":function(a){a.preventDefault();a.stopPropagation();var d=a.currentTarget.getAttribute("data-component"),c=u.document.getElementsByTagName("body")[0],e={contructor:"file"!==d,dataType:"json",data:{action:"builder_import",type:d}};if("file"!==d||confirm(themifyBuilder.i18n.importFileConfirm))if("file"===d){var f=u.document.getElementById("tb_import_filestb_plupload_browse_button");null===f?(f=r.createElement("input"),a=r.createElement("div"),d=r.createElement("span"),
a.id="tb_import_filestb_plupload_upload_ui",a.style.display="none",f.type="button",f.id="tb_import_filestb_plupload_browse_button",d.className="ajaxnonceplu",d.id=themifyBuilder.import_nonce,a.appendChild(f),a.appendChild(d),c.appendChild(a),b.Utils.builderPlupload("",f.parentNode)):f.click()}else{n.Lightbox.$lightbox[0].style.display="none";f=h(a.currentTarget.closest("ul"));var g=f.offset(),k=g.top+f.height()-40;v.body.off("themify_builder_lightbox_close.import");f.addClass("tb_current_menu_selected");
null!==b.Forms.LayoutPart.id&&(k-=x.pageYOffset+60);n.Lightbox.open(e,function(){c.classList.add("tb_standalone_lightbox")},function(){this.$lightbox[0].classList.add("tb_import_post_lightbox");this.setStandAlone(g.left,k,!0);v.body.one("themify_builder_lightbox_close.import",function(){c.classList.remove("tb_standalone_lightbox");n.Lightbox.$lightbox[0].classList.remove("tb_import_post_lightbox");f.removeClass("tb_current_menu_selected");c=null});h("#tb_submit_import_form",n.Lightbox.$lightbox).one("click",
function(a){a.preventDefault();n.LiteLightbox.confirm(themifyBuilder.i18n.dialog_import_page_post,function(a){h.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"builder_import_submit",nonce:themifyBuilder.tb_load_nonce,data:b.Forms.serialize("tb_options_import"),importType:"no"===a?"replace":"append",importTo:themifyBuilder.post_ID},beforeSend:function(a){n.showLoader("show")},success:function(a){a.builder_data!==t?b.Forms.reLoad(a,themifyBuilder.post_ID):n.showLoader("error");
n.Lightbox.close()}})},{buttons:{no:{label:ThemifyConstructor.label.replace_builder},yes:{label:ThemifyConstructor.label.append_builder}}})})})}},unload:function(){"visual"===b.mode&&r.head.insertAdjacentHTML("afterbegin",'<base target="_parent">');u.onbeforeunload=function(){return b.editing||!b.hasChanged&&!b.undoManager.hasUndo()?null:"Are you sure"}},panelClose:function(a){a.preventDefault();u.location.reload(!0)},loadLayout:function(a){a.preventDefault();a.stopPropagation();var d=this,c=u.document.body,
e=h(a.currentTarget.closest("ul"));a=d.layoutsList?{loadMethod:"html",data:d.layoutsList}:{data:{action:"tb_load_layout"}};n.Lightbox.$lightbox[0].style.display="none";e.addClass("tb_current_menu_selected");v.body.off("themify_builder_lightbox_close.loadLayout");n.Lightbox.open(a,function(){c.classList.add("tb_load_layout_active");c.classList.add("tb_standalone_lightbox")},function(){function a(){k.on("click.loadLayout",".layout_preview img",function(a){a.preventDefault();a.stopPropagation();var c=
h(this).closest(".layout_preview");n.LiteLightbox.confirm(themifyBuilder.i18n.confirm_template_selected,function(a){var e=c.closest("ul").data("group"),f=function(c){if("no"!==a){var e="visual"!==b.mode?r.getElementById("tb_row_wrapper"):r.getElementsByClassName("themify_builder_content-"+themifyBuilder.post_ID)[0],e=b.Mixins.Builder.toJSON(e),f=[],g;for(g in e)f.push(e[g]);e=null;for(g in c)f.push(c[g]);c=f;f=null}!0!==d.is_set&&h.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"set_layout_action",
nonce:themifyBuilder.tb_load_nonce,mode:"no"!==a?1:0,id:themifyBuilder.post_ID},success:function(){d.is_set=!0}});b.Forms.reLoad(c,themifyBuilder.post_ID);n.Lightbox.close()};if("pre-designed"===e){n.showLoader("show");var g=c.data("slug"),k=themifyBuilder.paths.layout_template.replace("{SLUG}",g);if(!b.layouts_selected)b.layouts_selected={};else if(b.layouts_selected[g]){b.Utils.clearElementId(b.layouts_selected[g]);f(JSON.parse(b.layouts_selected[g]));return}h.get(k,null,null,"text").done(function(a){b.layouts_selected[g]=
a;f(JSON.parse(a))}).fail(function(a,b,c){n.LiteLightbox.alert(ThemifyConstructor.label.layout_error.replace("{FILE}",k))}).always(function(){n.showLoader()})}else h.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_set_layout",nonce:themifyBuilder.tb_load_nonce,layout_slug:c.data("slug"),layout_group:e,mode:"no"!==a?1:0},beforeSend:function(){"visual"===b.mode&&n.showLoader("show")},success:function(a){a.data?(a.gs&&(b.GS.styles=h.extend(!0,{},a.gs,b.GS.styles)),f(a.data),
n.showLoader()):(n.showLoader("error"),alert(a.msg),n.Lightbox.close())}})},{buttons:{no:{label:ThemifyConstructor.label.layout_replace},yes:{label:ThemifyConstructor.label.layout_append}}})})}function g(){a();var d=l.find(".layout_preview_list");m.show().find("li").on("click",function(a){a.preventDefault();a.stopPropagation();this.classList.contains("current")||(a=d,this.classList.contains("all")||(d.hide(),a=d.filter("[data-category"+(""!==themifyBuilder.paths.layouts_index?"*":"")+'="'+h(this).text()+
'"]')),a.show(),q(a),h(this).addClass("current").siblings().removeClass("current"),m.parent().find(".tb_ui_dropdown_label").html(h(this).text()));b.Utils.hideOnClick(m)});m.find(".tb_selected_cat").click();k.find("#tb_layout_search").on("keyup",function(){var a=h.trim(h(this).val()),b=d;""!==a&&(b=m.find("li.all"),b[0].classList.contains("current")||b.click(),d.hide(),b=d.find(".layout_title:contains("+a+")").closest(".layout_preview_list"));b.show();q(b)})[0].focus();new SimpleBar(k[0]);new SimpleBar(m[0]);
v.body.one("themify_builder_lightbox_close.loadLayout",function(){k.off("click.loadLayout")[0].classList.remove("tb_predesigned_lightbox");l.find("#tb_layout_search").off("keyup");l=k=null;c.classList.remove("tb_load_layout_active");c.classList.remove("tb_standalone_lightbox");e.removeClass("tb_current_menu_selected")})}var k=this.$lightbox,l=k.find("#tb_tabs_pre-designed");if(0===l.length)c.classList.remove("tb_load_layout_active"),c.classList.remove("tb_standalone_lightbox"),e.removeClass("tb_current_menu_selected"),
a();else{k[0].classList.add("tb_predesigned_lightbox");this.setStandAlone(u.innerWidth/2,(u.document.documentElement.clientHeight-k.height())/2,!0);var m=l.find(".tb_ui_dropdown_items"),q=function(a){a.each(function(a){0===a%4?this.classList.add("layout-column-break"):this.classList.remove("layout-column-break")})};if(d.layoutsList)g();else{var p=function(a,b){for(var c={},e=r.createDocumentFragment(),f=r.createDocumentFragment(),p=0,n=a.length;p<n;++p){var y=r.createElement("li"),w=r.createElement("div"),
u=r.createElement("div"),v=r.createElement("img"),x=r.createElement("div"),B=r.createElement("div");y.className="layout_preview_list";y.dataset.category=a[p].category;w.className="layout_preview";w.dataset.id=a[p].id;w.dataset.slug=a[p].slug;u.className="thumbnail";v.src=a[p].thumbnail;v.alt=a[p].title;v.title=a[p].title;x.className="layout_action";B.className="layout_title";B.textContent=a[p].title;x.appendChild(B);if(t!==a[p].url){var B=r.createElement("a"),z=r.createElement("i");B.className="layout-preview-link themify_lightbox";
B.href=a[p].url;B.target="_blank";B.title=themifyBuilder.i18n.preview;z.className="ti-search";B.appendChild(z);x.appendChild(B)}u.appendChild(v);w.appendChild(u);w.appendChild(x);y.appendChild(w);e.appendChild(y);if(a[p].category)for(y=String(a[p].category).split(","),w=0,u=y.length;w<u;++w)""!==y[w]&&1!==c[y[w]]&&(v=r.createElement("li"),v.textContent=y[w],f.appendChild(v),c[y[w]]=1,y[w]===b&&(v.className="tb_selected_cat"))}m[0].appendChild(f);l[0].getElementsByClassName("tb_layout_lists")[0].appendChild(e);
e=f=c=null;k.find(".tb_tab").each(function(){q(h(this).find(".layout_preview_list"))});d.layoutsList=k[0].getElementsByClassName("tb_options_tab_wrapper")[0].cloneNode(!0);g()};h.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_load_predesigned_layouts",nonce:themifyBuilder.tb_load_nonce,src:themifyBuilder.paths.layouts_index,id:themifyBuilder.post_ID},beforeSend:function(){setTimeout(function(){n.showLoader("show")},500)},success:function(a){var c=JSON.parse(a.data);
if(""===themifyBuilder.paths.layouts_index){var d=Object.keys(c);b.layouts_selected={};for(var e=d.length-1;-1<e;--e)b.layouts_selected[c[d[e]].slug]=c[d[e]].data}p(c,a.selected);n.showLoader("spinhide")},error:function(){n.LiteLightbox.alert(h("#tb_load_layout_error",l).show().text());n.showLoader("spinhide")}})}}})},saveLayout:function(a){a.preventDefault();a.stopPropagation();var d={contructor:!0,loadMethod:"html",save:{},data:{save_as_layout:{options:[{id:"layout_title_field",type:"text",label:ThemifyConstructor.label.title},
{id:"layout_img_field",type:"image",label:ThemifyConstructor.label.image_preview},{id:"layout_img_field_id",type:"hidden"},{id:"postid",type:"hidden",value:themifyBuilder.post_ID}]}}},c=h(a.currentTarget.closest("ul"));c.addClass("tb_current_menu_selected");n.Lightbox.$lightbox[0].style.display="none";n.Lightbox.open(d,function(){u.document.body.classList.add("tb_standalone_lightbox")},function(){var d=this.$lightbox;d.find(".builder_save_button").one("click",function(a){a.stopPropagation();a.preventDefault();
h.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_save_custom_layout",nonce:themifyBuilder.tb_load_nonce,form_data:b.Forms.serialize(d[0])},beforeSend:function(){n.showLoader("show")},success:function(a){"success"===a.status?(n.showLoader(),n.Lightbox.close()):(n.showLoader("error"),alert(a.msg))}})});d.addClass("tb_savead_lightbox");this.setStandAlone(a.clientX,a.clientY);v.body.one("themify_builder_lightbox_close",function(){d.removeClass("tb_savead_lightbox").find(".builder_save_button").off("click");
u.document.body.classList.remove("tb_standalone_lightbox");c.removeClass("tb_current_menu_selected");d=null})})},duplicate:function(a){function d(){c.Revisions.ajax({action:"tb_duplicate_page",tb_is_admin:"visual"!==b.mode},function(a){a&&(u.location.href=h("<div/>").html(a).text())})}a.preventDefault();a.stopPropagation();var c=this;confirm(themifyBuilder.i18n.confirm_on_duplicate_page)&&b.Utils.saveBuilder(d)},addCustomCSS:function(a){a.preventDefault();a.stopPropagation();null!==b.activeModel&&
ThemifyConstructor.saveComponent(!0);null===A&&(A=themifyBuilder.custom_css,delete themifyBuilder.custom_css);A||(A="");var d={contructor:!0,loadMethod:"html",save:{},data:{css:{options:[{id:"custom_css",type:"textarea",rows:17,"class":"fullwidth"},{id:"custom_css_m",type:"message",label:"",comment:ThemifyConstructor.label.cus_css_m},{id:"postid",type:"hidden",value:themifyBuilder.post_ID}]}}},c=a.currentTarget;c.classList.add("tb_tooltip_active");n.Lightbox.$lightbox[0].style.display="none";u.document.body.classList.add("tb_standalone_lightbox");
n.Lightbox.open(d,null,function(){var d=this.$lightbox,f=d[0].querySelector("#custom_css");f.value=A;"visual"===b.mode&&f.addEventListener("input",function(){b.toolbar.updateCustomCSS(this.value.trim())});d.addClass("tb_custom_css_lightbox").find(".builder_save_button").one("click",function(a){a.stopImmediatePropagation();a.preventDefault();A=f.value.trim();n.Lightbox.close()});this.setStandAlone(a.clientX,a.clientY);v.body.one("themify_builder_lightbox_close",function(){A||(A="",c.classList.add("tb_tooltip_active"));
var a=r.getElementById("tb_custom_css_tmp");a&&(a.innerHTML=A);c=null;u.document.body.classList.remove("tb_standalone_lightbox")})})},updateCustomCSS:function(a){var b=r.getElementById("tb_custom_css_tmp");null===b&&(b=r.createElement("style"),b.type="text/css",b.id="tb_custom_css_tmp",r.head.appendChild(b));b.innerHTML=a},Revisions:{init:function(){b.toolbar.$el.find(".tb_revision").on("click",this.revision.bind(this))},revision:function(a){a.preventDefault();a.stopPropagation();a.currentTarget.classList.contains("tb_save_revision")?
this.saveEvent():this.load(a)},load:function(a){var b=this,c=h("body",u.document),e=h(a.currentTarget.closest("ul")),f=e.offset();e.addClass("tb_current_menu_selected");n.Lightbox.$lightbox[0].style.display="none";v.body.off("themify_builder_lightbox_close.revisions");b.ajax({action:"tb_load_revision_lists"},function(a){n.Lightbox.open({contructor:!0,loadMethod:"html",data:{revision:{html:h(a)[0]}}},function(){c.addClass("tb_standalone_lightbox")},function(){this.$lightbox[0].classList.add("tb_revision_lightbox");
this.setStandAlone(f.left,f.top,!0);c.on("click.revision",".js-builder-restore-revision-btn",b.restore.bind(b)).on("click.revision",".js-builder-delete-revision-btn",b["delete"].bind(b));v.body.one("themify_builder_lightbox_close.revisions",function(){e.removeClass("tb_current_menu_selected");c.off(".revision").removeClass("tb_standalone_lightbox");n.Lightbox.$lightbox[0].classList.remove("tb_revision_lightbox");c=null})})})},ajax:function(a,d){a=h.extend({},a,{tb_load_nonce:themifyBuilder.tb_load_nonce,
postid:themifyBuilder.post_ID,sourceEditor:"visual"===b.mode?"frontend":"backend"});return h.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:a,beforeSend:function(){n.showLoader("show")},complete:function(){n.showLoader("hide")},success:function(a){h.isFunction(d)&&d.call(this,a)}})},saveEvent:function(a){var b=this;n.LiteLightbox.prompt(themifyBuilder.i18n.enterRevComment,function(c){null!==c&&b.saveRevision(c,a)})},saveRevision:function(a,d){var c=b.Utils.saveBuilder(null,0,!0);this.ajax({action:"tb_save_revision",
rev_comment:a,data:JSON.stringify(b.Utils.clear(c.data)),postid:c.id},d)},restore:function(a){a.preventDefault();a.stopPropagation();var d=h(a.currentTarget).data("rev-id"),c=this,e=function(){c.ajax({action:"tb_restore_revision_page",revid:d},function(a){a.builder_data?(b.Forms.reLoad(a,themifyBuilder.post_ID),n.Lightbox.close()):(n.showLoader("error"),alert(a.data))})};n.LiteLightbox.confirm(themifyBuilder.i18n.confirmRestoreRev,function(a){"yes"===a?c.save(e):e()},{buttons:{no:{label:ThemifyConstructor.label.save_no},
yes:{label:ThemifyConstructor.label.save}}})},"delete":function(a){a.preventDefault();a.stopPropagation();if(confirm(themifyBuilder.i18n.confirmDeleteRev)){var b=h(a.currentTarget);a=b.data("rev-id");this.ajax({action:"tb_delete_revision",revid:a},function(a){a.success?b.closest("li").remove():(n.showLoader("error"),alert(a.data))})}}},save:function(a){a.preventDefault();a.stopPropagation();var d=0<h(a.currentTarget).closest(".tb_toolbar_backend_edit").length?h(a.currentTarget).prop("href"):!1;themifyBuilder.is_gutenberg_editor&&
!1!==d?(b.undoManager.reset(),b._backendSwitchFrontend(d)):b.Utils.saveBuilder(function(a,e){"success"!==e?alert(themifyBuilder.i18n.errorSaveBuilder):!1!==d&&("visual"===b.mode?(sessionStorage.setItem("focusBackendEditor",!0),u.location.href=d):(b.undoManager.reset(),b._backendSwitchFrontend(d)))})},libraryItems:{items:[],is_init:null,init:function(){h(r).one("tb_panel_tab_tb_module_panel_library_wrap",this.load.bind(this))},load:function(a,d){var c=this;d=h(d).find(".tb_module_panel_library_wrap");
d.addClass("tb_busy");h.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"tb_get_library_items",nonce:themifyBuilder.tb_load_nonce,part:"all",pid:themifyBuilder.post_ID},success:function(a){c.setData(a);d.removeClass("tb_busy");c.is_init=!0},error:function(){d.removeClass("tb_busy");n.showLoader("error");c.init();b.toolbar.$el.find(".tb_library_item_list").html("<h3>Failed to load Library Items.</h3>")}})},get:function(a,d,c){if(this.items[a]!==t)c(this.items[a]);else{var e=this;h.ajax({type:"POST",
url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_get_library_item",nonce:themifyBuilder.tb_load_nonce,type:d,id:a},beforeSend:function(a){n.showLoader("show")},success:function(d){d.content.gs&&(b.GS.styles=h.extend(!0,{},d.content.gs,b.GS.styles),delete d.content.gs);n.showLoader("hide");"success"===d.status?(e.items[a]=d.content,c(d.content)):n.showLoader("error")},error:function(){n.showLoader("error")}})}},template:function(a){for(var b="",c=0,e=a.length;c<e;++c){var f="part";-1!==
a[c].post_type.indexOf("_rows",5)?f="row":-1!==a[c].post_type.indexOf("_module",5)&&(f="module");b+='<div class="tb_library_item tb_item_'+f+'" data-type="'+f+'" data-id="'+a[c].id+'">';b+='<div class="tb_library_item_inner"><span>'+a[c].post_title+"</span>";b+='<a href="#" class="remove_item_btn tb_disable_sorting" title="Delete"></a></div></div>'}return b},bindEvents:function(a){"visual"===b.mode?(b.Mixins.Builder.initModuleVisualDrag(".tb_item_module,.tb_item_part"),b.Mixins.Builder.initRowVisualDrag(".tb_item_row")):
(b.Mixins.Builder.initRowDraggable(b.toolbar.$el.find(".tb_module_panel_library_wrap").first(),".tb_item_row"),b.Mixins.Builder.initModuleDraggable(b.toolbar.$el.find(".tb_library_item_list").first(),".tb_item_module,.tb_item_part"));if(b.toolbar.common.btn||"visual"===b.mode&&(b.toolbar.common.is_init||a))b.Mixins.Builder.initRowDraggable(b.toolbar.common.btn.find(".tb_module_panel_library_wrap").first(),".tb_item_row"),b.Mixins.Builder.initModuleDraggable(b.toolbar.common.btn.find(".tb_library_item_list").first(),
".tb_item_module,.tb_item_part")},setData:function(a){a='<span class="tb_no_content" style="display:none">No library content found.</span>'+this.template(a);var d=h(".tb_library_item_list");"visual"===b.mode&&(d=d.add(b.toolbar.$el.find(".tb_library_item_list")));for(var d=d.get(),c=d.length-1;-1<c;--c)d[c].insertAdjacentHTML("afterbegin",a),new SimpleBar(d[c]),d[c].previousElementSibling.getElementsByClassName("current")[0].click();v.body.on("click",".remove_item_btn",this["delete"].bind(this));
if("visual"===b.mode)b.toolbar.$el.on("click",".remove_item_btn",this["delete"].bind(this));this.bindEvents()},"delete":function(a){a.preventDefault();a.stopPropagation();var d=h(a.currentTarget).closest(".tb_library_item"),c=d.data("type");if(confirm(themifyBuilder.i18n[c+"LibraryDeleteConfirm"])){var e=d.data("id");h.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"tb_remove_library_item",nonce:themifyBuilder.tb_load_nonce,id:e},beforeSend:function(a){n.showLoader("show")},success:function(a){n.showLoader("hide");
if(a){var f=0<d.closest("#"+b.toolbar.common.btn.prop("id")).length?b.toolbar.$el.find(".tb_item_"+c+'[data-id="'+e+'"]'):b.toolbar.common.btn.find(".tb_item_"+c+'[data-id="'+e+'"]');d=d.add(f);if("part"===c){d=d.add(h(".themify_builder_content-"+e).closest(".active_module"));for(var f=ThemifyConstructor.layoutPart.data,k=f.length-1;-1<k;--k)if(f[k].post_name===a){ThemifyConstructor.layoutPart.data.splice(k,1);break}}a=d.parent().siblings(".tb_library_types").find(".current");d.remove();a.trigger("click")}else n.showLoader("error")},
error:function(){n.showLoader("error")}})}}},preDesignedRows:{is_init:null,rows:{},items:{},currentCategory:"All",categories:{All:{isLoaded:!1}},loadingItems:!1,init:function(){setTimeout(function(){var a=u.document.createElement("meta"),b=u.document.head,c=[{href:"//themify.me",rel:"dns-prefetch preconnect"},{href:"//fonts.googleapis.com",rel:"dns-prefetch preconnect"},{href:"//maps.googleapis.com",rel:"dns-prefetch preconnect"},{href:themifyBuilder.paths.rows_index,rel:"prefetch"},{href:themifyBuilder.paths.layouts_index,
rel:"prefetch"}];a.content="on";a.setAttribute("http-equiv","x-dns-prefetch-control");b.appendChild(a);for(var e in c)a=u.document.createElement("link"),a.setAttribute("crossorigin",!0),a.rel=c[e].rel,a.href=c[e].href,b.appendChild(a)},7E3);h(r).one("tb_panel_tab_tb_module_panel_rows_wrap",this.load.bind(this))},load:function(a,d){var c=this;d=h(d).find(".tb_predesigned_rows_list");d.addClass("tb_busy");h.getJSON(themifyBuilder.paths.rows_index).done(function(a){c.setData(a,d)}).fail(function(a,f,
g){c.setData({},d);c.is_init=null;n.showLoader("error");b.toolbar.$el.find(".tb_predesigned_rows_container").append("<h3>"+ThemifyConstructor.label.rows_fetch_error+"</h3>");h(r).one("tb_panel_tab_tb_module_panel_rows_wrap",c.load.bind(c))})},masonry:function(a){for(var b=a.querySelectorAll('.predesigned_row:not([data-masonry="done"])'),c=b.length,e=0;e<c;e++){var f=b[e],g=parseInt(x.top.getComputedStyle(a).getPropertyValue("grid-row-gap")),h=parseInt(x.top.getComputedStyle(a).getPropertyValue("grid-auto-rows"));
if(!isNaN(g)&&!isNaN(h)){var l=f.getElementsByClassName("tb_predesigned_rows_image")[0].getBoundingClientRect().height+f.getElementsByClassName("tb_predesigned_rows_title")[0].getBoundingClientRect().height,g=Math.ceil((l+g)/(h+g));f.style.gridRowEnd="span "+g;5<g&&(f.dataset.masonry="done")}}},loadItems:function(a){this.loadingItems=!0;var b=this.currentCategory,c=r.createDocumentFragment();if(!0===this.categories.All.isLoaded||!0===this.categories[b].isLoaded)return this.loadingItems=!1,c;for(var e=
0,f=Object.keys(this.items),g=f.length,h=0;h<g&&!(10<=e&&t==a);h++){var l=this.items[f[h]],m=""!==a?new RegExp(a,"i"):!1;if(m&&m.test(l.title)){var q=l.category.split(",");if("All"===b||-1!==q.indexOf(b)){delete this.items[f[h]];for(var m="",p=0,n=q.length;p<n;++p)m+=this.categories[q[p]].hash;var q=r.createElement("div"),p=r.createElement("figure"),n=r.createElement("div"),w=new Image,u=r.createElement("a");q.className="predesigned_row "+m;q.setAttribute("data-slug",l.slug);p.className="tb_predesigned_rows_image";
n.className="tb_predesigned_rows_title";n.textContent=w.alt=w.title=l.title;w.src=l.thumbnail===t||""===l.thumbnail?"https://placeholdit.imgix.net/~text?txtsize=24&txt="+encodeURI(l.title)+"&w=181&h=77":l.thumbnail;w.width=500;w.height=300;u.href="#";u.className="add_module_btn tb_disable_sorting";u.dataset.type="predesigned";p.appendChild(w);p.appendChild(u);q.appendChild(p);q.appendChild(n);c.appendChild(q);++e}}}this.categories[b].isLoaded=10>e&&t===a;return c},setData:function(a){this.items=a;
a=null;var d=[];a=r.createDocumentFragment();for(var c=0,e=this.items.length;c<e;++c)for(var f=this.items[c].category.split(","),g=0,k=f.length;g<k;++g){var l=v.hash(f[g]);-1===d.indexOf(f[g])&&(d.push(f[g]),this.categories[f[g]]={hash:"tb"+l})}d.sort();c=0;for(e=d.length;c<e;++c)f=r.createElement("li"),f.setAttribute("data-slug",v.hash(d[c])),f.textContent=d[c],a.appendChild(f);var d=h(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items"),e=h(".tb_predesigned_rows_container"),m=this;
"visual"===b.mode&&(e=e.add(b.toolbar.$el.find(".tb_predesigned_rows_container")),d=d.add(b.toolbar.$el.find(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items")));d=d.get();e=e.get();f=this.loadItems();for(c=d.length-1;-1<c;--c)d[c].appendChild(a.cloneNode(!0)),e[c].appendChild(f.cloneNode(!0)),g=e[c].getElementsByTagName("img"),0<g.length?(g=g[g.length-1],h(g).one("load",function(){m.initCallback(h(this).closest(".tb_predesigned_rows_container")[0],!0)})):m.initCallback(e[c],!0);
v.body.on("click",".tb_module_panel_container .tb_ui_dropdown_items li",this.filter.bind(this));if("visual"===b.mode)h("body",u.document).on("click",".tb_module_panel_container .tb_ui_dropdown_items li",this.filter.bind(this))},initCallback:function(a,d){if(d){var c=new SimpleBar(a);var e=a.getElementsByClassName("simplebar-content");c=e.length?c.getScrollElement():a;c.addEventListener("scroll",this.scrollLoadMore.bind(this),{passive:!0});this.is_init=!0}e=h(a);"visual"===b.mode?b.Mixins.Builder.initRowVisualDrag(".predesigned_row"):
b.Mixins.Builder.initRowDraggable(b.toolbar.$el.find(".tb_predesigned_rows_container").first(),".predesigned_row");b.toolbar.common.is_init&&b.Mixins.Builder.initRowDraggable(b.toolbar.common.btn.find(".tb_predesigned_rows_container").first(),".predesigned_row");d&&(new SimpleBar(e.closest(".tb_module_panel_tab").find(".tb_ui_dropdown_items")[0]),e.closest(".tb_predesigned_rows_list").removeClass("tb_busy").closest(".tb_module_panel_tab").find(".tb_ui_dropdown").css("visibility","visible"));h(a).parents("#tb_module_panel_dropdown").length&&
(e=a.getElementsByClassName("simplebar-content"),this.masonry(e.length?e[0]:a));this.loadingItems=!1},get:function(a,d){n.showLoader("show");if(this.rows[a]!==t)"function"===typeof d&&d(this.rows[a]);else{var c=this;h.getJSON(themifyBuilder.paths.row_template.replace("{SLUG}",a)).done(function(e){b.Utils.clearElementId(e);c.rows[a]=e;-1!==JSON.stringify(e).indexOf(b.GS.key)?h.getJSON(themifyBuilder.paths.row_template.replace("{SLUG}",a+"-gs")).done(function(a){var c={},f;for(f in a)a[f]["class"]!==
t?c[a[f]["class"]]=a[f]:c[f]=a[f];b.GS.setImport(c,d,e)}).fail(function(a,b,c){"function"===typeof d&&d(e)}):"function"===typeof d&&d(e)}).fail(function(a,b,c){n.showLoader("error");alert(ThemifyConstructor.label.row_fetch_error)})}},filter:function(a){a.preventDefault();a.stopPropagation();a=h(a.currentTarget);var d=a.data("slug"),c=a.closest(".tb_module_panel_tab"),e=c.find(".tb_ui_dropdown_label"),f=c.find(".predesigned_row"),g=a.text();this.currentCategory=g;this.addNewItems();e.text(g);c.find(".tb_module_panel_search_text").val("");
var k=d?"tb"+d:!1;e.data("active",k);a.addClass("current").siblings().removeClass("current");f.each(function(){!k||this.classList.contains(k)?h(this).show():h(this).hide()}).filter(":visible").each(function(a){0===(a+1)%4?h(this).addClass("tb_column_break"):h(this).removeClass("tb_column_break")});b.Utils.hideOnClick(c.find(".tb_ui_dropdown_items"))},addNewItems:function(a){this.currentCategory=t!==a?"All":this.currentCategory;if(!this.categories[this.currentCategory].isLoaded){var d=this,c=h(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items"),
e=h(".tb_predesigned_rows_container");"visual"===b.mode&&(e=e.add(b.toolbar.$el.find(".tb_predesigned_rows_container")),c=c.add(b.toolbar.$el.find(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items")));c=c.get();e=e.get();a=d.loadItems(a);for(c=c.length-1;-1<c;--c){var f=e[c].getElementsByClassName("simplebar-content");f.length&&(e[c]=f[0]);e[c].appendChild(a.cloneNode(!0));f=e[c].getElementsByTagName("img");0<f.length?(f=f[f.length-1],h(f).one("load",function(){d.initCallback(h(this).closest(".tb_predesigned_rows_container")[0])})):
d.initCallback(e[c])}}},scrollLoadMore:function(a){this.loadingItems||!0===this.categories[this.currentCategory].isLoaded||(a=a.target,a=Math.max(a.scrollHeight-(a.scrollTop+a.offsetHeight),0),0<a&&200>=a&&this.addNewItems())}},pageBreakModule:{init:function(){"visual"===b.mode?b.Mixins.Builder.initRowVisualDrag(".tb_page_break_module"):b.Mixins.Builder.initRowDraggable(b.toolbar.$el.find(".tb_module_panel_modules_wrap").first(),".tb_page_break_module")},countModules:function(){for(var a="visual"===
b.mode?r.getElementsByClassName("module-page-break"):r.getElementsByClassName("tb-page-break"),d=a.length-1;-1<d;--d)"visual"===b.mode?a[d].getElementsByClassName("page-break-order")[0].textContent=d+1:a[d].getElementsByClassName("page-break-overlay")[0].textContent="PAGE BREAK - "+(d+1)},get:function(){return[{cols:[{grid_class:"col-full first last",modules:[{mod_name:"page-break"}]}],column_alignment:"col_align_middle",styling:{custom_css_row:"tb-page-break"}}]}},common:{btn:null,is_init:null,clicked:null,
init:function(){var a=r.createElement("div"),d=b.toolbar.$el;a.className="tb_modules_panel_wrap";a.id="tb_module_panel_dropdown";this.btn=h(a);a=null;d=d.add(n.Lightbox.$lightbox);"visual"!==b.mode&&null!==r.querySelector(".edit-post-layout__content")?h(".edit-post-layout__content")[0].appendChild(this.btn[0]):v.body[0].appendChild(this.btn[0]);var c=this;if("visual"===b.mode)b.toolbar.$el.find(".tb_module_types li").on("click",this.tabs.bind(this));v.body.on("click",".tb_module_types li",this.tabs.bind(this)).on("click",
".tb_column_btn_plus",this.show.bind(this));d.on("click",".tb_clear_input",this.clear);b.toolbar.$el.find(".tb_module_panel_search_text").on("keyup",this.search.bind(this));this.btn.on("click",".add_module_btn,.js-tb_module_panel_acc",function(a){a.preventDefault();a.stopPropagation();var d=null,e=this.classList,k=this.dataset.type;c.clicked||(c.clicked=b.Instances.Builder[b.builderIndex].newRowAvailable(1,!0),d=!0);if("module"===k){var l=c.clicked.hasClass("tb_module_btn_plus")?c.clicked.parent():
c.clicked.closest(".module_column").find(".tb_holder").last();b.toolbar.Panel.add_module(a,l)}else if("row"===k)l=c.clicked.hasClass("tb_module_btn_plus")?c.clicked.parent():c.clicked.closest(".module_column").find(".tb_holder").first(),b.toolbar.Panel.click_add_sub_row(a,l);else if(e.contains("js-tb_module_panel_acc"))b.toolbar.toggleAccordion(a);else if("predesigned"===k||"page_break"===k)l=c.clicked.closest(".module_row"),"page_break"===k?b.toolbar.Panel.click_add_page_break(a,l):b.toolbar.preDesignedRows.get(h(a.currentTarget).closest(".predesigned_row").data("slug"),
function(a){b.Mixins.Builder.rowDrop(a,d?l:h("<div>").insertAfter(l),!0)});e.contains("js-tb_module_panel_acc")||c.hide(!0)}).on("keyup",".tb_module_panel_search_text",this.search.bind(this)).on("click",".tb_clear_input",this.clear)},run:function(){var a=b.toolbar.$el.find("#tb_module_panel");this.btn[0].insertAdjacentHTML("beforeend",a[0].innerHTML);this.btn.find(".tb_module_outer").show();a=this.btn.find(".tb_module_types").closest("div")[0];a.parentNode.parentNode.insertBefore(a,a.parentNode);
a.parentNode.removeChild(a.nextElementSibling);a=this.btn.find(".tb_compact_tabs").removeClass("tb_compact_tabs").find(".tb_ui_dropdown_items").removeClass("tb_ui_dropdown_items");this.btn.find(".tb_module_panel_search_text").val("");new SimpleBar(this.btn.find(".tb_module_panel_modules_wrap")[0]);a.find(".simplebar-scroll-content").length&&(new SimpleBar(a[0])).recalculate();b.Mixins.Builder.initModuleDraggable(this.btn,".tb_module");b.Mixins.Builder.initModuleDraggable(this.btn.find(".tb_rows_grid").first(),
".tb_row_grid");b.Mixins.Builder.initRowDraggable(this.btn,".tb_page_break_module");if(b.toolbar.libraryItems.is_init||"visual"===b.mode)b.Mixins.Builder.initModuleDraggable(this.btn.find(".tb_library_item_list").first(),".tb_item_module,.tb_item_part"),b.Mixins.Builder.initRowDraggable(this.btn.find(".tb_library_item_list").first(),".tb_item_row");(b.toolbar.preDesignedRows.is_init||"visual"===b.mode)&&b.Mixins.Builder.initRowDraggable(this.btn.find(".tb_predesigned_rows_container").first(),".predesigned_row");
this.is_init=!0;b.Mixins.Builder.initRowDraggable(this.btn.find(".tb_module_panel_rows_wrap").first(),".tb_page_break_module")},tabs:function(a){a.preventDefault();a.stopPropagation();a=h(a.currentTarget);var d=a.closest("ul"),c=a.data("target"),e=a.closest(".tb_modules_panel_wrap");e.find("."+a.data("hide")).hide();var f=e.find("."+c),g=e.find(".tb_no_content");0<f.length?(g.hide(),f.show()):g.show();a.closest("li").addClass("current").siblings().removeClass("current");e.find(".tb_module_panel_search_text").val("").focus().trigger("keyup");
h(r).triggerHandler("tb_panel_tab_"+c,e);c=d.parent().find(".tb_ui_dropdown_label");0<c.length&&c.text(a.text());b.Utils.hideOnClick(d)},show:function(a,d){a.preventDefault();a.stopPropagation();!b.activeModel&&u.document.body.classList.contains("tb_standalone_lightbox")&&n.Lightbox.close();null===this.is_init&&this.run();this.clicked&&this.clicked[0].classList.remove("clicked");this.clicked=d?d:h(a.currentTarget);var c=this.clicked.offset(),e=v.body,f=c.left+this.clicked.width()/2,c=c.top,g="visual"!==
b.mode?h(".edit-post-layout__content"):!1;!1!==g&&0<g.length&&(c+=g.scrollTop()-70,f=g.width()/2);f-=this.btn.outerWidth()/2;0>f&&(f=0);this.clicked.parents(".sub_column").length?this.btn[0].classList.add("tb_subrow_open"):this.btn[0].classList.remove("tb_subrow_open");this.btn.css({top:c,left:f}).show();this.resize();var k=this.btn[0].getElementsByClassName("tb_predesigned_rows_container")[0];k.getElementsByClassName("simplebar-scroll-content").length&&(f=new SimpleBar(k),f.recalculate(),k=f.getScrollElement());
k.addEventListener("scroll",b.toolbar.preDesignedRows.scrollLoadMore.bind(b.toolbar.preDesignedRows),{passive:!0});"visual"===b.mode&&(e=e.add(h("body",u.document)),"desktop"!==b.activeBreakPoint&&(h("body",u.document).height(r.body.scrollHeight+this.btn.outerHeight(!0)),v.body.css("padding-bottom",180)));e.addClass("tb_panel_dropdown_openend");this.clicked.addClass("clicked");"desktop"===b.activeBreakPoint&&setTimeout(function(){this.btn.find(".tb_module_panel_search_text").focus()}.bind(this),50);
this.hide();b.ActionBar.clear();null!==b.activeModel&&(e=n.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0],e!==t&&e.click());var e=k.getElementsByTagName("img"),l=k.getElementsByClassName("simplebar-content");0<e.length?(e=e[e.length-1],h(e).one("load",function(){b.toolbar.preDesignedRows.masonry(l.length?l[0]:k)})):b.toolbar.preDesignedRows.masonry(l.length?l[0]:k)},resize:function(){null!==this.btn&&b.Utils.addViewPortClass(this.btn[0])},hide:function(a){function d(){if(!0===
a||!c.btn.is(":hover")){var e=v.body;null!==c.btn&&(c.btn.hide().css("width",""),c.clicked&&c.clicked[0].classList.remove("clicked"),c.clicked=null);h(r).off("click",d);h(u.document).off("click",d);"visual"===b.mode&&(e=e.add(h("body",u.document)),"desktop"!==b.activeBreakPoint&&(h("body",u.document).height(r.body.scrollHeight),v.body.css("padding-bottom","")));e.removeClass("tb_panel_dropdown_openend")}}var c=this;if(!0===a)d();else{if("visual"===b.mode)h(u.document).on("click",d);h(r).on("click",
d)}},search:function(a){var d=h(a.currentTarget);a=d.closest(".tb_modules_panel_wrap");var c=a.find(".tb_module_types .current").first().data("target"),e=!1,f=!1,g=!1,k=!1,d=h.trim(d.val());"tb_module_panel_modules_wrap"===c?(e=a.find(".tb_module_outer"),g=!0):"tb_module_panel_rows_wrap"===c&&b.toolbar.preDesignedRows.is_init?(b.toolbar.preDesignedRows.addNewItems(d),f=a.find(".tb_ui_dropdown_label").data("active"),e=a.find(".predesigned_row")):"tb_module_panel_library_wrap"===c&&(e=a.find(".tb_library_item"),
f=a.find(".tb_library_types .current").data("target"),k=!0);if(!1!==e){var l=""===d,m=l?!1:new RegExp(d,"i");e.each(function(){if(f&&!this.classList.contains(f))return!0;var a=g?h(this).find(".module_name"):k?h(this).find(".tb_library_item_inner span"):h(this).find(".tb_predesigned_rows_title");l||m.test(a.text())?h(this).show():h(this).hide()});l?a.removeClass("tb_module_panel_searching"):a.addClass("tb_module_panel_searching");g&&a.find(".tb_module_category_content").each(function(){this.parentElement.style.display=
"block";!1!==l||h(this).find(".tb_module_outer:visible").length||(this.parentElement.style.display="none")})}},clear:function(a){a.preventDefault();a.stopPropagation();a=h(this).parent().children("input").first();0<a.length&&(a.val(""),a[0].hasAttribute("data-search")?a.trigger("keyup").focus():(a.trigger("change"),v.triggerEvent(a[0],"change")))}},help:{init:function(){h(".tb_help_btn",b.toolbar.$el).on("click",this.show.bind(this))},show:function(a){a.preventDefault();a.stopPropagation();var b=
this;n.showLoader("show");return h.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{tb_load_nonce:themifyBuilder.tb_load_nonce,action:"tb_help"},complete:function(){n.showLoader("spinhide")},success:function(a){u.document.body.insertAdjacentHTML("beforeend",a);a=h("#tb_help_lightbox",u.document.body);h(".tb_help_tab_link",a).on("click",b.mainTabs.bind(b));h(".tb_player_btn",a).on("click",b.play.bind(b));h(".tb_help_menu a",a).on("click",b.tabs.bind(b));h(".tb_close_lightbox",a).on("click",b.close.bind(b));
a.slideDown()}})},play:function(a){a.preventDefault();a.stopPropagation();a=h(a.currentTarget).closest("a");var b=a.prop("href"),c=r.createElement("iframe");c.setAttribute("frameborder","0");c.setAttribute("allow","autoplay; fullscreen");c.setAttribute("src",b+"?rel=0&showinfo=0&autoplay=1&enablejsapi=1&html5=1&version=3");a.replaceWith(c)},tabs:function(a){a.preventDefault();a.stopPropagation();a=h(a.currentTarget);var b=h(".tb_help_video_wrapper",u.document),c=b.find(a.attr("href")),e=c.find(".tb_player_btn");
b.find(".tb_player_wrapper").removeClass("current").hide();c.addClass("current").show();a.closest("li").addClass("current").siblings().removeClass("current");this.stopPlay();0<e.length?e.trigger("click"):this.startPlay()},execute:function(a,b){a.contentWindow.postMessage('{"event":"command","func":"'+b+'","args":""}',"*")},stopPlay:function(){var a=this;h(".tb_player_wrapper",u.document).each(function(){if(!this.classList.contains("current")){var b=h(this).find("iframe");0<b.length&&a.execute(b[0],
"pauseVideo")}})},startPlay:function(){var a=h(".tb_player_wrapper.current",u.document).find("iframe");0<a.length&&this.execute(a[0],"playVideo")},close:function(a,b){a.preventDefault();a.stopPropagation();h(a.currentTarget).closest("#tb_help_lightbox").slideUp("normal",function(){h(this).next(".tb_overlay").remove();h(this).empty().remove();b&&b()})},mainTabs:function(a){a.preventDefault();a.stopPropagation();a=h(a.currentTarget);var b=h(".tb_help_lightbox_inner_wrapper",u.document);a.hasClass("tb_help_active_tab")||
(b.find(".tb_help_active_tab").removeClass("tb_help_active_tab"),a.addClass("tb_help_active_tab"),b.attr("data-active-tab",a.data("type")))}},deviceSwitcher:function(a){var b=a.target,c=b.parentNode.previousElementSibling;c.classList.contains("tb_breakpoint_switcher")&&(a.tb_device=[b.dataset.width,b.dataset.height],a.target=c,a.currentTarget=c,this.breakpointSwitcher(a))},breakpointSwitcher:function(a){a.preventDefault();a.stopPropagation();var d=this,c="desktop",e=a.currentTarget,f=h("body",u.document),
g="visual"===b.mode&&b.iframe[0].classList.contains("tb_resizing_start"),k=b.activeBreakPoint,l=function(){d.responsive_grids(c,k);var a=function(){b.Utils.setCompactMode(r.getElementsByClassName("module_column"));b.toolbar.el.getElementsByClassName("tb_compact_switcher")[0].getElementsByTagName("i")[0].className=e.getElementsByTagName("i")[0].className;f.removeClass("tb_start_animate").toggleClass("tb_responsive_mode","desktop"!==c).removeClass("builder-breakpoint-"+k).addClass("builder-breakpoint-"+
c);v.body.triggerHandler("themify_builder_change_mode",[k,c]);"visual"===b.mode&&(b.iframe[0].style.willChange="",setTimeout(function(){"desktop"!==b.activeBreakPoint?b.Utils.calculateHeight():u.document.body.style.height="";!g&&b.scrollTo&&(h(x).add(u.document).scrollTop(b.scrollTo.offset().top),b.scrollTo=!1)},150));b.ActionBar.disable=b.clearOnModeChange=null};"visual"===b.mode?b.Utils._onResize(!0,function(){d.iframeScroll("desktop"!==c);"desktop"!==k&&"desktop"!==c||b.Mixins.Builder.updateModuleSort(null,
"desktop"===c?"enable":"disable");b.ActionBar.hoverCid=null;b.EdgeDrag.clearEdges();setTimeout(a,g?1:100)}):a()};e.classList.contains("breakpoint-tablet")?c="tablet":e.classList.contains("breakpoint-tablet_landscape")?c="tablet_landscape":e.classList.contains("breakpoint-mobile")&&(c="mobile");if(t!==a.tb_device||!v.body[0].classList.contains("builder-breakpoint-"+c)){var m="desktop"!==c?t!==a.tb_device?"tablet_landscape"===c?a.tb_device[1]:a.tb_device[0]:b.Utils.getBPWidth(c)-1:"";if(k===c&&a.originalEvent!==
t&&(m?m+"px":m)===b.iframe[0].style.width)return!1;b.ActionBar.disable=!0;if("visual"===b.mode){null===b.clearOnModeChange&&b.ActionBar.clear();if(!g&&!b.isPreview){var q=b.Instances.Builder[0].el.children;var p=[];for(var y=x.innerHeight,w=function(a){if(null!==a&&a!==t){var b=a.getBoundingClientRect();if(0>b.bottom&&0>b.top||b.top>y)a.style.display="none",p.push(a)}},E=q.length-1;-1<E;--E)w(q[E]);w(r.getElementById("headerwrap"));w(r.getElementById("footerwrap"));q=y=null}f=f.add(v.body)}b.activeBreakPoint=
c;f.addClass("tb_start_animate");if("visual"===b.mode){b.iframe[0].style.willChange="width";q=u.document.getElementsByClassName("tb_toolbar_zoom_menu")[0];q.classList.remove("tb_toolbar_zoom_active");q.getElementsByClassName("tb_toolbar_zoom_menu_toggle")[0].dataset.zoom=100;"tablet_landscape"===c&&n.Lightbox.dockMode.get()&&(q=h(".tb_workspace_container",u.document).width(),q<m&&(m=q));if(b.isPreview&&(q={tablet_landscape:[1024,768],tablet:[768,1024],mobile:[375,667]},q[c]!==t)){m=t===a.tb_device?
q[c][0]:"tablet_landscape"===c?a.tb_device[1]:a.tb_device[0];var H=t===a.tb_device?q[c][1]:"tablet_landscape"===c?a.tb_device[0]:a.tb_device[1]}b.iframe[0].parentNode.classList.remove("tb_zoom_bg");g?l():(u.document.body.offsetHeight,b.iframe.one(b.Utils.transitionPrefix(),function(){if(!b.isPreview){for(var a=p.length-1;-1<a;--a)p[a].style.display="";p=null}setTimeout(l,10)}),b.iframe[0].style.width=m?m+"px":m,b.iframe[0].style.height=b.isPreview?H?H+"px":H:"")}else l()}},iframeScroll:function(a){var b=
h(u.document);b.off("scroll.themifybuilderresponsive");if(a)b.on("scroll.themifybuilderresponsive",function(){x.scrollTo(0,h(this).scrollTop())})},responsive_grids:function(a,b){for(var c=r.querySelectorAll(".row_inner,.subrow_inner"),d="desktop"===a,f=d||"desktop"===b,g=c.length-1;-1<g;--g){var k=c[g].getAttribute("data-basecol");if(null!==k){var l=c[g].children,m=c[g].dataset["col_"+a],q=l[0],p=l[l.length-1];if(!d){if("desktop"!==b){c[g].classList.remove("tb_3col");var n=c[g].getAttribute("data-col_"+
b);n&&c[g].classList.remove(h.trim(n.replace("tb_3col","").replace("mobile","column").replace("tablet","column")))}if(m&&"-auto"!==m&&m!==a+"-auto"){if(m=c[g].getAttribute("data-col_"+a))for(c[g].classList.add("tb_grid_classes"),c[g].classList.add("col-count-"+k),m=m.split(" "),k=0,n=m.length;k<n;++k)c[g].classList.add(h.trim(m[k].replace("mobile","column").replace("tablet","column")))}else c[g].classList.remove("tb_grid_classes"),c[g].classList.remove("col-count-"+k)}if(f)for(k=0,m=l.length;k<m;++k)n=
h(l[k]).data("w"),n!==t&&(l[k].style.width=d?n+"%":"");"rtl"===c[g].getAttribute("data-"+a+"_dir")?(q.classList.remove("first"),q.classList.add("last"),p.classList.remove("last"),p.classList.add("first"),c[g].classList.add("direction-rtl")):(q.classList.remove("last"),q.classList.add("first"),p.classList.remove("first"),p.classList.add("last"),c[g].classList.remove("direction-rtl"))}}},Panel:{el:null,init:function(){this.el=b.toolbar.$el.find(".tb_toolbar_add_modules_wrap");this.el.on("click",".add_module_btn",
this.initEvents.bind(this));this.compactToolbar();"visual"===b.mode&&n.Lightbox.dockMode.setDoc()},initEvents:function(a){a.preventDefault();a.stopPropagation();var d=a.currentTarget.dataset.type;"module"===d?this.add_module(a):"row"===d?this.click_add_sub_row(a):"page_break"===d?this.click_add_page_break(a):"predesigned"===d&&b.toolbar.preDesignedRows.get(a.currentTarget.closest(".predesigned_row").dataset.slug,function(a){var c=b.Instances.Builder[b.builderIndex].$el.find(".module_row").last();
b.Mixins.Builder.rowDrop(a,h("<div>").insertAfter(c),!0)})},setFocus:function(){b.toolbar.el.getElementsByClassName("tb_module_panel_search_text")[0].focus()},add_module:function(a,d){a.preventDefault();a.stopPropagation();d&&0!==d.length||(d=b.Instances.Builder[b.builderIndex].newRowAvailable(1,!0).find(".tb_holder").first());b.Mixins.Builder.moduleDrop(h(a.currentTarget).closest(".tb_module"),d)},click_add_sub_row:function(a,d){a.preventDefault();a.stopPropagation();var c=d?!0:!1;d=d||b.Instances.Builder[b.builderIndex].$el.find(".module_row").last();
var e=h(a.currentTarget).closest(".tb_row_grid").data("slug");c?d.hasClass("tb_module_front")?b.Mixins.Builder.subRowDrop(e,h("<div>").insertAfter(d)):b.Mixins.Builder.subRowDrop(e,h("<div>").appendTo(d)):b.Mixins.Builder.rowDrop(b.Utils.grid(e),h("<div>").insertAfter(d),!0,!0)},click_add_page_break:function(a,d){a.preventDefault();a.stopPropagation();d=d||b.Instances.Builder[b.builderIndex].$el.find(".module_row").last();b.Mixins.Builder.rowDrop(b.toolbar.pageBreakModule.get(),h("<div>").insertAfter(d),
!0);b.toolbar.pageBreakModule.countModules()},compactToolbar:function(){function a(){b.toolbar.$el.outerWidth()<d?u.document.body.classList.add("tb_compact_toolbar"):u.document.body.classList.remove("tb_compact_toolbar");b.toolbar.common.resize()}var d="visual"===b.mode?850:750;h(u).on("tfsmartresize.compact",a);if("visual"===b.mode)u.jQuery("body").one("themify_builder_ready",a);else a()}},toggleFavoriteModule:function(){var a=h(this),d=a.closest(".tb_module_outer"),c=a.parent().data("module-slug");
h.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_module_favorite",module_name:c,module_state:+!d.hasClass("favorited")},beforeSend:function(a){function e(a,d){function f(){var f;if(a.length){d&&(f=0<a.closest("#tb_module_panel_dropdown").length?b.toolbar.$el:h("#tb_module_panel_dropdown"));a.removeAttr("style");var g=a.data("categories").split(","),k=a.closest(".tb_module_panel_modules_wrap"),l=k.find('.tb_module_category_content[data-category="favorite"]');if(a.hasClass("favorited")){for(var m=
g.length-1;0<=m;m--){var n=k.find('.tb_module_category_content[data-category="'+g[m]+'"]').parent();n.find(".tb_module_outer.tb-module-"+c).css({opacity:0,transform:"scale(0.5)"}).remove();n.find(".tb_module_outer").length||n.css({display:"none"})}l.parent().css({display:"block"});a.clone().css({opacity:0,transform:"scale(0.5)"}).appendTo(l).css({opacity:1,transform:"scale(1)"})}else for(m=g.length-1;0<=m;m--){n=k.find('.tb_module_category_content[data-category="'+g[m]+'"]');var t=a.clone().css({opacity:0,
transform:"scale(0.5)"}).appendTo(n);n.parent().css({display:"block"});t.css({opacity:1,transform:"scale(1)"})}d&&e(f.find(".tb-module-type-"+c).closest(".tb_module_outer"),!1);a.remove();l.find(".tb_module_outer").length||l.parent().css({display:"none"})}}if(a.length&&!a.is(":visible"))a.toggleClass("favorited"),f();else a.css({opacity:0,transform:"scale(0.5)"}).one(g,function(){a.toggleClass("favorited").one(g,f)})}var g=b.Utils.transitionPrefix();e(d,!0)}})},zoom:function(a){function d(){b.Utils._onResize(!0)}
a.preventDefault();if("desktop"!==b.activeBreakPoint)return!0;var c=h(a.currentTarget);a=c.data("zoom");var e=h(".tb_iframe",u.document),f=c.closest(".tb_toolbar_zoom_menu");c.hasClass("tb_toolbar_zoom_menu_toggle")?(a="100"==a?50:100,c.data("zoom",a),c=c.next("ul").find('[data-zoom="'+a+'"]')):f.find(".tb_toolbar_zoom_menu_toggle").data("zoom",a);e.removeClass("tb_zooming_50 tb_zooming_75");c.parent().addClass("selected-zoom-size").siblings().removeClass("selected-zoom-size");"50"==a||"75"==a?(c=
"50"==a?2:1.25,e.addClass("tb_zooming_"+a).one(b.Utils.transitionPrefix(),d).parent().addClass("tb_zoom_bg").css("height",Math.max(u.innerHeight*c,600)),f.addClass("tb_toolbar_zoom_active"),b.zoomMeta.isActive=!0,b.zoomMeta.size=a,v.body.addClass("tb_zoom_only")):(e.addClass("tb_zooming_"+a).one(b.Utils.transitionPrefix(),d).parent().css("height",""),f.removeClass("tb_toolbar_zoom_active"),b.zoomMeta.isActive=!1,v.body.removeClass("tb_zoom_only"))},previewBuilder:function(a){a.preventDefault();h(a.currentTarget).toggleClass("tb_toolbar_preview_active");
b.isPreview=!b.isPreview;b.isPreview||(b.iframe[0].style.height="");v.body.toggleClass("tb_preview_only themify_builder_active");h("body",u.document).toggleClass("tb_preview_parent");if(b.isPreview){a=r.getElementsByClassName("row_inner");for(var d=a.length-1;-1<d;--d)if(a[d].classList.contains("col-count-1")&&0===a[d].getElementsByClassName("active_module").length){var c=a[d].getElementsByClassName("module_column")[0];if((c=b.Models.Registry.lookup(c.getAttribute("data-cid")))&&0===Object.keys(c.get("styling")).length){var c=
a[d].closest(".module_row"),e=b.Models.Registry.lookup(c.getAttribute("data-cid"));e&&0===Object.keys(e.get("styling")).length&&c.classList.add("tb_hide")}}}else h(".tb_hide.module_row").removeClass("tb_hide");"visual"===b.mode&&!u.document.body.classList.contains("tb_panel_minimized")&&n.Lightbox.dockMode.get()&&b.Utils._onResize(!0);b.vent.trigger("dom:preview")},toggleAccordion:function(a){h(a.currentTarget).closest(".tb_module_panel_tab_acc_component").toggleClass("tb_collapsed")},closeFloat:function(a){a&&
(a.preventDefault(),a.stopPropagation(),localStorage.setItem("tb_panel_closed",!0));u.document.body.classList.add("tb_panel_closed")},openFloat:function(a){a&&(a.preventDefault(),a.stopPropagation(),localStorage.removeItem("tb_panel_closed"));u.document.body.classList.remove("tb_panel_closed");b.toolbar.common.hide(!0)}});b.Forms={Data:{},Validators:{},parseSettings:function(a,d){var c;var e="";var f=a.classList;if(!f.contains("tb_row_js_wrapper")){var g=a.closest(".tb_field");if(null!==g&&!g.classList.contains("_tb_hide_binding")&&
("none"!==g.style.display||-1===g.className.indexOf("tb_group_element_"))&&(g=g.parentNode,g.classList.contains("tb_multi_fields")&&g.parentNode.classList.contains("_tb_hide_binding")))return!1}g=d?a.getAttribute("data-input-id"):a.getAttribute("id");if(f.contains("tb_lb_wp_editor"))tinyMCE!==t?(e=a.id,f=tinyMCE.get(e),e=null!==f?!1===f.hidden?f.getContent():switchEditors.wpautop(tinymce.DOM.get(e).value):a.value):e=a.value;else if(f.contains("themify-checkbox")){e=[];var k=a.getElementsByClassName("tb-checkbox");
var l=f.contains("tb_switcher");for(var f=0,m=k.length;f<m;++f)!0!==l&&!0!==k[f].checked||""===k[f].value||e.push(k[f].value);e=0<e.length?e.join("|"):l?"":!1}else if(f.contains("themify-layout-icon"))e=a.getElementsByClassName("selected")[0],e=e!==t?e.id:"";else if(f.contains("tb_search_input"))e=a.getAttribute("data-value"),f.contains("query_category_single")&&(f=a.closest(".tb_input").getElementsByClassName("query_category_multiple")[0],f=f===t?"":f.value.trim(),e=""!==f?f+"|"+(-1!==f.indexOf(",")?
"multiple":"single"):e+"|single");else if(f.contains("tb_radio_input_container")){m=a.getElementsByTagName("input");k=null;for(f=m.length-1;-1<f;--f)if(!0===m[f].checked){k=m[f];break}null===k||"desktop"!==b.activeBreakPoint&&k.classList.contains("responsive_disable")||(e=k.value)}else if(f.contains("tb_search_container"))e=a.previousElementSibling.dataset.value;else if(f.contains("tb_row_js_wrapper")){e=[];var q=a.getElementsByClassName("tb_repeatable_field_content");f=0;for(m=q.length;f<m;++f){k=
q[f].getElementsByClassName("tb_lb_option_child");e[f]={};var p=0;for(c=k.length;p<c;++p)(l=this.parseSettings(k[p],!0))&&(e[f][l.id]=l.v)}}else if(f.contains("module-widget-form-container"))e=h(a).find(":input").themifySerializeObject();else if(f.contains("tb_widget_select"))e=a.getElementsByClassName("selected")[0],e=e!==t?e.dataset.value:"";else if(f.contains("tb_sort_fields_parent")){k=a.children;e=[];f=0;for(m=k.length;f<m;++f)if(l=k[f].getAttribute("data-type")){p=k[f].getElementsByClassName("tb_sort_field_dropdown")[0];
l={type:l,id:k[f].getAttribute("data-id")};if(p!==t)for(l.val={},q=p.getElementsByClassName("tb_lb_sort_child"),p=q.length-1;-1<p;--p)(c=this.parseSettings(q[p],!0))&&(l.val[c.id]=c.v);else c=k[f].getElementsByTagName("input")[0],p=c.value,""!==p&&(l.val=JSON.parse(p));e.push(l)}0===e.length&&(e="")}else if(f.contains("tb_accordion_fields"))for(k=a.children,e={},f=0,m=k.length;f<m;++f){if(q=k[f].getAttribute("data-id"))c=k[f].getElementsByTagName("input")[0],p=k[f].getElementsByClassName("tb_accordion_fields_options")[0],
l={},p!==t?l.val=this.serialize(p,null,!0):(p=c.value,""!==p&&(l.val=JSON.parse(p))),e[q]=l}else if(f.contains("tb_toggleable_fields"))for(k=a.children,e={},f=0,m=k.length;f<m;++f){if(q=k[f].getAttribute("data-id"))c=k[f].getElementsByTagName("input")[0],p=k[f].getElementsByClassName("tb_toggleable_fields_options")[0],l={on:k[f].getElementsByClassName("tb_switcher")[0].getElementsByClassName("toggle_switch")[0].value},p!==t?l.val=this.serialize(p,null,!0):(p=c.value,""!==p&&(l.val=JSON.parse(p))),
e[q]=l}else if(e=a.value,x.tbpDynamic!==t&&g===tbpDynamic.field_name){if(""===e)return!1;"string"===typeof e&&(e=JSON.parse(e))}else{if(g===b.GS.key&&"desktop"!==b.activeBreakPoint)return!1;""!==e&&("builder_content"===g?"string"===typeof e&&(e=JSON.parse(e)):(f=a.getAttribute("data-opacity"),null!==f&&""!==f&&1!=f&&"0.99"!=f&&(e+="_"+f)))}if(e===t||null===e)e="";return{id:g,v:e}},serialize:function(a,b,c){c=c||!1;var d={};a="object"===typeof a?a:u.document.getElementById(a);if(null!==a){a=a.getElementsByClassName(c?
"tb_lb_option_child":"tb_lb_option");for(var f=a.length-1;-1<f;--f){var g=this.parseSettings(a[f],c);!1===g||!0!==b&&""===g.v||(d[g.id]=g.v)}}return d},LayoutPart:{cache:[],undo:null,old_id:null,isReload:null,id:null,init:!1,html:null,el:null,options:null,isSaved:null,scrollTo:function(a,d){b.scrollTo=b.Forms.LayoutPart.el},edit:function(a){function d(a){b.ActionBar.clear();r.getElementById("themify_builder_content-"+themifyBuilder.post_ID).insertAdjacentHTML("afterbegin",'<div class="tb_overlay"></div>');
f.addClass("tb_active_layout_part").closest(".row_inner").find(".active_module").each(function(){this.classList.contains("tb_active_layout_part")||this.insertAdjacentHTML("afterbegin",'<div class="tb_overlay"></div>')});var c="themify_builder_content-"+e.id;e.html=f[0].innerHTML;themifyBuilder.post_ID=ThemifyStyles.builder_id=e.id;f[0].insertAdjacentHTML("afterbegin",k.replace("#postID#",e.id));h("."+c).each(function(){h(this).closest(".active_module").find(".themify-builder-generated-css").first().prop("disabled",
!0)});b.Instances.Builder[0].el.classList.remove("tb_active_builder");f.removeClass("active_module module").closest(".tb_holder").removeClass("tb_holder").addClass("tb_layout_part_parent").closest(".module_row").addClass("tb_active_layout_part_row");g.attr("id",c).removeClass("not_editable_builder").addClass("tb_active_builder").empty();e.el=f;b.id=e.id;var d=[];b.builderIndex=1;b.Instances.Builder[b.builderIndex]=new b.Views.Builder({el:g,collection:new b.Collections.Rows(a),type:b.mode});a=b.Instances.Builder[b.builderIndex].render().el.querySelectorAll("[data-cid]");
for(var c=0,l=a.length;c<l;++c)d[a[c].dataset.cid]=1;a=null;b.bootstrap(d,function(){f.triggerHandler("tb_layout_part_before_init");d=b.activeModel=null;b.Utils.loadContentJs(g);b.id=!1;v.body.on("themify_builder_change_mode",e.scrollTo);b.hasChanged=null;b.Instances.Builder[b.builderIndex].$el.triggerHandler("tb_init");f.find(".tb_toolbar_save").on("click",e.save.bind(e));f.find(".tb_toolbar_close_btn").on("click",e.close.bind(e));f.find(".tb_load_layout").on("click",b.Views.Toolbar.prototype.loadLayout);
f.find(".tb_toolbar_import ul a").on("click",b.Views.Toolbar.prototype["import"]);n.showLoader("hide");e.init=!1;e.undo=b.undoManager.stack;b.undoManager.btnUndo=f[0].getElementsByClassName("tb_undo_btn")[0];b.undoManager.btnRedo=f[0].getElementsByClassName("tb_redo_btn")[0];b.undoManager.reset();f.find(".tb_undo_redo").on("click",function(a){b.undoManager.do_change(a)});"desktop"!==b.activeBreakPoint&&b.Mixins.Builder.updateModuleSort(null,"disable");"visual"===b.mode&&setTimeout(function(){b.Utils.checkAllimageSize()},
500);b.ActionBar.disable=b.ActionBar.hoverCid=null;f.triggerHandler("tb_layout_part_after_init")})}b.ActionBar.disable=!0;n.showLoader("show");r.body.classList.add("tb_layout_part_edit");if(null!==b.activeModel){var c=n.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];c!==t&&c.click();c=null}u.document.body.classList.add("tb_layout_part_edit");var e=this,f=h(a).closest(".active_module"),g=f.find(".themify_builder_content"),k=n.templateCache.get("tmpl-small_toolbar");this.id=
g.data("postid");this.old_id=themifyBuilder.post_ID;this.init=!0;this.isSaved=null;this.cache[this.id]!==t?d(this.cache[this.id]):h.ajax({type:"POST",dataType:"json",url:themifyBuilder.ajaxurl,data:{action:"tb_layout_part_swap",nonce:themifyBuilder.tb_load_nonce,id:e.id},success:function(a){a.data&&(e.cache[e.id]=a.data,a.gs&&(b.GS.styles=h.extend(!0,{},a.gs,b.GS.styles)),d(a.data))}})},close:function(a){function d(){c.el.removeClass("tb_active_layout_part").addClass("active_module module").closest(".tb_layout_part_parent").addClass("tb_holder").removeClass("tb_layout_part_parent").closest(".module_row").removeClass("tb_active_layout_part_row");
h("#tb_small_toolbar",c.el).remove();for(var a=e[0].querySelectorAll("[data-cid]"),d=a.length-1;-1<d;--d){var f=a[d].dataset.cid,m=b.Models.Registry.lookup(f);m&&(m.destroy(),b.Models.Registry.remove(f))}e.removeAttr("id").addClass("not_editable_builder").removeClass("tb_active_builder");r.body.classList.remove("tb_layout_part_edit");u.document.body.classList.remove("tb_layout_part_edit");h(".tb_overlay").remove();b.undoManager.stack=c.undo;b.undoManager.index=c.undo.length-1;b.undoManager.btnUndo=
b.toolbar.el.getElementsByClassName("tb_undo_btn")[0];b.undoManager.btnRedo=b.toolbar.el.getElementsByClassName("tb_redo_btn")[0];themifyBuilder.post_ID=ThemifyStyles.builder_id=c.old_id;c.undo=c.isSaved=c.old_id=c.html=c.id=c.options=c.isReload=c.el=b.Instances.Builder[b.builderIndex]=null;delete b.Instances.Builder[b.builderIndex];b.builderIndex=0;v.body.off("themify_builder_change_mode",c.scrollTo);b.Mixins.Builder.updateModuleSort();b.undoManager.updateUndoBtns();"desktop"!==b.activeBreakPoint&&
b.Mixins.Builder.updateModuleSort(null,"disable");b.ActionBar.hoverCid=null;b.ActionBar.clear();b.Instances.Builder[b.builderIndex].el.classList.add("tb_active_builder");b.Instances.Builder[b.builderIndex].lastRowAddBtn()}a.preventDefault();a.stopPropagation();if(!b.hasChanged&&!b.undoManager.hasUndo()||null!==this.isSaved||confirm(themifyBuilder.i18n.layoutEditConfirm)){null!==b.activeModel&&n.Lightbox.close();var c=this,e=this.el.find(".themify_builder_content");if(null!==this.options){n.showLoader("show");
a=b.Models.Registry.lookup(this.el.data("cid"));this.cache[this.id]=this.options;h(r).ajaxComplete(function k(a,f,q){if(-1!==q.data.indexOf("tb_load_module_partial",3))if(h(this).off("ajaxComplete",k),200===f.status){c.el=b.liveStylingInstance.$liveStyledElmt;e=c.el.children(".themify_builder_content");var l=e[0].innerHTML,m="";c.el.children(".themify-builder-generated-css").each(function(){m+=this.outerHTML});h(".themify_builder_content-"+c.id).each(function(){var a=h(this).closest(".module");a.children("link.themify-builder-generated-css").remove();
""!==m&&a[0].insertAdjacentHTML("afterbegin",m);this.innerHTML=l;b.Utils.loadContentJs(h(this))});m=l=null;n.showLoader("hide");d()}else n.showLoader("error")});var f=h.extend(!0,{},a.get("mod_settings"));f.unsetKey=!0;a.trigger("custom:preview:refresh",f);f=null}else this.el[0].innerHTML=c.html,d(),h(".themify_builder_content-"+c.id).each(function(){h(this).closest(".active_module").find(".themify-builder-generated-css").removeAttr("disabled")}),b.Utils.loadContentJs(e)}},save:function(a,d){a.preventDefault();
a.stopPropagation();if(null!==b.activeModel){var c=n.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];c!==t&&c.click();c=null}if(b.undoManager.hasUndo()||null!==this.isReload||d){var e=this;this.old_settings=this.html=null;n.showLoader("show");b.Utils.saveBuilder(function(c){c.success&&(e.options=c.data.builder_data,b.hasChanged=null,e.isSaved=!0,d&&e.close(a))},1)}else n.showLoader("show"),setTimeout(function(){n.showLoader("hide")},100)}},reLoad:function(a,d,c){function e(){"visual"===
b.mode&&(b.liveStylingInstance.setCss(b.Mixins.Builder.toJSON(b.Instances.Builder[k].el)),b.Utils.loadContentJs(b.Instances.Builder[k].$el),b.id=!1);b.Instances.Builder[b.builderIndex].$el.triggerHandler("tb_init");n.showLoader("hide");"visual"===b.mode&&"desktop"!==b.activeBreakPoint&&(h("body",u.document).height(r.body.scrollHeight),setTimeout(function(){h("body",u.document).height(r.body.scrollHeight)},2E3));c&&c();b.hasChanged=!0;"visual"===b.mode&&setTimeout(function(){b.Utils.checkAllimageSize()},
500)}var f=a.builder_data!==t?a.builder_data:a;a.used_gs!==t&&(b.GS.styles=h.extend(!0,{},a.used_gs,b.GS.styles));var g=null!==b.Forms.LayoutPart.id,k=b.builderIndex,l=null,m="";b.Mixins.Builder.updateModuleSort(null,"destroy");g||(b.Models.Registry.destroy(),b.Instances.Builder={});"visual"===b.mode?(m="#themify_builder_content-"+d,b.id=d,g||(b.liveStylingInstance.reset(),b.editing=!1,v.body.addClass("sidebar-none full_width"),h("#sidebar,.page-title").remove())):m="#tb_row_wrapper";if(g){d=b.Instances.Builder[k].el.querySelectorAll("[data-cid]");
b.Forms.LayoutPart.isReload=!0;for(var q=0,p=d.length;q<p;++q){var y=d[q].dataset.cid,w=b.Models.Registry.lookup(y);w&&(w.destroy(),b.Models.Registry.remove(y))}d=null;b.Instances.Builder[k].$el.empty()}b.Instances.Builder[k]=new b.Views.Builder({el:m,collection:new b.Collections.Rows(f),type:b.mode});b.Instances.Builder[k].render();b.undoManager.reset();if(g){l=[];d=b.Instances.Builder[k].el.querySelectorAll("[data-cid]");q=0;for(p=d.length;q<p;++q)l[d[q].dataset.cid]=1;d=null}"visual"===b.mode?
b.bootstrap(l,e,a.used_gs!==t?a.used_gs:null):e()},isValidate:function(a){var d=a.getElementsByClassName("tb_must_validate"),c=d.length;if(0===c)return!0;for(var e=!0,c=c-1;-1<c;--c){var f=d[c].getElementsByClassName("tb_lb_option")[0],g=d[c].getAttribute("data-validation"),h=f.value;if(b.Forms.get_validator(g)(h))for(f.classList.remove("tb_field_error"),f=d[c].getElementsByClassName("tb_field_error_msg"),g=f.length-1;-1<g;--g)f[g].parentNode.removeChild(f[g]);else f.classList.contains("tb_field_error")||
(e=r.createElement("span"),e.className="tb_field_error_msg",e.textContent=d[c].getAttribute("data-error-msg"),f.classList.add("tb_field_error"),f="SELECT"===f.tagName?f.parentNode:f,f.parentNode.insertBefore(e,f.nextSibling)),e=!1}!1===e&&(a=n.Lightbox.$lightbox.find('[href="#'+a.getAttribute("id")+'"]')[0],a.parentNode.classList.contains("current")||a.click());return e}};b.Utils={onResizeEvents:[],gridClass:"col-full col2-1 col3-1 col4-1 col5-1 col6-1 col4-2 col4-3 col3-2".split(" "),_onResize:function(a,
d){var c=h._data(x,"events").resize;h(u).off("tfsmartresize.tb_visual").on("tfsmartresize.tb_visual",function(a){""===tbLocalScript.fullwidth_support&&(h(x).triggerHandler("tfsmartresize.tbfullwidth"),h(x).triggerHandler("tfsmartresize.tfVideo"));v.reLayoutIsoTop()}).off("tfsmartresize.zoom").on("tfsmartresize.zoom",function(){if(b.zoomMeta.isActive){var a="50"==b.zoomMeta.size?2:1.25;h(".tb_workspace_container",u.document).css("height",Math.max(u.innerHeight*a,600))}});if(c!==t)for(var e=0,f=c.length;e<
f;++e)c[e].handler!==t&&this.onResizeEvents.push(c[e].handler);h(x).off("resize");if(a){c=h.Event("resize",{type:"resize",isTrigger:!1});e=0;for(f=this.onResizeEvents.length;e<f;++e)try{this.onResizeEvents[e].apply(x,[c,h])}catch(g){}"function"===typeof d&&d()}},_addNewColumn:function(a,d){var c=b.Views.init_column({grid_class:a.newclass,component_name:a.component});d.appendChild(c.view.render().el)},filterClass:function(a){a=a.split(" ");for(var b=[],c=a.length-1;-1<c;--c)-1!==this.gridClass.indexOf(a[c])&&
b.push(a[c]);return b.join(" ")},_getRowSettings:function(a,d){var c=[];d=d||"row";var e={};var f,g=b.Models.Registry.lookup(a.getAttribute("data-cid"));if(g){var h=a.getElementsByClassName(d+"_inner")[0];e=h.children;for(var l=this,m=function(a){a=a.children;for(var c=0,d=a.length;c<d;++c){a[c].classList.contains("active_module")||m(a[c]);var e=b.Models.Registry.lookup(a[c].getAttribute("data-cid"));e&&(f=e.get("mod_settings"),e=r.push({mod_name:e.get("mod_name"),element_id:e.get("element_id")})-
1,f&&0<Object.keys(f).length&&(delete f.cid,r[e].mod_settings=f),a[c].classList.contains("module_subrow")&&(r[e]=l._getRowSettings(a[c],"subrow")))}},q=0,p=e.length;q<p;++q){var n={};var w=b.Models.Registry.lookup(e[q].getAttribute("data-cid"));if(w){n=e[q].getElementsByClassName("tb_holder")[0];var r=[];n!==t&&m(n);n=c.push({element_id:w.get("element_id"),grid_class:this.filterClass(e[q].className)});--n;r&&0<r.length&&(c[n].modules=r);var u=parseFloat(e[q].style.width);0<u&&!isNaN(u)&&(c[n].grid_width=
u);(f=w.get("styling"))&&0<Object.keys(f).length&&(delete f.cid,c[n].styling=f)}}e={element_id:g.get("element_id"),cols:c,column_alignment:g.get("column_alignment"),gutter:g.get("gutter"),column_h:g.get("column_h")};p={gutter:"gutter-default",column_alignment:F?"col_align_middle":"col_align_top"};c={desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_tablet_landscape:"-auto",col_tablet:"-auto",col_mobile:"-auto"};for(q in e)""!==e[q]&&null!==e[q]&&e[q]!==p[q]||delete e[q];
f=g.get("styling");for(q in c)g=h.getAttribute("data-"+q),null===g||""===g||g===c[q]||"-auto"===c[q]&&-1!==g.indexOf("-auto")||(e[q]=g.trim());f&&0<Object.keys(f).length&&(delete f.cid,e.styling=f)}return e},selectedGridMenu:function(a,d){var c=ThemifyConstructor.breakpointsReverse,e=b.Models.Registry.lookup(a.getAttribute("data-cid")),f=a.getElementsByClassName(d+"_inner")[0],g=e.get("gutter"),h=e.get("column_alignment"),l=e.get("column_h");var m=e.get("desktop_dir");var q="row"===d?e.get("styling"):
null,p=[],n={};var w=f.children;for(var r=0,u=w.length;r<u;++r)w[r].className=w[r].className.replace(/first|last/ig,""),1!==u&&(0===r?w[r].className+="rtl"===m?" last":" first":r===u-1&&(w[r].className+="rtl"===m?" first":" last"));w=w.length;p.push("col-count-"+w);n["data-basecol"]=w;null!==q&&q.row_anchor!==t&&""!==q.row_anchor&&(a.getElementsByClassName("tb_row_anchor")[0].textContent=q.row_anchor);"gutter-default"!==g&&p.push(g);l&&p.push("col_auto_height");h||(h="col_align_top");p.push(h);"ltr"!==
m&&p.push("direction-rtl");for(g=c.length-1;-1<g;--g)m=e.get(c[g]+"_dir"),"ltr"!==m&&""!==m&&(n["data-"+c[g]+"_dir"]=m),"desktop"!==c[g]&&(w=e.get("col_"+c[g]),"-auto"!==w&&""!==w&&w!==t&&(n["data-col_"+c[g]]=w));for(r=p.length-1;-1<r;--r)p[r]&&f.classList.add(p[r]);for(r in n)f.setAttribute(r,n[r])},clear:function(a,d,c){d===t&&(d=Array.isArray(a));var e=!0===d?[]:{},f=x.tbpDynamic!==t?tbpDynamic.field_name:!1;c||(c=1);for(var g in a)if(Array.isArray(a[g])){++c;var k=this.clear(a[g],!0,c);0<k.length&&
(!0===d?e.push(k):e[g]=k)}else if(g===f)"{}"===a[g]||""===a[g]?(delete a[g],delete e[g]):(k=a[g],"string"===typeof k&&(k=JSON.parse(k)),a[g]=e[g]=k);else if("object"===typeof a[g])++c,k=this.clear(a[g],!1,c),h.isEmptyObject(k)||(e[g]=k);else if(null!==a[g]&&a[g]!==t&&""!==a[g]&&"def"!==a[g]&&""!==g&&"pixels"!==a[g]&&"default"!==a[g]&&"|"!==a[g]&&!("show"===a[g]&&0===g.indexOf("visibility_")||"unstick_when_condition"===g&&"hits"===a[g]||("stick_at_pos_val_unit"===g||"unstick_when_pos_val_unit"===g)&&
"px"===a[g]))if("custom_parallax_scroll_speed"!==g||a[g]&&"0"!=a[g])if("unstick_when_element"===g&&"builder_end"===a[g]||"stick_at_check"===g&&"stick_at_check"!==a[g])delete e.unstick_when_el_row_id,delete e.unstick_when_el_mod_id,delete e.unstick_when_condition,delete a.unstick_when_el_row_id,delete a.unstick_when_el_mod_id,delete a.unstick_when_condition,delete e.unstick_when_pos,delete e.unstick_when_pos_val,delete e.unstick_when_element,delete e.unstick_when_pos_val_unit,delete a.unstick_when_pos,
delete a.unstick_when_pos_val,delete a.unstick_when_pos_val_unit,delete a.unstick_when_element,"stick_at_check"===g&&(delete a[g],delete e[g],delete a.stick_at_position,delete e.stick_at_position);else if("stick_at_position"===g&&"top"===a[g]||g===b.GS.key&&""===a[g].trim()||"background_gradient-css"===g||"cover_gradient-css"===g||"cover_gradient_hover-css"===g||"background_image-type_image"===g||"custom_parallax_scroll_reverse_reverse"===g||"|single"===a[g]||"|multiple"===a[g]||("custom_parallax_scroll_reverse"===
g||"custom_parallax_scroll_fade"===g||"visibility_all"===g||"sticky_visibility"===g)&&!a[g])delete a[g],delete e[g];else{if("builder_content"===g)"string"===typeof a[g]&&(a[g]=JSON.parse(a[g])),a[g]=this.clear(a[g],!0,1);else if(1===c){var l=[];if("px"===a[g]&&-1!==g.indexOf("_unit",2))k=g.replace("_unit",""),a[k]||l.push(g);else if(0===g.indexOf("checkbox_")&&-1!==g.indexOf("_apply_all",6)){a[g]?e[g]=a[g]:l.push(g);k=g.replace("_apply_all","").replace("checkbox_","");for(var m=["top","left","right",
"bottom"],q=3;-1<q;--q){var p=k+"_"+m[q]+"_unit";"px"===a[p]?l.push(p):a[p]!==t&&null!==a[p]&&""!==a[p]&&(e[p]=a[p])}}else-1!==g.indexOf("gradient",3)?("180"==a[g]||"linear"===a[g]||a[g]===h.ThemifyGradient["default"]||!1===a[g]&&-1!==g.indexOf("-circle-radial",3))&&l.push(g):("background_zoom"===g&&""===a[g]||"none"===a[g]&&-1!==g.indexOf("frame_layout")||"solid"===a[g]||!1===a[g]&&(-1!==g.indexOf("_user_role",3)||-1!==g.indexOf("_appearance",3)))&&l.push(g);if(0<l.length){for(q=l.length-1;-1<q;--q)delete e[l[q]],
delete a[l[q]];l.length=0;continue}}!0===d?e.push(a[g]):e[g]=a[g]}else delete e.custom_parallax_scroll_reverse,delete e.custom_parallax_scroll_fade,delete e[g],delete a.custom_parallax_scroll_reverse,delete a.custom_parallax_scroll_fade,delete a[g];return e},clearElementId:function(a,d){for(var c in a){!0===d?a[c].element_id=b.Utils.generateUniqueID():delete a[c].element_id;var e=a[c].styling!==t?a[c].styling:a[c].mod_settings;if(e!==t){if(e.custom_css_id!==t&&""!==e.custom_css_id)for(var f=2;;){var g=
e.custom_css_id+"-"+f.toString(),h=r.getElementById(g);if(null===h||null===h.closest(".module_row")){e.custom_css_id=g;break}++f}e.builder_content!==t&&(f="string"===typeof e.builder_content?JSON.parse(e.builder_content):e.builder_content,this.clearElementId(f,!0),e.builder_content=f)}a[c].cols!==t?this.clearElementId(a[c].cols,d):a[c].modules!==t&&this.clearElementId(a[c].modules,d)}},clearLastEmptyRow:function(a){for(var d=a.length-1;-1<d;--d){var c=a[d].attributes!==t?a[d].attributes:a[d];if(c.styling===
t||null===c.styling||0===Object.keys(c.styling).length){var c=c.cols,e=!0,f;for(f in c)if(c[f].modules!==t&&(0<c[f].modules.length||0<Object.keys(c[f].modules).length)||c[f].styling!==t&&null!==c[f].styling&&0<Object.keys(c[f].styling).length){e=!1;break}if(!0===e)a[d].cid!==t&&(b.Models.Registry.remove(a[d].cid),a[d].destroy()),a.splice(d,1);else break}else break}},builderPlupload:function(a,d){var c=d?!0:!1,e=c?[d]:n.Lightbox.$lightbox[0].getElementsByClassName("tb_plupload_upload_uic"),f=e.length;
if(0<f){var g=c?!1:"new_elemn"===a?".plupload-clone":!1;this.pconfig===t&&(this.pconfig=JSON.parse(JSON.stringify(themify_builder_plupload_init)),this.pconfig.multipart_params._ajax_nonce=themifyBuilder.tb_load_nonce,this.pconfig.multipart_params.topost=themifyBuilder.post_ID);for(--f;-1<f;--f)if(!e[f].classList.contains("tb_plupload_init")&&(!1===g||e[f].classList.contains(g))){var k=e[f],l=k.getAttribute("id").replace("tb_plupload_upload_ui",""),m=h.extend(!0,{},this.pconfig),q=k.getAttribute("data-extensions"),
p=["browse_button","container","drop_element","file_data_name"];m.multipart_params.imgid=l;for(var r=p.length-1;-1<r;--r)m[p[r]]=l+this.pconfig[p[r]];m.filters[0].extensions=null!==q?q:null!==b.activeModel?m.filters[0].extensions.replace(/\,zip|\,txt/,""):"zip,txt";l=new u.plupload.Uploader(m);k.classList.add("tb_plupload_init");c&&l.bind("init",function(a){h(a.settings.browse_button).click()});l.bind("FilesAdded",function(a,b){a.refresh();a.start();n.showLoader("show")});l.bind("Error",function(a,
b){var c=h(".prompt-box .show-error");h(".prompt-box .show-login").hide();c.show();0<c.length&&c.html('<p class="prompt-error">'+b.message+"</p>");h(".overlay, .prompt-box").fadeIn(500)});l.bind("FileUploaded",function(a,d,e){var f=JSON.parse(e.response);a=h("#tb_alert",u.document);e=200!==e.status||f.error?"error":"done";if(f.error)n.showLoader(e),alert(f.error);else if(c){var g=h("#tb_row_wrapper").children().clone(!0);a.promise().done(function(){b.Forms.reLoad(f,themifyBuilder.post_ID);var a=h("#tb_row_wrapper").children().clone(!0);
n.Lightbox.close();f.custom_css&&(A=f.custom_css,"visual"===b.mode&&b.toolbar.updateCustomCSS(A));b.undoManager.push("","","","import",{before:g,after:a,bid:themifyBuilder.post_ID})})}else n.showLoader(e),a=this.getOption().container.closest(".tb_input"),e=a.getElementsByClassName("tb_uploader_input")[0],a=a.getElementsByClassName("thumb_preview")[0],e.value=f.large_url?f.large_url:f.url,a!==t&&ThemifyConstructor.file.setImage(a,f.thumb),v.triggerEvent(e,"change")});l.init();k.classList.remove("plupload-clone")}}},
columnDrag:function(a,d,c,e){var f=this;d&&(d=a?a.children(".module_column"):h(".module_column"),d.css("width",""),f.setCompactMode(d));if(c&&e){a=a.children(".module_column");var g=("gutter-narrow"===c?1.6:"gutter-none"===c?0:3.2)-("gutter-narrow"===e?1.6:"gutter-none"===e?0:3.2),g=parseFloat(g*(a.length-1)/a.length);a.each(function(a){h(this).prop("style").width&&(a=parseFloat(h(this).prop("style").width)+g,h(this).css("width",a+"%"))})}else{var k={"col6-1":14,"col5-1":17.44,"col4-1":22.6,"col4-2":48.4,
"col2-1":48.4,"col4-3":74.2,"col3-1":31.2,"col3-2":65.6},l={"col6-1":15.33,"col5-1":18.72,"col4-1":23.8,"col4-2":49.2,"col2-1":49.2,"col4-3":74.539,"col3-1":32.266,"col3-2":66.05},m={"col6-1":16.666,"col5-1":20,"col4-1":25,"col4-2":50,"col2-1":50,"col4-3":75,"col3-1":33.333,"col3-2":66.666};(a?a.children(".module_column").find(".tb_grid_drag"):h(".tb_grid_drag")).each(function(){var a,c,d,e,g=0,r,t=!1,u=0,x=!1,z,G,A,C=null,I=null,B;h(this).draggable({axis:"x",cursor:"col-resize",distance:0,scroll:!1,
snap:!1,containment:".row_inner",helper:function(b){a=h(b.currentTarget);c=a.closest(".subrow_inner");0===c.length&&(c=a.closest(".row_inner"));r=a[0].classList.contains("tb_drag_right")?"w":"e";z="w"===r?"tb_grid_drag_right_tooltip":"tb_grid_drag_left_tooltip";x=n.clone(c.closest(".module_row"));c.addClass("tb_drag_column_start");return h('<div class="ui-widget-header tb_grid_drag_tooltip '+z+'"></div><div class="ui-widget-header tb_grid_drag_tooltip"></div>')},start:function(b,f){d=c.children(".module_column");
e=a.closest(".module_column");A=c[0].classList.contains("direction-rtl");"w"===r?(t=A?e.prev(".module_column"):e.next(".module_column"),g=a.outerWidth(),B=e.outerWidth()):(t=A?e.next(".module_column"):e.prev(".module_column"),B=g=e.outerWidth());g=parseInt(g);u=parseInt(t.outerWidth())-2;G=c.outerWidth();C=e.addClass("tb_drag_column_current").children("."+z)[0];I=e.children(".tb_grid_drag_tooltip").last()[0]},stop:function(a,p){h(".tb_grid_drag_tooltip").remove();c.removeClass("tb_drag_column_start");
var q=Math.ceil(100*(e.outerWidth()/G));e.removeClass("tb_drag_column_current").css("width",q+"%");var n=k,q=3.2;c[0].classList.contains("gutter-narrow")?(n=l,q=1.6):c[0].classList.contains("gutter-none")&&(n=m,q=0);var w=q*(d.length-1);d.each(function(a){a!==t.index()&&(h(this).prop("style").width?a=parseFloat(h(this).prop("style").width):(a=h.trim(f.filterClass(h(this).attr("class")).replace("first","").replace("last","")),a=n[a]),w+=a)});t.css("width",100-w+"%");t=t.add(e);f.setCompactMode(t);
var q=c.closest(".module_row"),y=!0===b.hasChanged;b.hasChanged=!0;b.undoManager.push(q.data("cid"),x,q,"row");b.hasChanged=y;v.body.triggerHandler("tb_grid_changed",[q]);C=I=g=u=G=B=t=z=e=r=A=c=d=null},drag:function(a,b){if(t&&0<t.length){var c=parseInt(b.position.left),c=g+("e"===r?-c:c),d=parseFloat(100*c/G);if(5<=d&&100>d){var f=u,f=f+("w"===r?-(c-B):B-c),h=parseFloat(100*f/G);5<h&&100>h&&(t.css("width",f+"px"),e.css("width",c+"px"),C.innerHTML=d.toFixed(2)+"%",I.innerHTML=h.toFixed(2)+"%")}}}})})}},
grid:function(a){var b=[];a=parseInt(a);if(1===a)b.push({grid_class:"col-full"});else for(var c=0;c<a;++c)b.push({grid_class:"col"+a+"-1"});return[{cols:b}]},setCompactMode:function(a){a instanceof jQuery&&(a=a.get());for(var b=a.length-1;-1<b;--b)185>a[b].clientWidth?a[b].classList.add("compact-mode"):a[b].classList.remove("compact-mode")},initNewEditor:function(a){if(3<parseInt(tinyMCE.majorVersion)){var b=tinyMCEPreInit.mceInit.tb_lb_hidden_editor;b.elements=a;b.selector="#"+a;a=new tinyMCE.Editor(a,
b,tinyMCE.EditorManager);a.render();return a}},initQuickTags:function(a){"function"===typeof u.QTags&&(u.quicktags({id:a}),u.QTags._buttonsInit())},_getColClass:function(a){for(var b=0,c=a.length;b<c;++b)if(-1!==this.gridClass.indexOf(a[b]))return a[b].replace("col","")},saveBuilder:function(a,d,c){d=d||0;if(0===d){if(null!==b.activeModel||0<n.Lightbox.$lightbox.length&&n.Lightbox.$lightbox[0].classList.contains("tb_custom_css_lightbox")){var e=n.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];
e!==t&&e.click();e=null}n.showLoader("show")}var f=Object.keys(b.Instances.Builder).length,g=b.Instances.Builder[d],k=this,e=g.$el.data("postid"),g=b.Mixins.Builder.toJSON(g.el);if(!0===c)return{id:e,data:g};b.GS.setImport(b.GS.styles,null,null,!0);(function(a,c){null===A&&(A=themifyBuilder.custom_css,delete themifyBuilder.custom_css);var d={action:"tb_save_data",tb_load_nonce:themifyBuilder.tb_load_nonce,id:a,custom_css:A,sourceEditor:"visual"===b.mode?"frontend":"backend"};k.saveCss(c,d.custom_css,
d.id);d.data=JSON.stringify(b.Utils.clear(c));return h.ajax({type:"POST",url:themifyBuilder.ajaxurl,cache:!1,data:d})})(e,g).always(function(c,e){++d;f===d?(h.isFunction(a)&&a.call(k,c,e),"success"!==e?n.showLoader("error"):(n.showLoader("hide"),b.editing=!0,v.body.triggerHandler("themify_builder_save_data",[c,e]))):setTimeout(function(){k.saveBuilder(a,d)},50)})},saveCss:function(a,d,c){return h.ajax({type:"POST",url:themifyBuilder.ajaxurl,cache:!1,data:{css:JSON.stringify(b.GS.createCss(a,null,
!0)),action:"tb_save_css",custom_css:d,tb_load_nonce:themifyBuilder.tb_load_nonce,id:c}})},loadContentJs:function(a,d){ThemifyBuilderModuleJs.loadOnAjax(a,d);if(!1===b.saving){var c=h("audio.wp-audio-shortcode, video.wp-video-shortcode",a);0<c.length&&(v.mediaCssLoad(),c.each(function(){var a=h(this).closest(".mejs-mediaelement");0<a.length&&(this.removeAttribute("style"),this.setAttribute("id",this.getAttribute("id").replace("_html5","")),a.closest(".widget").html(this))}),c.mediaelementplayer(u.wpmejsSettings!==
t?u.wpmejsSettings:{}))}v.body.triggerHandler("builder_load_module_partial",[a,d])},createClearBtn:function(a){a.siblings(".tb_clear_btn").click(function(){h(this).hide();a.val("").trigger("keyup")})},toRGBA:function(a){return ThemifyStyles.toRGBA(a)},getColor:function(a){var b=a.value;""!==b&&(null!==a.getAttribute("data-minicolors-initialized")?b=h(a).minicolors("rgbaString"):(a=a.getAttribute("data-opacity"),""!==a&&null!==a&&"1"!=a&&"0.99"!=a&&(b=this.toRGBA(b+"_"+a))));return b},getIcon:function(a){var b=
a.split("-")[0].trim();return"fa"===b||"ti"===b?b+" "+a:"fas fa"===b||"far fa"===b||"fab fa"===b?a:"tf_fontello"===b?a:"icon"===b?a.replace(/^icon-/,"tf_fontello-"):!1},getBPWidth:function(a){a=Array.isArray(themifyBuilder.breakpoints[a])?themifyBuilder.breakpoints[a]:themifyBuilder.breakpoints[a].toString().split("-");return a[a.length-1]},transitionPrefix:function(){if(this.transitionPrefix.pre===t){var a=r.createElement("fakeelement"),b={transition:"transitionend",OTransition:"oTransitionEnd",
MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},c;for(c in b)if(a.style[c]!==t){this.transitionPrefix.pre=b[c];break}}return this.transitionPrefix.pre},generateUniqueID:function(){return(Math.random().toString(36).substr(2,4)+(new Date).getUTCMilliseconds().toString()).substr(0,7)},getUIDList:function(a){a=a||"row";var d=_.pluck(b.Models.Registry.items,"attributes");return _.where(d,{elType:a})||[]},scrollTo:function(a){("desktop"===b.activeBreakPoint?h("html,body"):h("body",
u.document)).scrollTop(a)},scrollToDropped:function(a,d){a||(a=b.Instances.Builder[b.builderIndex].el.getElementsByClassName("tb_element_cid_"+d)[0]);if(a)if("visual"===b.mode)this.scrollTo(h(a).offset().top-120);else{var c=r.getElementsByClassName("edit-post-layout__content")[0];if(c!==t){if(a.classList.contains("module_row"))var e=a.offsetTop;else e=a.closest(".module_row"),null!==e?(e=h(e),e=e.offset().top+200-e.offsetParent().offset().top):e=a.offsetTop;h(c).scrollTop(e)}}},addViewPortClass:function(a){a.style.transition=
"none";this.removeViewPortClass(a);var b=this.isInViewport(a);if(!1!==b)for(var b=b.split(" "),c=b.length-1;-1<c;--c)""!==b[c]&&a.classList.add(b[c]);a.style.transition=""},removeViewPortClass:function(a){for(var b=["top","left","bottom","right"],c=4;-1<c;--c)a.classList.remove("tb_touch_"+b[c])},isInViewport:function(a){a=a.getBoundingClientRect();var b="";0>a.left?b="tb_touch_left":a.right-1>=r.documentElement.clientWidth&&(b="tb_touch_right");if(0>a.top)b+=" tb_touch_top";else if(a.bottom+1>=r.documentElement.clientHeight||
x.innerHeight+x.scrollY>=r.body.offsetHeight&&a.bottom+20>=r.documentElement.clientHeight)b+=" tb_touch_bottom";return""===b?!1:b},checkImageSize:function(a){var b=a.getElementsByTagName("img")[0],c=function(c){b.width<c?a.classList.add("tb_disable_object_fit"):a.classList.remove("tb_disable_object_fit")};if(b!==t){var e=b.naturalWidth;if(e&&b.complete)c(e);else{var f=new Image;f.onload=function(){c(f.width)};f.src=b.src}}else a.classList.remove("tb_disable_object_fit")},checkAllimageSize:function(){var a=
b.Instances.Builder[b.builderIndex].el,d=b.Models.Registry.items,c;for(c in d)if("image"===d[c].attributes.mod_name){var e=a.getElementsByClassName("tb_element_cid_"+d[c].cid)[0];e!==t&&this.checkImageSize(e)}},hideOnClick:function(a){a[0]!==t&&(a=a[0]);if(a.classList.contains("tb_ui_dropdown_items")||a.classList.contains("tb_down"))a.classList.add("tb_hide_option"),a.previousElementSibling.blur(),setTimeout(function(){a.classList.remove("tb_hide_option")},500)},calculateHeight:function(){"visual"===
b.mode&&"desktop"!==b.activeBreakPoint&&(u.document.body.style.height=r.body.scrollHeight+"px")},changeOptions:function(a,d){var c="INPUT"===a.tagName&&"hide_anchor"!==d?"keyup":"change",e=this;"keyup"===c&&a.setAttribute("data-prev",a.value);e.custom_css_id=function(a,b,c,d){a=r.getElementById(d);return null===a||c[0].getAttribute("id")===d||null===a.closest(".module_row")?(c[0].setAttribute("id",d),!0):!1};e.row_anchor=function(a,c,d,e){"visual"===b.mode&&(d.removeClass(b.liveStylingInstance.getRowAnchorClass(a.getAttribute("data-prev"))),
""!==e&&d.addClass(b.liveStylingInstance.getRowAnchorClass(e)),d.data("anchor",e).attr("data-anchor",e));b.hasChanged=!0;d.find(".tb_row_anchor").first().text(e.replace("#",""));return!0};e.custom_css=function(a,c,d,e){"visual"===b.mode&&d.removeClass(a.getAttribute("data-prev")).addClass(e);return!0};e.layout=function(a,c,d,e){"visual"===b.mode&&b.liveStylingInstance.bindRowWidthHeight(c,e,d);return!0};e.hide_anchor=function(a,c,d,e){"visual"===b.mode&&"1"===e&&d.data("hideAnchor",e).attr("data-hide-anchor",
e);return b.hasChanged=!0};a.addEventListener(c,function(a){var f=null!==b.activeModel&&b.ActionBar.cid===b.activeModel.cid,k=!n.Lightbox.$lightbox[0].contains(this),l="hide_anchor"!==d?this.id:"hide_anchor",m="custom_css_id"===l,q=!0!==m||!1!==k&&!0!==f?t:n.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];var p=!0===k&&!1===f?h(".tb_element_cid_"+b.ActionBar.cid):"visual"===b.mode?b.liveStylingInstance.$liveStyledElmt:h(".tb_element_cid_"+b.activeModel.cid);var y=!1===f&&!0===
k?n.clone(p[0]):null;var w=this.value;"keyup"===c&&"custom_css"!==d?((w=w.trim())&&(w=w.replace(/[^a-zA-Z0-9\-\_]+/gi,"")),this.value=w):"layout"===d?w=a.detail.val:"hide_anchor"===d&&(w=this.checked?"1":"0");if(e[d].call(e,this,l,p,w)){m&&(h(this).next(".tb_field_error_msg").remove(),q!==t&&q.classList.remove("tb_disable_save"));if(!0===k){var u=function(){var a=w;"keyup"===c&&(this.removeEventListener("change",u,{passive:!0,once:!0}),this.removeAttribute("data-isInit"),a=this.value.trim());var d=
p.data("cid"),e=b.Models.Registry.lookup(d),f=h.extend(!0,{},e.get("styling"));f||(f={});var g=h.extend(!0,{},f);f[l]=a;e.set({styling:f},{silent:!0});null!==y&&b.undoManager.push(d,y,p,"save",{bsettings:g,asettings:h.extend(!0,{},f)})};"keyup"===c?this.getAttribute("data-isInit")||(this.setAttribute("data-isInit",1),this.addEventListener("change",u,{passive:!0,once:!0})):u()}b.hasChanged=!0}else m&&(a=r.createElement("span"),a.className="tb_field_error_msg",a.textContent=ThemifyConstructor.label.errorId,
this.parentNode.insertBefore(a,this.nextSibling),q!==t&&q.classList.add("tb_disable_save"));!0===f&&(f=k?n.Lightbox.$lightbox.find("#"+l):h("#"+b.ActionBar.el.id).find("#"+l),"keyup"===c?f.val(w).attr("data-prev",w):"layout"===d?(f.find(".selected").removeClass("selected"),""!==w?f.find("#"+w).addClass("selected"):f.children().first().addClass("selected")):"hide_anchor"===d&&(f.find("INPUT")[0].checked=this.checked));"keyup"===c&&this.setAttribute("data-prev",w)},{passive:!0})},visibilityLabel:function(a,
d){var c=t===d?b.Models.Registry.lookup(a.getAttribute("data-cid")):null;d=t===d?"module"!==c.get("elType")?c.get("styling"):c.get("mod_settings"):d;if(null!==d){var c="",e={visibility_desktop:themifyBuilder.i18n.de,visibility_mobile:themifyBuilder.i18n.mo,visibility_tablet:themifyBuilder.i18n.ta,visibility_tablet_landscape:themifyBuilder.i18n.ta_l,sticky_visibility:themifyBuilder.i18n.s_v},f=a.getElementsByClassName("tb_visibility_hint")[0];if(f!==t){if("hide_all"===d.visibility_all)c=themifyBuilder.i18n.h_a;
else{var g;for(g in e){var h=""===c?"":", ";c+="hide"===d[g]?h+e[g]:""}}f.textContent=c}}}};b.ActionBar={cid:null,topH:null,type:null,disable:null,prevExpand:null,needClear:!0,el:null,breadCrumbs:null,breadCrumbsPath:{lightbox:null,rightClick:null},disablePosition:null,isInit:null,isHoverMode:!0,hoverCid:null,contextMenu:null,contextMenuAnimate:null,init:function(){if(null===this.isInit&&!0!==b.GS.isGSPage){this.isInit=!0;this.el=r.createElement("div");this.breadCrumbs=r.createElement("ul");this.el.id=
"tb_component_bar";this.breadCrumbs.className="tb_action_breadcrumb";this.el.addEventListener("mousedown",this.mouseDown.bind(this));this.topH=b.toolbar.$el.height();"visual"===b.mode?r.body.appendChild(this.el):b.Instances.Builder[b.builderIndex].el.parentNode.appendChild(this.el);r.addEventListener("click",this.click.bind(this));r.addEventListener("dblclick",this.click.bind(this));b.Instances.Builder[0].el.addEventListener("mouseover",this.enter);"visual"===b.mode&&u.document.addEventListener("click",
this.click.bind(this));var a="visual"===b.mode?null:r.getElementById("tb_canvas_block");null===a?(r.addEventListener("keydown",this.actions.bind(this)),u.document.addEventListener("keydown",this.actions.bind(this))):a.addEventListener("keydown",this.actions.bind(this));this.changeMode();this.initRightClick(!0)}},changeMode:function(){this.hoverCid=null;var a=this,b=function(b){a.actions(b)};!0===this.isHoverMode?(r.body.classList.remove("tb_click_mode"),r.body.classList.add("tb_hover_mode"),this.el.removeEventListener("click",
b)):(r.body.classList.remove("tb_hover_mode"),r.body.classList.add("tb_click_mode"),this.el.addEventListener("click",b))},initRightClick:function(a){localStorage.getItem("tb_right_click")?!0===a?b.toolbar.el.getElementsByClassName("tb_right_click_mode")[0].checked=!1:(b.Instances.Builder[0].el.removeEventListener("contextmenu",this.rightClick),this.contextMenu=this.contextMenuAnimate=null):(b.Instances.Builder[0].el.addEventListener("contextmenu",this.rightClick),b.ActionBar.el.removeEventListener("contextmenu",
this.rightClick),!0!==this.isHoverMode&&b.ActionBar.el.addEventListener("contextmenu",this.rightClick))},enter:function(a){var d=b.ActionBar;b.Mixins.Builder.columnHover(a.target);if(!0===d.isHoverMode&&null===d.disablePosition&&null===d.disable){a.preventDefault();a.stopPropagation();var c=a.target,e=null,f=c.classList;if(null!==d.prevExpand&&d.prevExpand!==t)if(d.prevExpand.contains(c)){if(f.contains("tb_inner_action_more")||f.contains("tb_action_more")){var g=c.getElementsByTagName("ul")[0];g!==
t&&b.Utils.addViewPortClass(g)}g=d.prevExpand.getElementsByClassName("tb_row_settings")[0];if(g!==t){var k=r.getElementById(g.getAttribute("data-href"));if(k.contains(c))return;k.classList.remove("selected");g.classList.remove("selected")}if("module"===d.type||"column"===d.type){"column"===d.type&&(d.hoverCid=c.parentNode.getAttribute("data-cid"));return}}else{g="module"!==d.type;if(!1===g)"visual"!==b.mode?(g=c.closest(".active_module"),g=null!==g?g.getAttribute("data-cid")!==d.hoverCid:!0):(k=c.closest(".tb_dragger_top"),
null!==k&&k.classList.contains("tb_dragger_padding")&&b.EdgeDrag.setModulePosition(k));else if(f.contains("tb_clicked"))return;!0===g&&d.clear()}if(null===c.closest(".tb_dragger_lightbox")){if(f.contains("tb_action_wrap"))e=!f.contains("tb_clicked");else{if("LI"===c.nodeName&&f.contains("tb_row_settings")&&!f.contains("selected")){d.actions(a);return}if(!f.contains("tb_grid_drag")){c=h(c).closest("[data-cid]")[0];if(c===t)return;f=c.getAttribute("data-cid");if(d.hoverCid===f)return;d.hoverCid=f;g=
b.Models.Registry.lookup(f);f=g.get("elType");if("module"===f)e=!0;else if("visual"===b.mode){d.clear();b.EdgeDrag.addEdges(f,g,c);return}}}!0===e&&d.click(a)}}},rightClickGS:function(a,d,c){this.disable=!0;null!==b.activeModel&&h(".builder_save_button",ThemifyBuilderCommon.Lightbox.$lightbox).click();var e=b.Instances.Builder[b.builderIndex].el.getElementsByClassName("tb_element_clicked"),f=b.GS.key;d=d.split(" ");for(var g=d.length,k=e.length-1;-1<k;--k){var l=b.Models.Registry.lookup(e[k].getAttribute("data-cid")),
m=n.clone(e[k]),q="module"===l.get("elType")?"mod_settings":"styling",p=h.extend(!0,{},l.get(q)),r=h.extend(!0,{},p);b.activeModel=l;if(p[f])if(!0===c)a&&-1!==p[f].indexOf(a)&&(p[f]=p[f].split(" "),p[f].splice(p[f].indexOf(a),1),p[f]=p[f].join(" "));else for(var t=0;t<g;++t)-1===p[f].indexOf(d[t])&&(p[f]+=" "+d[t]);else{if(0===g)continue;p[f]=d.join(" ")}t={};t[q]=p;l.set(t,{silent:!0});b.GS.generateValues(a,p[f].split(" "),c);b.undoManager.push(l.cid,m,h(e[k]),"save",{bsettings:r,asettings:p})}this.disable=
null;b.activeModel=null},rightClick:function(a,d){a.stopImmediatePropagation();var c=b.ActionBar;if(null===c.contextMenuAnimate){c.contextMenuAnimate=!0;if(null===c.contextMenu){var e=function(a){a.stopPropagation();"click"===a.type&&null===a.target.closest(".tb_visibility_wrap")&&a.preventDefault();if("LI"===a.target.nodeName||a.target.classList.contains("toggle_switch")){var d="LI"===a.target.nodeName?a.target.getAttribute("data-action"):"visibility";if(d){c.disable=!0;c.hoverCid=null;if("undo"===
d||"redo"===d)if(a="undo"===d?b.undoManager.btnUndo:b.undoManager.btnRedo,"undo"===d&&b.undoManager.hasUndo()||"redo"===d&&b.undoManager.hasRedo())h(a).triggerHandler("click"),c.disable=null;else{c.disable=null;return}else{var e=this.classList.contains("tb_multiply_selected");var f=b.Instances.Builder[b.builderIndex].el.getElementsByClassName("tb_element_clicked");var g=t;"gs_in"!==d&&"move"!==d&&(!0!==e||"delete"!==d&&"paste"!==d||(g=!0),h(".builder_save_button",ThemifyBuilderCommon.Lightbox.$lightbox).click());
if("reset"===d){var k=b.activeModel;var l=h.extend(!0,{},ThemifyConstructor.values);var m=ThemifyConstructor.component;var p=ThemifyConstructor.beforeData;var q=!0===b.hasChanged;var r="visual"===b.mode?b.liveStylingInstance.prefix:null;var u="visual"===b.mode?b.liveStylingInstance.$liveStyledElmt:null}else{if("move"===d){c.disable=null;return}if("gs_in"===d){if(!1===e){d=b.Models.Registry.lookup(f[0].dataset.cid);var y=h.extend(!0,{},ThemifyConstructor.values);ThemifyConstructor.values="module"===
d.get("elType")?d.get("mod_settings"):d.get("styling")}if(d=b.GS.globalStylesHTML())a=c.contextMenu.querySelector("#tb_inline_gs"),a.innerHTML="",a.appendChild(d),a.getElementsByClassName("tb_gs_icon")[0].click(),a.querySelector('[data-action="insert"]').click(),a.classList.add("tb_inline_gs_show"),b.Utils.addViewPortClass(c.contextMenu);!1===e&&(ThemifyConstructor.values=y);c.disable=null;return}}for(var v=f.length-1;-1<v;--v){e=f[v].getAttribute("data-cid");var x=b.Models.Registry.lookup(e);var z=
x.get("elType");y="module"===z?x.get("mod_settings"):x.get("styling");if("reset"===d||"gs_r"===d){if("gs_r"!==d||y[b.GS.key]!==t){if(null!==b.activeModel&&b.activeModel.cid===e){var A=ThemifyBuilderCommon.Lightbox.$lightbox.find(".reset-styling")[0];if(A!==t){A.click();continue}}var A=n.clone(f[v]),C;b.activeModel=x;"reset"===d&&(ThemifyConstructor.component=z,ThemifyConstructor.values=y);var F="module"===z?"mod_setting":"styling";"visual"===b.mode&&(b.liveStylingInstance.$liveStyledElmt?b.liveStylingInstance.prefix=
ThemifyStyles.getBaseSelector("module"===z?b.activeModel.get("mod_name"):z,b.activeModel.get("element_id")):b.liveStylingInstance.init(!0),b.liveStylingInstance.$liveStyledElmt=h(f[v]));z=h.extend(!0,{},y);"reset"===d?(y=ThemifyConstructor.resetStyling(a,null!==k&&k.cid!==e),"visual"===b.mode&&(C=h.extend(!0,{},y)),y=h.extend(!0,{},ThemifyConstructor.values)):(delete y[b.GS.key],b.GS.generateValues(null,[],!0));var J={};J[F]=y;x.set(J,{silent:!0});b.hasChanged=!0;b.undoManager.push(e,A,h(f[v]),"save",
{bsettings:z,asettings:y,styles:C});C=null}}else("delete"!==d&&"visibility"!==d||"column"!==z)&&x.trigger(d,a,a.target,g)}"reset"===d?(b.hasChanged=q,b.activeModel=k,ThemifyConstructor.values=l,ThemifyConstructor.component=m,ThemifyConstructor.beforeData=p,"visual"===b.mode&&(b.liveStylingInstance.$liveStyledElmt=u,b.liveStylingInstance.prefix=r)):"edit"!==d&&(b.activeModel=null);c.disable=null}"visibility"!==d&&c.hideContextMenu()}}},f=function(a){a.stopPropagation();a.target.classList.contains("tb_inner_action_more")&&
(a=a.target.getElementsByTagName("ul")[0],a!==t&&b.Utils.addViewPortClass(a))};c.contextMenu=r.getElementById("tb_right_click");null===c.contextMenu&&(c.contextMenu=r.getElementById("tmpl-builder_right_click"),c.contextMenu=n.is_template_support?c.contextMenu.content:c.contextMenu.innerHTML,n.is_template_support?r.body.appendChild(c.contextMenu):r.body.insertAdjacentHTML("beforeend",c.contextMenu),c.contextMenu=r.getElementById("tb_right_click"),c.contextMenu.addEventListener("click",e),c.contextMenu.addEventListener("mouseover",
f,{passive:!0}),c.contextMenu.getElementsByClassName("tb_r_name")[0].addEventListener("mousedown",function(a){1!==a.which||c.contextMenu.classList.contains("tb_multiply_selected")||c.contextMenu.classList.contains("tb_component_column")||(a.preventDefault(),a.stopPropagation(),a=b.Instances.Builder[b.builderIndex].el.getElementsByClassName("tb_element_clicked")[0],a!==t&&(c.hideContextMenu(),c.cid=a.dataset.cid,c.moveComponent()))}))}var g=!0;!0!==c.isHoverMode&&null!==c.cid?d=b.Instances.Builder[b.builderIndex].el.querySelector('[data-cid="'+
c.cid+'"]'):d?g=!1:d=h(a.target).closest("[data-cid]")[0];if(d===t)c.contextMenuAnimate=null;else{a.preventDefault();c.hideContextMenu(a.target.classList.contains("tb_bread"));c.disablePosition=!0;r.body.classList.add("tb_right_click_open");c.contextMenu.className="tb_show_context";var k=a.pageX,l=a.pageY,m=b.Models.Registry.lookup(d.dataset.cid),q=m.get("elType"),p=function(e){if("transform"===e.propertyName){var f=b.Instances.Builder[b.builderIndex].el;e=this.getElementsByClassName("tb_r_name")[0];
var h=this.getElementsByClassName("tb_action_breadcrumb")[0],n=function(a){a.preventDefault();a.stopPropagation();var d=a.target.getAttribute("data-id");d&&(this.removeEventListener("click",n),c.hideContextMenu(!0),d=b.Instances.Builder[b.builderIndex].el.getElementsByClassName("tb_element_cid_"+d)[0],d!==t&&c.rightClick(a,d))};this.removeEventListener("transitionend",p,{passive:!0});this.className="tb_component_"+q;"module"===q&&(this.className+=" tb_module_"+m.get("mod_name"));h.innerHTML="";if(!0===
a.ctrlKey||!0===a.metaKey)d.classList.add("tb_element_clicked");else if(!d.classList.contains("tb_element_clicked")){var r=f.getElementsByClassName("tb_element_clicked");for(var u=r.length-1;-1<u;--u)r[u].classList.remove("tb_element_clicked");d.classList.add("tb_element_clicked")}r=f.getElementsByClassName("tb_element_clicked").length;1<r?(this.className+=" tb_multiply_selected",e.textContent=themifyBuilder.i18n.multiSelected):(f=null===c.breadCrumbsPath.rightClick?m.cid:c.breadCrumbsPath.rightClick[c.breadCrumbsPath.rightClick.length-
1],c.breadCrumbsPath.rightClick=c.getBreadCrumbPath(b.Instances.Builder[0].el.getElementsByClassName("tb_element_cid_"+f)[0],"rightClick"),f=null,h.appendChild(c.getBreadCrumbs(d,"rightClick")),e.textContent="module"===q?themifyBuilder.modules[m.get("mod_name")].name:q);h.addEventListener("click",n);var y=function(a){"transform"===a.propertyName?(this.removeEventListener("transitionend",y,{passive:!0}),b.Utils.addViewPortClass(this),c.contextMenuAnimate=null):(this.style.top=l+"px",!0===g&&(this.style.left=
k+"px"))};this.addEventListener("transitionend",y,{passive:!0});b.undoManager.hasUndo()||(this.className+=" tb_undo_disabled");"column"===q&&(this.className+=" tb_visibility_disabled");b.undoManager.hasRedo()||(this.className+=" tb_redo_disabled");this.className+=" tb_show_context"}};c.contextMenu.addEventListener("transitionend",p,{passive:!0});setTimeout(function(){c.contextMenu.className=""},18)}}},hideContextMenu:function(a){if(null!==this.contextMenu){this.contextMenu.style.top="";var d=this.contextMenu.querySelector("#tb_inline_gs");
d.classList.contains("tb_inline_gs_show")&&d.classList.remove("tb_inline_gs_show");r.body.classList.remove("tb_right_click_open");this.disablePosition=this.hoverCid=null;!0!==a&&(b.ActionBar.breadCrumbsPath.rightClick=null)}},mouseDown:function(a){1!==a.which||"row"!==this.type&&"subrow"!==this.type||!a.target.classList.contains("ti-move")||(a.preventDefault(),a.stopPropagation(),this.moveComponent())},moveComponent:function(){var a=b.Instances.Builder[b.builderIndex].el.getElementsByClassName("tb_element_cid_"+
this.cid)[0];if(a!==t){var d=a.classList.contains("module_row")?a.getElementsByClassName("tb_row_action")[0]:a,a=h(a).offset();this.clear();if("function"===typeof Event)var c=new Event("mousedown",{bubbles:!0,cancelable:!1});else c=r.createEvent("Event"),c.initEvent("mousedown",!0,!1);c.pageX=a.left;c.pageY=a.top;c.which=1;d.dispatchEvent(c)}},click:function(a){if(b.isPreview||!0===this.disable)return!0;var d=a.target,c=d.tagName;var e=null;var f=b.Instances.Builder[b.builderIndex].lastRow;var g=
"visual"===b.mode&&d.ownerDocument===u.document?t:h(d).closest("[data-cid]")[0],k=a.type;if("click"===k){this.hideContextMenu();e=!0===a.ctrlKey||!0===a.metaKey;if(u.document.body.classList.contains("tb_standalone_lightbox")&&!u.document.body.classList.contains("modal-open")){b.toolbar.el.contains(d)||n.Lightbox.$lightbox[0].contains(d)||n.Lightbox.$lightbox[0].classList.contains("tb_predesigned_lightbox")||n.Lightbox.close();var l=u.document.getElementsByClassName("tb_current_menu_selected")[0];
l!==t&&l.classList.remove("tb_current_menu_selected");l=null}f&&!f.contains(d)&&f.classList.remove("expanded");if(!n.Lightbox.$lightbox[0].contains(d)&&(!1===e&&this.clearClicked(),g!==t)){if(!0===e&&g.classList.contains("tb_element_clicked")){g.classList.remove("tb_element_clicked");return}g.classList.add("tb_element_clicked")}}else if("dblclick"===k&&null!==b.Forms.LayoutPart.id&&d.classList.contains("tb_overlay")){b.Forms.LayoutPart.save(a,!0);return}l=("click"===k||"dblclick"===k)&&"visual"===
b.mode&&n.Lightbox.dockMode.get();if(g===t||!("dblclick"===k||!0===l&&d.classList.contains("tb_dragger"))&&d.classList.contains("tb_disable_sorting")||g.classList.contains("tb_active_layout_part"))"LI"===c&&d.classList.contains("tb_bread")?(f=b.Models.Registry.lookup(d.getAttribute("data-id")),"setting"!==ThemifyConstructor.clicked&&"module"===ThemifyConstructor.component&&(a=n.Lightbox.$lightbox[0].getElementsByClassName("tb_lightbox_top_bar")[0].querySelector(".current a").getAttribute("href"),
n.Lightbox.$lightbox.off("themify_opened_lightbox.tb_breadCrumbs").on("themify_opened_lightbox.tb_breadCrumbs",function(){"row"===ThemifyConstructor.component?n.Lightbox.$lightbox.off("themify_opened_lightbox.tb_breadCrumbs")[0].getElementsByClassName("tb_lightbox_top_bar")[0].querySelector('a[href="'+this+'"]').click():null===b.activeModel&&n.Lightbox.$lightbox.off("themify_opened_lightbox.tb_breadCrumbs")}.bind(a)),a=null),a=null===this.breadCrumbsPath.lightbox?b.activeModel.cid:this.breadCrumbsPath.lightbox[this.breadCrumbsPath.lightbox.length-
1],this.breadCrumbsPath.lightbox=this.getBreadCrumbPath(b.Instances.Builder[0].el.getElementsByClassName("tb_element_cid_"+a)[0]),a=null,f.trigger("edit","breadcrumb")):this.el.contains(d)||"click"===a.type&&d.classList.contains("tb_dragger")||this.clear();else{"visual"!==b.mode||"A"!==c&&null===d.closest("a")||a.preventDefault();var m=g.getAttribute("data-cid");f=b.Models.Registry.lookup(m);var q=f.get("elType"),p="row"===q&&g.classList.contains("tb-page-break");if(f){if("dblclick"===k){if((!0===
l||"INPUT"===c||!0===p||d.classList.contains("tb_dragger_lightbox")||null!==d.closest(".tb_clicked"))&&"tb_row_options"!==d.id)return;a.preventDefault();a.stopPropagation();!1===l&&!0!==this.isHoverMode?(g.classList.add("tb_element_clicked"),v.body[0].classList.add("tb_action_active"),"visual"===b.mode&&b.EdgeDrag.addEdges("module"===q?f.get("mod_name"):q,f,g)):g.classList.remove("tb_element_clicked");if(!d.classList.contains("tb_row_settings")){this.hoverCid=null;f.trigger("edit",a,d);return}}else if("click"===
k&&!1===l&&(d.classList.contains("tb_dragger")||null!==d.closest(".tb_dragger_options")))return;var y=!0===this.isHoverMode;var w=!0!==y&&null!==this.cid,c="module"!==q?d.classList.contains("tb_action_wrap"):!0===y;this.cid=m;this.type=q;if(!0===p&&"row"===q)this.clear(),d.classList.contains("tb_row_anchor")&&(a.preventDefault(),a.stopPropagation(),f.trigger("delete",a,d));else if((!1===c||"module"===q&&!0===y)&&null!==d.closest(".tb_action_wrap"))"click"===k&&this.actions(a);else if(!0===y&&"click"===
k&&!0===this.needClear)!0===l&&!1===e&&f.trigger("edit",a,d);else if(this.clear(),!0===w&&"click"===k&&!1===e&&!1===l&&!0===this.needClear){v.body[0].classList.add("tb_action_active");var x=this,z=function(){r.removeEventListener("mousemove",z,{passive:!0,once:!0});null===x.cid&&(v.body[0].classList.remove("tb_action_active"),x.clearClicked())};r.removeEventListener("mousemove",z,{passive:!0,once:!0});r.addEventListener("mousemove",z,{passive:!0,once:!0})}else{this.cid=m;this.type=q;e="tmpl-builder_"+
q+"_action";k=n.is_template_support?r.getElementById(e).content.cloneNode(!0):n.templateCache.get(e);if(!0===c){this.prevExpand="module"===q?g.getElementsByClassName("tb_module_action")[0]:d;if(this.prevExpand===t){this.clear();return}n.is_template_support?this.prevExpand.appendChild(k):this.prevExpand.insertAdjacentHTML("beforeend",k);this.prevExpand.setAttribute("id",this.el.id);this.prevExpand.style.top="";this.prevExpand.closest(".tb_action_wrap").classList.add("tb_clicked");!0===y&&"module"===
q&&(k=!0,e=g.getBoundingClientRect(),70>e.height||200>e.width?(this.prevExpand.classList.add("tb_small_action_bar"),this.prevExpand.classList.remove("tb_small_action_bar_top"),this.prevExpand.classList.remove("tb_small_action_bar_bottom"),this.prevExpand.style.top=0,40>this.prevExpand.getBoundingClientRect().top?(this.prevExpand.style.top="100%",this.prevExpand.classList.add("tb_small_action_bar_top")):this.prevExpand.classList.add("tb_small_action_bar_bottom"),70>e.height?this.prevExpand.classList.add("tb_small_action_bar_height"):
this.prevExpand.classList.remove("tb_small_action_bar_height"),200>e.width?this.prevExpand.classList.add("tb_small_action_bar_width"):this.prevExpand.classList.remove("tb_small_action_bar_width"),k=!1):this.prevExpand.classList.remove("tb_small_action_bar"),"visual"===b.mode&&(!0===k&&75>e.height&&(e=this.prevExpand.nextElementSibling,null!==e&&e.classList.contains("tb_module_btn_plus")&&null!==e.offsetParent||(e=g.parentNode.nextElementSibling),null!==e&&(e=this.prevExpand.getBoundingClientRect().bottom-
e.getBoundingClientRect().top,0<=e&&(this.prevExpand.style.top=this.prevExpand.offsetTop-e-2+"px"))),b.EdgeDrag.addEdges(f.get("mod_name"),f,g)))}else("row"!==q||"row"===q&&null!==this.breadCrumbsPath.lightbox)&&this.setBreadCrumbs(g),this.el.className="tb_show_toolbar tb_"+q+"_action",e=r.createElement("div"),e.className="tb_action_label_wrap",n.is_template_support?e.appendChild(k):e.insertAdjacentHTML("beforeend",k),"visual"===b.mode&&("module"===q?(k=f.get("mod_name"),this.el.className+=" tb_"+
k+"_action",k=themifyBuilder.modules[k].name):(k=q,"row"===q&&(m=f.get("styling").row_anchor,m!==t&&(m=m.trim(),""!==m&&(k+=" #"+m)))),m=r.createElement("div"),m.className="tb_data_mod_name",m.textContent=k.charAt(0).toUpperCase()+k.slice(1),e.appendChild(m)),this.el.appendChild(e);!0!==y&&(g.classList.add("tb_element_clicked"),v.body[0].classList.add("tb_action_active"),"visual"===b.mode&&b.EdgeDrag.addEdges("module"===q?f.get("mod_name"):q,f,g));if(!0===l&&(f.trigger("edit",a,d),!0===y||null!==
this.disablePosition&&!1!==c&&!0===y))return;null===this.disablePosition&&(!1===c&&!0!==y?(f=a.pageX,y=a.pageY,"visual"!==b.mode&&(e=b.Instances.Builder[0].el.getBoundingClientRect(),f=a.clientX-e.left,y=a.clientY-e.top+30),this.setPosition(this.el,{left:f,top:y})):b.Utils.addViewPortClass(this.prevExpand))}}else!0!==y&&this.clear()}},setBreadCrumbs:function(a){for(;null!==this.breadCrumbs.firstChild;)this.breadCrumbs.removeChild(this.breadCrumbs.firstChild);this.breadCrumbs.appendChild(this.getBreadCrumbs(a));
null===this.el.firstChild?this.el.appendChild(this.breadCrumbs):this.el.insertBefore(this.breadCrumbs,this.el.firstChild)},getBreadCrumbPath:function(a,b){var c;b="rightClick"!==b?"lightbox":b;var d=null!==this.breadCrumbsPath[b]?this.breadCrumbsPath[b]:[];if(0<d.length)return d;if(t!==a)for((c=a.getAttribute("data-cid"))&&d.push(c);!a.classList.contains("module_row");)a=a.parentNode,(c=a.getAttribute("data-cid"))&&d.push(c);return d},getBreadCrumbs:function(a,d){var c=this.getBreadCrumbPath(a,d),
e=r.createDocumentFragment();if(t!==a)for(var f="rightClick"===d?a.dataset.cid:b.activeModel?b.activeModel.cid:b.ActionBar.cid,g=c.length-1;-1<g;--g){var h=r.createElement("li"),l=b.Models.Registry.lookup(c[g]),m=l.get("elType");h.textContent="column"===m?l.get("component_name"):"module"===m?l.get("mod_name"):m;h.className="tb_bread tb_bread_"+m;f===c[g]&&(h.className+=" tb_active_bc");h.setAttribute("data-id",c[g]);e.appendChild(h)}return e},actions:function(a){var d=a.target;var c=d.tagName;if("keydown"===
a.type){if("INPUT"!==c&&"TEXTAREA"!==c&&!themifyBuilder.disableShortcuts&&!n.Lightbox.$lightbox[0].contains(d)){var e=a.keyCode;c=r.getElementsByClassName("tb_element_clicked");var f=c.length;if(0<f){a.preventDefault();a.stopPropagation();var g=null,k=null,l=t,m=!0===a.ctrlKey||!0===a.metaKey;46===e||8===e?g="delete":!0===m&&(67===e?(g="copy",f=1):68===e?g="duplicate":86===e&&(g="paste",!0===a.shiftKey&&(k="style")));1<f&&("delete"===g||"paste"===g)&&(l=!0,null!==b.activeModel&&n.Lightbox.$lightbox.is(":visible")&&
ThemifyConstructor.saveComponent());for(d=f-1;-1<d;--d){var q=c[d];if(null===g){if(!0===m&&1===f&&(38===e||40===e)){var p=38===a.which?"up":"down";var u="up"===p?q.previousElementSibling:q.nextElementSibling;if(null!==u){if(q.classList.contains("module_row")){if(!u.classList.contains("module_row"))continue;var w=b.Instances.Builder[b.builderIndex].$el}else if(q.classList.contains("active_module")){if(!u.classList.contains("active_module"))continue;w=h(q.parentNode.closest(".tb_holder"))}else continue;
u&&(u=h(q),w.sortable("option","beforeStart")(null,null,{item:u}),w.sortable("option","start")(null,{item:u}),"up"===p?u.prev().before(u):u.next().after(u),w.sortable("option","update")({type:"sortupdate"},{item:u}),w.sortable("option","stop")(null,{item:u,helper:null}),!0!==this.isHoverMode&&q.classList.add("tb_element_clicked"))}}}else"delete"===g&&q.classList.contains("module_column")||(q=b.Models.Registry.lookup(h(q).closest("[data-cid]")[0].getAttribute("data-cid")),q.trigger(g,a,k,l))}"delete"!==
g&&!0===this.isHoverMode||this.clear()}}}else if(a.stopPropagation(),"click"===a.type&&null!==d.closest(".switch-wrapper"))d.classList.contains("toggle_switch")&&b.Models.Registry.lookup(h(d).closest("[data-cid]")[0].getAttribute("data-cid")).trigger("visibility",a,d);else if(a.preventDefault(),null!==this.cid&&("LI"===c||"SPAN"===c||"A"===c)&&(f=(e=d.classList.contains("tb_bread"))?d.getAttribute("data-id"):this.cid,p=null,q=b.Models.Registry.lookup(f),g=d.classList,q))if(v.body[0].classList.remove("tb_component_menu_active"),
!0===e)this.needClear=null,this.disablePosition=!0,r.getElementsByClassName("tb_element_cid_"+f)[0].click(),this.disablePosition=null,"visual"===b.mode&&(d=this.el.getBoundingClientRect(),d.right>=r.body.clientWidth&&this.setPosition(this.el,{left:d.left,top:this.el.offsetTop+55})),this.needClear=!0;else if(p=d.getAttribute("data-href"))for(a=d.parentNode.getElementsByTagName("li"),d=a.length-1;-1<d;--d)c=(q=a[d].getAttribute("data-href"))?r.getElementById(q):null,e=a[d].classList.contains("selected"),
a[d].classList.remove("selected"),null!==c&&c.classList.remove("selected"),q!==p||e||("tb_row_options"===q||"tb_rgrids"===q?this.gridMenu(c):"tb_roptions"===q&&0===c.children.length&&this.setRowOptions(c),c.classList.add("selected"),a[d].classList.add("selected"),b.Utils.addViewPortClass(c),v.body[0].classList.add("tb_component_menu_active"));else{if(g.contains("tb_edit")||g.contains("tb_styling")||g.contains("tb_visibility_component")||g.contains("tb_swap"))p="edit";else if(g.contains("tb_duplicate"))p=
"duplicate";else if(g.contains("tb_save_component"))p="save";else if(g.contains("tb_delete"))p="delete";else if(g.contains("ti-import")||g.contains("ti-export"))p="importExport";else if(g.contains("tb_copy_component"))p="copy";else if(g.contains("tb_paste_component")||g.contains("tb_paste_style"))p="paste";else{if("LI"===c||"SPAN"===c||g.contains("tb_action_more")||g.contains("tb_inner_action_more")){a=d.closest("li");if(null===a)return;e=a.parentNode;p=e.classList;q=p.contains("tb_grid_list")||p.contains("tb_column_alignment")||
p.contains("tb_column_gutter")||p.contains("tb_column_direction")||p.contains("tb_column_height")||p.contains("grid_tabs");c=d.classList.contains("selected");e=e.children;if(q&&c)return;for(d=e.length-1;-1<d;--d)if(e[d].classList.remove("selected"),!1===q)for(f=e[d].getElementsByClassName("selected"),g=f.length-1;-1<g;--g)f[g].classList.remove("selected");c||(a.classList.add("selected"),v.body[0].classList.add("tb_component_menu_active"));if(q)p.contains("tb_column_alignment")?this._columnAlignmentClicked(a):
p.contains("tb_column_gutter")?this._gutterChange(a):p.contains("tb_column_direction")?this._columnDirectionClicked(a):p.contains("tb_column_height")?this._columnHeight(a):p.contains("grid_tabs")?this._switchGridTabs(a):p.contains("tb_grid_list")&&this._gridClicked(a);else{e=null!==this.prevExpand?this.prevExpand.children:this.el.getElementsByClassName("tb_action_label_wrap")[0].children;for(d=e.length-1;-1<d;--d)e[d].classList.remove("selected");c||null!==this.prevExpand&&"column"!==this.type||(e=
a.getElementsByTagName("ul")[0],e!==t&&b.Utils.addViewPortClass(e))}}return}if(!0!==this.isHoverMode)this.clear();else{var x=d.closest(".tb_action_more");null!==x&&(x=x.getElementsByTagName("ul")[0],x.style.display="none",setTimeout(function(){null!==x&&(x.style.display="")},100))}q.trigger(p,a,d)}},_switchGridTabs:function(a){b.ActionBar.disable=b.clearOnModeChange=!0;b.ActionBar.hoverCid=null;b.scrollTo=h(r.getElementsByClassName("tb_element_cid_"+this.cid)[0]);ThemifyConstructor.lightboxSwitch(a.getAttribute("data-id"));
"visual"!==b.mode&&this.gridMenu(a.closest(".tb_toolbar_tabs"))},_gridClicked:function(a){var d=h(a),c=d.data("grid"),e=this.type,f=h(".tb_element_cid_"+this.cid).first(),g=!1,k=b.activeBreakPoint,l="desktop"===k;a=n.clone(f.closest(".module_row"));g="subrow"===e;var m=f.find("."+e+"_inner").first();if(l){e=m;var q=d.data("col");e=e.add(h("#tb_rgrids"));q===t&&(q=1,d.data("col",q));for(k=6;0<k;--k)e.removeClass("col-count-"+k);e.addClass("col-count-"+q);m.attr("data-basecol",q);l&&d.closest(".tb_grid_menu").find(".tb_grid_reposnive .tb_grid_list").each(function(){var a=
h(this).find(".selected"),b=h(this).data("type"),c=a.data("col");c!==t&&(c>q||4===q&&3===c||4<=q&&4<=c&&q!=c)&&(a.removeClass("selected"),m.removeClass("tb_grid_classes col-count-"+m.attr("data-basecol")+" "+m.attr("data-col_"+b)).attr("data-col_"+b,""),h(this).closest(".tb_grid_list").find("."+b+"-auto").addClass("selected"))})}else return"-auto"!==c[0]?(a="column"+c.join("-"),q=d.data("col"),3===q&&m.attr("data-basecol")>q&&(a+=" tb_3col"),m.removeClass(m.attr("data-col_tablet")+" "+m.attr("data-col_tablet_landscape")+
" "+m.attr("data-col_mobile")).addClass(a+" tb_grid_classes col-count-"+m.attr("data-basecol")).attr("data-col_"+k,a)):m.removeClass("tb_grid_classes tb_3col col-count-"+m.attr("data-basecol")+" "+m.attr("data-col_"+k)).attr("data-col_"+k,""),"visual"===b.mode&&(h("body",u.document).height(r.body.scrollHeight),b.Utils.calculateHeight()),b.Utils.setCompactMode(m.children(".module_column")),!1;d=m.children(".module_column");l=c.length;e="module_column"+(g?" sub_column":"")+" col";for(k=0;k<l;++k)f=
d.eq(k),0<f.length?f.removeClass(b.Utils.gridClass.join(" ")).addClass(e+c[k]):b.Utils._addNewColumn({newclass:e+c[k],component:g?"sub-column":"column"},m[0]);l<m.children().length&&m.children(".module_column").eq(l-1).nextAll().each(function(){h(this).find(".tb_holder").first().children().appendTo(h(this).prev().find(".tb_holder").first());h(this).remove()});c=m.children();c.removeClass("first last");m.hasClass("direction-rtl")?(c.last().addClass("first"),c.first().addClass("last")):(c.first().addClass("first"),
c.last().addClass("last"));b.Utils.columnDrag(m,!0);f=m.closest(".module_row");b.hasChanged=!0;b.Mixins.Builder.updateModuleSort(f);b.undoManager.push(f.data("cid"),a,f,"row");v.body.triggerHandler("tb_grid_changed",[f])},_columnHeight:function(a){a=h(a).data("value");if(a!==t){var d=h(".tb_element_cid_"+this.cid).first(),c=b.Models.Registry.lookup(this.cid),e=n.clone(d),d=d.find("."+this.type+"_inner").first();""===a?d.removeClass("col_auto_height"):d.addClass("col_auto_height");c.set({column_h:a},
{silent:!0});b.undoManager.push(this.cid,e,h(".tb_element_cid_"+this.cid).first(),"row")}},_columnAlignmentClicked:function(a){a=h(a);if(a=a.data("alignment")){var d=h(".tb_element_cid_"+this.cid).first(),c=b.Models.Registry.lookup(this.cid),e=n.clone(d);d.find("."+this.type+"_inner").first().removeClass(c.get("column_alignment")).addClass(a);c.set({column_alignment:a},{silent:!0});b.undoManager.push(this.cid,e,h(".tb_element_cid_"+this.cid).first(),"row")}},_columnDirectionClicked:function(a){a=
h(a);if(a=a.data("dir")){var d=h(".tb_element_cid_"+this.cid).first().find("."+this.type+"_inner").first(),c=d.children(".module_column"),e=c.first(),c=c.last(),f=b.Models.Registry.lookup(this.cid),g={};g[b.activeBreakPoint+"_dir"]=a;f.set(g,{silent:!0});"rtl"===a?(e.removeClass("first").addClass("last"),c.removeClass("last").addClass("first"),d.addClass("direction-rtl")):(e.removeClass("last").addClass("first"),c.removeClass("first").addClass("last"),d.removeClass("direction-rtl"));d.attr("data-"+
b.activeBreakPoint+"_dir",a)}},_gutterChange:function(a){if(a=h(a).data("value")){var d=h(".tb_element_cid_"+this.cid).first(),c=b.Models.Registry.lookup(this.cid),e=c.get("gutter"),f=n.clone(d),d=d.find("."+this.type+"_inner").first();b.Utils.columnDrag(d,!1,e,a);d.removeClass(e).addClass(a);c.set({gutter:a},{silent:!0});b.undoManager.push(this.cid,f,h(".tb_element_cid_"+this.cid).first(),"row")}},gridMenu:function(a){for(var d=b.activeBreakPoint,c="desktop"===d,e=b.Models.Registry.lookup(this.cid),
f=e.get(d+"_dir"),g=e.get("column_alignment"),k=e.get("column_h"),e=e.get("gutter"),l=r.getElementsByClassName("tb_element_cid_"+this.cid)[0].getElementsByClassName(this.type+"_inner")[0],m=!0===c?t:l.getAttribute("data-col_"+d),q=l.children,n=q.length,u=[],l=0;l<n;++l)u.push(b.Utils._getColClass(q[l].className.split(" ")));q="tb_rgrids"===a.id?a:h(a).find("#tb_rgrids")[0];for(l=6;-1<l;--l)q.classList.remove("col-count-"+l);q.classList.add("col-count-"+n);u="grid-layout-"+u.join("-");a=a.getElementsByClassName("tb_grid_"+
d)[0];q=a.getElementsByClassName("tb_grid_list")[0].getElementsByTagName("li");m="-auto"!==m&&m?"grid-layout-"+m.replace(/column|tb_3col/ig,"").trim():!1;!1!==c||!1!==m&&1!==n||(m=d+"-auto");for(l=q.length-1;-1<l;--l)!0===c&&q[l].classList.contains(u)||!1===c&&q[l].classList.contains(m)?q[l].classList.add("selected"):q[l].classList.remove("selected");if("ltr"!==f)for(q=a.getElementsByClassName("tb_column_direction")[0].getElementsByTagName("li"),l=q.length-1;-1<l;--l)q[l].getAttribute("data-dir")===
f?q[l].classList.add("selected"):q[l].classList.remove("selected");if(!0===c){if("col_align_top"!==g||!0===F)for(d=a.getElementsByClassName("tb_column_alignment")[0].getElementsByTagName("li"),l=d.length-1;-1<l;--l)d[l].getAttribute("data-alignment")===g?d[l].classList.add("selected"):d[l].classList.remove("selected");if("gutter-default"!==e)for(g=a.getElementsByClassName("tb_column_gutter")[0].getElementsByTagName("li"),l=g.length-1;-1<l;--l)g[l].getAttribute("data-value")===e?g[l].classList.add("selected"):
g[l].classList.remove("selected");if(k)for(g=a.getElementsByClassName("tb_column_height")[0].getElementsByTagName("li"),l=g.length-1;-1<l;--l)g[l].getAttribute("data-value")==k?g[l].classList.add("selected"):g[l].classList.remove("selected")}},setRowOptions:function(a){var d=null,c=b.activeModel,e=ThemifyConstructor.component,f=b.Models.Registry.lookup(this.cid),g=f.get("styling");g||(g={});null!==c&&(d="module"===b.activeModel.get("elType")?"mod_settings":"styling",d=b.activeModel.get(d));if(a.children[0]!==
t)for(;a.firstChild;)a.removeChild(a.firstChild);ThemifyConstructor.values=g;ThemifyConstructor.component=this.type;b.activeModel=f;a.appendChild(ThemifyConstructor.create(ThemifyConstructor.data.row.setting.options.slice(0,6)));ThemifyConstructor.values=d;b.activeModel=c;ThemifyConstructor.component=e},clear:function(){if(null!==this.type){this.cid=this.type=null;for(this.el.classList.remove("tb_show_toolbar");null!==this.el.firstChild;)this.el.removeChild(this.el.firstChild);if(null!==this.prevExpand&&
this.prevExpand!==t){for(;null!==this.prevExpand.firstChild;)this.prevExpand.removeChild(this.prevExpand.firstChild);this.prevExpand.removeAttribute("id");this.prevExpand.closest(".tb_action_wrap").classList.remove("tb_clicked");this.prevExpand=null}this.clearSelected();v.body[0].classList.remove("tb_action_active");v.body[0].classList.remove("tb_component_menu_active")}},clearSelected:function(){"visual"===b.mode&&b.EdgeDrag.clearEdges()},clearClicked:function(){for(var a=b.Instances.Builder[0].el.getElementsByClassName("tb_element_clicked"),
d=a.length-1;-1<d;--d)a[d].classList.remove("tb_element_clicked")},setPosition:function(a,d){a.removeAttribute("data-top");var c=a.getBoundingClientRect();var e=c.width,f=c.height+40,g="visual"===b.mode?x.pageYOffset:b.toolbar.el.offsetTop+this.topH,k="visual"===b.mode?r.body:b.Instances.Builder[0].el,l=k.clientWidth;c=d.nodeType!==t?h(d).offset():d;c.right=c.bottom="";c.left-=parseFloat(e/2);c.top-=f;c.left+e>l?(c.left="auto",c.right=10):0>c.left&&(c.left=30);c.top>k.clientHeight?"visual"!==b.mode&&
(c.top="auto",c.bottom=50):g>c.top&&(a.dataset.top=!0,c.top+=2*f-25,"visual"!==b.mode&&(c.top-=f/2));for(var m in c)a.style[m]="auto"!==c[m]&&""!==c[m]?c[m]+"px":c[m]}};b.Forms.register_validator=function(a,b){this.Validators[a]=b};b.Forms.get_validator=function(a){return this.Validators[a]!==t?this.Validators[a]:this.Validators.not_empty};b.Forms.register_validator("email",function(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
a=a.split(",");for(var c=a.length-1;-1<c;--c)if(!b.test(a[c]))return!1;return!0});b.Forms.register_validator("not_empty",function(a){return!(!a||""===a.trim())});b.GS={styles:{},initContent:!1,loadingPosts:!1,allLoaded:!1,el:null,dropdown:null,isShown:null,field:null,isGSPage:r.body.classList.contains("gs_post"),activeGS:null,xhr:null,key:"global_styles",previousModel:null,liveInstance:null,init:function(){if(!0===this.isGSPage)if(u.document.body.classList.add("gs_post"),"visual"!==b.mode||!0===v.is_builder_loaded)this.openStylingPanel();
else{var a=this;u.Themify.body.one("themify_builder_ready",function(b){a.openStylingPanel();a=null})}else null!==themifyBuilder.globalStyles&&(this.extend(this.styles,themifyBuilder.globalStyles),themifyBuilder.globalStyles=null)},extend:function(a,b){for(var c in b)b[c]!==t&&(a[c]=b[c]);return a},openStylingPanel:function(){var a=function(){null===ThemifyConstructor.label&&(ThemifyConstructor.label=themifyBuilder.i18n.label);var d=themifyBuilder.globalStyleData.type,d=b.Models.Registry.lookup(b.Instances.Builder[b.builderIndex].el.getElementsByClassName(("row"===
d||"column"===d||"subrow"===d?"module_":"module-")+d)[0].dataset.cid);d.set("styleClicked",{silent:!0});b.isPreview=!1;d.trigger("edit",null);b.isPreview=!0;v.body.one("themify_builder_save_data",a)};a();b.toolbar.el.getElementsByClassName("tb_toolbar_builder_preview")[0].click()},setCss:function(a,d,c){"visual"===b.mode&&b.liveStylingInstance.setCss(a,d,c)},createCss:function(a,b,c){ThemifyStyles.GS={};return ThemifyStyles.createCss(a,b,c,this.styles)},findUsedItems:function(a){a=JSON.stringify(a);
for(var b=/"global_styles":"(.*?)"/mg,c,e="";null!==(c=b.exec(a));)e+=" "+c[1].trim();e=e.trim();if(""!==e){e=h.unique(e.split(" "));a=[];for(b=e.length-1;-1<b;--b)this.styles[e[b]]!==t&&a.push(e[b]);return a}return!1},globalStylesHTML:function(){if(!0===this.isGSPage||null!==this.activeGS)return!1;var a=r.createElement("div"),d=r.createElement("div"),c=r.createElement("span");this.isShown=null;this.field=ThemifyConstructor.hidden.render({id:b.GS.key,is_responsive:!1,value:ThemifyConstructor.values[b.GS.key],
control:!1},ThemifyConstructor);a.className="tb_gs_container";if(this.field.value){for(var e=this.field.value.split(" "),f="",g=e.length-1;-1<g;--g)this.styles[e[g]]!==t&&(f+=" "+e[g]);f=f.trim();this.field.value=f}else this.field.value="";d.className="tb_gs_icon ti-brush-alt";d.addEventListener("click",function(a){if(a.target.classList.contains("tb_gs_icon")){var c=this.el;if(c.classList.contains("tb_gs_dropdown_opened"))a.stopPropagation(),c.classList.remove("tb_gs_dropdown_action"),c.classList.remove("tb_gs_dropdown_opened");
else{c.classList.add("tb_gs_dropdown_opened");c.classList.add("tb_gs_dropdown_action");var d=function(a){null===c||c.contains(a.target)||(r.removeEventListener("click",d,{passive:!0}),"visual"===b.mode&&u.document.removeEventListener("click",d,{passive:!0}),c.classList.remove("tb_gs_dropdown_action"),c.classList.remove("tb_gs_dropdown_opened"),c=null)};r.addEventListener("mousedown",d,{passive:!0});"visual"===b.mode&&u.document.addEventListener("mousedown",d,{passive:!0})}}}.bind(this),{passive:!0});
c.className="tb_gs_tooltip";c.textContent=themifyBuilder.i18n.gs;d.appendChild(c);a.appendChild(this.field);a.appendChild(d);this.el=a;""!==this.field.value&&(d=this.stylingOverlay(),null!==d&&a.appendChild(d));a.addEventListener("click",this.initClickEvent.bind(this));this.initContent=!1;a=null;return this.el},initHTML:function(){var a=r.createElement("div");var b=this.field.value.trim();if(""!==b){b=b.split(" ");for(var c=0,e=b.length;c<e;++c)this.styles[b[c]]!==t&&a.appendChild(this.createSelectedItem(b[c]))}a.className=
"tb_gs_selected_styles";this.el.appendChild(a);a=n.is_template_support?r.getElementById("tmpl-global_styles").content.cloneNode(!0):n.templateCache.get("tmpl-global_styles");b=this.el.getElementsByClassName("tb_gs_icon")[0];n.is_template_support?b.parentNode.insertBefore(a,b.nextSibling):b.insertAdjacentHTML("afterend",a);this.initContent=!0},createSelectedItem:function(a){var b=this.styles[a],c=r.createElement("div"),e=r.createElement("span"),f=r.createElement("span"),g=r.createElement("span");c.className=
"tb_selected_style";c.dataset.styleId=a;g.className="tb_gs_edit ti-pencil";c.appendChild(g);e.innerText=b.title;c.appendChild(e);f.className="tb_delete_gs ti-close";c.appendChild(f);return c},saveAs:function(){var a=this;n.LiteLightbox.prompt(themifyBuilder.i18n.enterGlobalStyleName,function(b){if(null!==b){if(""===b)return alert(themifyBuilder.i18n.enterGlobalStyleName),a.saveAs(),!1;a.saveAsCallback(b)}})},saveAsCallback:function(a){ThemifyConstructor.setStylingValues(b.activeBreakPoint);var d=
b.activeModel.get("elType"),c=this,e=b.Utils.clear(ThemifyConstructor.values);"module"===d&&(d=b.activeModel.get("mod_name"));delete e[this.key];h.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_save_as_new_global_style",tb_load_nonce:themifyBuilder.tb_load_nonce,type:d,styles:e,title:a},beforeSend:function(){n.showLoader("show")},error:function(){n.showLoader("error")},success:function(a){n.showLoader("hide");"success"===a.status?(a=a.post_data,c.styles[a["class"]]=
a,b.Utils.saveCss(b.Utils.clear(a.data),"",a.id),n.LiteLightbox.confirm(themifyBuilder.i18n.addSavedGS,function(d){if("yes"===d){c.isGSPage=!0;d=c.field.value;n.Lightbox.$lightbox[0].getElementsByClassName("reset-styling")[0].click();c.isGSPage=!1;d=a["class"]+" "+d;d=d.trim();c.field.value=d;d=d.split(" ");var e=c.el.getElementsByClassName("tb_gs_selected_styles")[0];e.innerHTML="";for(var f=0,g=d.length;f<g;++f)e.appendChild(c.createSelectedItem(d[f]));b.GS.generateValues(null,d,!0);d=c.stylingOverlay();
null!==d&&c.el.appendChild(d)}c.addItemToDropdown([a["class"]]);c=null},{buttons:{no:{label:ThemifyConstructor.label.no},yes:{label:ThemifyConstructor.label.y}}})):alert(a.msg)}})},"delete":function(a){if(null!==this.field){b.hasChanged=!0;var d=this.el.querySelector('.global_style_item[data-style-id="'+a+'"]'),c=this.el.querySelector('.tb_selected_style[data-style-id="'+a+'"]');null!==d&&d.classList.remove("selected");null!==c&&c.parentNode.removeChild(c);d=this.field.value.trim();d=d.split(" ");
d.splice(d.indexOf(a),1);this.field.value=d=d.join(" ");null!==b.ActionBar.contextMenu&&b.ActionBar.contextMenu.contains(this.field)?b.ActionBar.rightClickGS(a,d,!0):this.generateValues(a,d.split(" "),!0);return!0}},insert:function(a){if(null!==this.field){b.hasChanged=!0;null!==this.dropdown&&this.dropdown.querySelector('.global_style_item[data-style-id="'+a+'"]').classList.add("selected");var d=this.createSelectedItem(a);this.el.getElementsByClassName("tb_gs_selected_styles")[0].appendChild(d);
d=this.field.value+" "+a;this.field.value=d=d.trim();if(""!==d){var c=this.stylingOverlay();null!==c&&(this.el.classList.add("tb_gs_dropdown_action"),this.el.appendChild(c))}null!==b.ActionBar.contextMenu&&b.ActionBar.contextMenu.contains(this.field)?b.ActionBar.rightClickGS(a,d):this.generateValues(a,d.split(" "))}},search:function(){var a=this;this.el.querySelector("#global-style-search").addEventListener("input",function(b){var c=b.target.value.toUpperCase(),d=this.el,f=function(){for(var a=d.getElementsByClassName("tb_gs_list")[0].getElementsByClassName("global_style_item"),
b=a.length-1;-1<b;--b){var e=a[b].getElementsByClassName("global_style_title")[0];e&&(a[b].style.display=-1<e.innerHTML.toUpperCase().indexOf(c)?"":"none")}};null!==a.xhr&&(a.xhr.abort(),a.xhr=null);a.allLoaded||setTimeout(function(){a.loadMore(c,f)},100);f()}.bind(this),{passive:!0})},addItemToDropdown:function(a){if(null!==this.dropdown){for(var b=r.createDocumentFragment(),c=this.field.value.split(" "),e=this.dropdown.getElementsByClassName("tb_no_gs_item")[0],f=0,g=a.length;f<g;++f){var h=this.styles[a[f]],
l=r.createElement("div"),m=r.createElement("span"),n=r.createElement("span");l.className="global_style_item";l.className+=-1!==c.indexOf(a[f])?" selected":"";l.dataset.styleId=a[f];n.className="global_style_title";n.innerText=h.title;m.className="global_style_type";m.innerText=h.type;l.appendChild(n);l.appendChild(m);b.appendChild(l)}e.parentNode.insertBefore(b,e)}},loadMore:function(a,b){var c=this,d=[];this.loadingPosts=!0;for(var f in this.styles)this.styles[f].id!==t&&d.push(this.styles[f].id);
this.xhr=h.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{s:a,action:"tb_get_gs_posts",tb_load_nonce:themifyBuilder.tb_load_nonce,loaded:d},success:function(d){c.extend(c.styles,d);d=Object.keys(d);a||(c.allLoaded=10>d.length);c.addItemToDropdown(d);c.loadingPosts=!1;b&&b()}})},initDropdown:function(){this.dropdown=this.el.getElementsByClassName("tb_gs_list")[0];var a=Object.keys(this.styles);this.addItemToDropdown(a);10>a.length&&!1===this.allLoaded&&this.loadMore();var a=new SimpleBar(this.dropdown),
b=this.dropdown.getElementsByClassName("simplebar-content")[0],c=this.dropdown;b!==t&&(this.dropdown=b,c=a.getScrollElement());!1===this.allLoaded&&c.addEventListener("scroll",this.onScroll.bind(this),{passive:!0});this.search()},initClickEvent:function(a){!0!==this.initContent&&this.initHTML();var b=a.target,c=b.classList;if("LABEL"===b.nodeName||c.contains("tb_open_gs"))return!0;"insert"===b.dataset.action?(a.preventDefault(),a.stopImmediatePropagation(),this.el.classList.remove("tb_gs_dropdown_action"),
b.dataset.init===t&&(this.initDropdown(),b.dataset.init=!0)):c.contains("global_style_title")?(a.preventDefault(),a.stopImmediatePropagation(),this.insert(b.parentElement.dataset.styleId)):c.contains("tb_delete_gs")?(a.preventDefault(),a.stopImmediatePropagation(),this["delete"](b.parentElement.getAttribute("data-style-id"))):"save"===b.dataset.action?(a.preventDefault(),a.stopImmediatePropagation(),this.saveAs()):c.contains("tb_gs_edit")&&this.liveEdit(b.parentNode.dataset.styleId)},onScroll:function(a){!1===
this.allLoaded&&!1===this.loadingPosts&&(a=a.target,a=Math.max(a.scrollHeight-(a.scrollTop+a.offsetHeight),0),0<a&&200>=a&&(this.loadingPosts=!0,this.loadMore()))},updated:function(a,d,c,e){!1===this.isGSPage&&"visual"===b.mode&&"module"!==b.activeModel.get("elType")&&this.extraStyle(d,c,e)},setImport:function(a,b,c,e){if(!0!==e)for(var d in a)this.styles[d]!==t&&delete a[d];if(0<Object.keys(a).length){this.loadingPosts=!0;var g=this;n.showLoader("show");h.ajax({type:"POST",url:themifyBuilder.ajaxurl,
dataType:"json",data:{onlySave:e?1:0,action:"tb_import_gs_posts_ajax",tb_load_nonce:themifyBuilder.tb_load_nonce,data:JSON.stringify(a)},error:function(){n.showLoader("error")},success:function(a){g.loadingPosts=!1;if(a)for(var d in a)g.styles[d]=a[d];b&&b(c);n.showLoader("hide");g=null}})}else b&&b(c)},generateValues:function(a,d,c){if(!0!==this.isGSPage&&"visual"===b.mode){var e=b.activeModel.get("elType"),f=b.activeModel.get("element_id");"module"===e&&(e=b.activeModel.get("mod_name"));f={styling:ThemifyStyles.generateGSstyles(d,
e,this.styles),element_id:f};ThemifyStyles.disableNestedSel=!0;null===this.liveInstance&&(this.liveInstance=b.createStyleInstance(),this.liveInstance.init(!0,!0));var e=this.createCss([f],e),g=this.liveInstance,h=[],l=b.activeBreakPoint;var m=g.prefix;var n=new RegExp(m,"g");ThemifyStyles.disableNestedSel=null;if(!0===c){var p=ThemifyConstructor.breakpointsReverse;for(var r=p.length-1;-1<r;--r){b.activeBreakPoint=p[r];g.setMode(p[r],!0);var t=g.currentSheet;var u=t.cssRules?t.cssRules:t.rules;for(t=
u.length-1;-1<t;--t)if(-1!==u[t].selectorText.indexOf(m)){c=u[t].selectorText.replace(/\,\s+/g,",").replace(n,"").split(",");var v=u[t].cssText.split("{")[1].split(";");if(-1!==c[0].indexOf(".tb_text_wrap"))for(var x=c.length-1;0<x;--x)-1!==c[x].indexOf(".tb_text_wrap")&&c.splice(x,1);for(x=v.length-2;-1<x;--x)g.setLiveStyle(v[x].trim().split(": ")[0].trim(),"",c)}}}delete e.gs;for(r in e)if("fonts"===r||"cf_fonts"===r)for(var z in e[r])u=z,0<e[r][z].length&&(u+=":"+e[r][z].join(",")),h.push(u);else for(t in b.activeBreakPoint=
r,g.setMode(r,!0),e[r])for(c=t.replace(/\,\s+/g,",").replace(n,"").split(","),x=0,v=e[r][t].length;x<v;++x){p=e[r][t][x].split(";");for(var A=p.length-2;-1<A;--A)""!==p[A]&&(m=p[A].split(":")[0],u=p[A].replace(m+":","").trim(),"background-image"===m&&-1!==p[A].indexOf("svg")&&-1!==p[A].indexOf("data:")&&(u+=";"+p[A+1]),g.setLiveStyle(m,u,c))}0<h.length&&ThemifyConstructor.font_select.loadGoogleFonts(h.join("|"));b.activeBreakPoint=l;this.updated(a,e,f,d);this.liveInstance=null}},extraStyle:function(a,
d,c){var e=null!==this.liveInstance?this.liveInstance:b.liveStylingInstance,f=e.prefix.length-1,g=0!==e.getComponentBgOverlay().length;c=e.$liveStyledElmt;var h=g,l={top:!1,bottom:!1,left:!1,right:!1},m=0;a:for(u in a)if("fonts"!==u&&"cf_fonts"!==u&&"gs"!==u)for(var n in a[u]){!1===h&&(h=-1!==n.indexOf("builder_row_cover",f));if(-1!==n.indexOf("tb_row_frame",f))for(var p in l)if(!1===l[p]&&-1!==n.indexOf("tb_row_frame_"+p,f)){l[p]=!0;++m;break}if(!0===h&&4===m)break a}!1===g&&!0===h&&e.addOrRemoveComponentOverlay();
if(0<m){a=r.createDocumentFragment();for(p in l)if(!0===l[p]&&0===c.children(".tb_row_frame_"+p).length){var u=r.createElement("div");u.className="tb_row_frame tb_row_frame_"+p;a.appendChild(u)}c.children(".tb_action_wrap").after(a)}(p=d.styling!==t?d.styling.background_type:"none")||(p="image");"image"===p&&"builder-parallax-scrolling"===d.styling.background_repeat&&d.styling.background_image?(c[0].classList.add("builder-parallax-scrolling"),ThemifyBuilderModuleJs.backgroundScrolling(c)):(c[0].classList.remove("builder-parallax-scrolling"),
c[0].style.backgroundPosition="","image"===p&&"builder-zoom-scrolling"===d.styling.background_repeat&&d.styling.background_image?(c[0].classList.add("builder-zoom-scrolling"),ThemifyBuilderModuleJs.backgroundZoom(c)):(c[0].classList.remove("builder-zoom-scrolling"),c[0].style.backgroundSize=""))},liveEdit:function(a){var d={styleClicked:!0},c=!1;if(null===b.activeModel&&null!==b.ActionBar.contextMenu&&b.ActionBar.contextMenu.contains(this.field)){var e=b.Instances.Builder[b.builderIndex].el.getElementsByClassName("tb_element_clicked")[0];
if(e===t)return;b.activeModel=b.Models.Registry.lookup(e.getAttribute("data-cid"));d.element_id=b.activeModel.get("element_id");this.previousModel=b.activeModel.cid;c=!0;b.Utils.scrollToDropped(e)}else null!==b.activeModel&&(this.previousModel=b.activeModel.cid,d.element_id=b.activeModel.get("element_id"),ThemifyConstructor.saveComponent(!0));var f=this.styles[a],g=this,k=ThemifyConstructor.label.done,l="visual"===b.mode?h.extend(!0,{},b.liveStylingInstance):null,e=h.extend(!0,{},f.data[0]),m=f.type;
this.activeGS=a;if("row"===m){delete e.cols;delete e.styling[this.key];var q=b.Views.init_row(e)}else"subrow"===m?(delete e.cols,delete e.styling[this.key],q=b.Views.init_subrow(e)):(delete e.styling,"column"===m?(delete e.cols[0].modules,delete e.cols[0].styling[this.key],q=b.Views.init_column(e.cols[0])):(delete e.cols[0].styling,delete e.cols[0].modules[0].mod_settings[this.key],q=b.Views.init_module(e.cols[0].modules[0])));n.Lightbox.$lightbox[0].className+=" gs_post";ThemifyConstructor.label.done=
ThemifyConstructor.label.s_s;b.ActionBar.hideContextMenu();n.Lightbox.$lightbox.one("themify_opened_lightbox.tb_gs_edit",function(){this.getElementsByClassName("current")[0].getElementsByClassName("tb_tooltip")[0].textContent=ThemifyConstructor.label.g_s+" - "+f.title});q.model.set(d,{silent:!0});q.model.trigger("edit",null);var p=function(a){v.body.off("themify_builder_lightbox_close.tb_gs_edit themify_builder_save_component.tb_gs_edit");n.Lightbox.$lightbox[0].classList.remove("gs_post");ThemifyConstructor.label.done=
k;q.model.destroy();"visual"===b.mode&&(l.prefix&&(b.liveStylingInstance=l,b.liveStylingInstance.$liveStyledElmt=h(r.querySelector(l.prefix)),null===g.previousModel||"row"!==m&&"column"!==m&&"subrow"!==m||(a=b.Models.Registry.lookup(g.previousModel))&&"module"===a.get("elType")&&(b.liveStylingInstance.getComponentBgOverlay().remove(),b.liveStylingInstance.removeBgSlider(),b.liveStylingInstance.removeBgVideo(),b.liveStylingInstance.$liveStyledElmt.children(".tb_row_frame").remove(),b.liveStylingInstance.$liveStyledElmt[0].classList.remove("builder-zoom-scrolling"),
b.liveStylingInstance.$liveStyledElmt[0].classList.remove("builder-zooming"),b.liveStylingInstance.$liveStyledElmt[0].classList.remove("builder-zoom-scrolling"))),l=g.liveInstance=null);g.activeGS=null};v.body.one("themify_builder_lightbox_close.tb_gs_edit",function(a){console.lof("aaa");p();c?g.previousModel=null:g.reopenPreviousPanel()}).one("themify_builder_save_component.tb_gs_edit",function(a,d){var e=g.activeGS,f=g.styles[e],k=g.previousModel;delete ThemifyConstructor.values.cid;ThemifyConstructor.setStylingValues(b.activeBreakPoint);
var l=ThemifyConstructor.values,q=b.activeModel;delete l[this.key];"row"===m||"subrow"===m?(f.data[0].styling=l,delete f.data[0].cols):(delete f.data[0].styling,delete f.data[0].cols[0].grid_class,"column"===m?(delete f.data[0].cols[0].modules,f.data[0].cols[0].styling=l):(delete f.data[0].cols[0].styling,f.data[0].cols[0].modules[0].mod_settings=l));n.showLoader("show");b.Utils.saveCss(f.data,"",f.id);f.data=b.Utils.clear(f.data);g.styles[e].data=f.data;g.activeGS=null;g.previousModel=null;if("visual"===
b.mode&&b.hasChanged){var l=b.Models.Registry.items,r;for(r in l){var u="module"===l[r].get("elType")?l[r].get("mod_settings"):l[r].get("styling");u[g.key]!==t&&""!==u[g.key]&&-1!==u[g.key].indexOf(e)&&(b.activeModel=l[r],g.generateValues(e,u[g.key].split(" "),!0))}g.liveInstance=null}b.activeModel=q;g.previousModel=k;p(!0);b.hasChanged=!1;h.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_update_global_style",tb_load_nonce:themifyBuilder.tb_load_nonce,data:f.data,id:f.id},
error:function(){n.showLoader("error")},success:function(){d||c?g.previousModel=null:g.reopenPreviousPanel();g=null;n.showLoader("hide")}});f=null})},reopenPreviousPanel:function(a){t!==a?a.model.trigger("edit",a.e,a.target):null!==this.previousModel&&(a=b.Models.Registry.lookup(this.previousModel),null!==a&&(a.set({styleClicked:!0},{silent:!0}),a.trigger("edit",null)),this.previousModel=null)},stylingOverlay:function(){if(null===this.isShown&&null!==b.activeModel&&(null===this.el.parentNode||!this.el.parentNode.classList.contains("tb_inline_gs_show"))){this.isShown=
!0;var a=r.createElement("div"),d=r.createElement("p"),c=function(a){a.preventDefault();a.stopPropagation();this.removeEventListener("click",c,{once:!0});this.parentNode.removeChild(this)};a.className="tb_gs_options_overlay";d.textContent=themifyBuilder.i18n.has_gs;a.addEventListener("click",c,{once:!0});a.appendChild(d);return a}return null}}})(jQuery,Backbone,Themify,window,window.top,document,ThemifyBuilderCommon,void 0);
