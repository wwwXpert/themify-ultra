'use strict';function themify_create_pluploader(c){var e=c.attr("id").replace("plupload-upload-ui",""),k=!1,m=!1,b=jQuery,a=JSON.parse(JSON.stringify(global_plupload_init));a.browse_button=e+a.browse_button;a.container=e+a.container;a.drop_element=e+a.drop_element;a.file_data_name=e+a.file_data_name;a.multipart_params.imgid=e;a.multipart_params._ajax_nonce=c.find(".ajaxnonceplu").attr("id").replace("ajaxnonceplu","");c.hasClass("add-preset")&&(k=!0,a.multipart_params.haspreset="haspreset");c.hasClass("add-preview")&&
(m=!0,a.multipart_params.haspreview="haspreview");c.hasClass("add-to-media")&&(a.multipart_params.tomedia="tomedia");c.data("postid")&&(a.multipart_params.topost=c.data("postid"));c.data("fields")&&(a.multipart_params.fields=c.data("fields"));c.data("featured")&&(a.multipart_params.featured=c.data("featured"));c.data("formats")&&(a.filters[0].extensions=c.data("formats"));a.multipart_params.action=c.data("action");a=new plupload.Uploader(a);a.bind("Init",function(d){});a.init();a.bind("FilesAdded",
function(d,f){if(!c.data("confirm")||confirm(c.data("confirm")))d.refresh(),d.start(),b(".tb_alert").addClass("busy").fadeIn(800)});a.bind("Error",function(d,f){b(".prompt-box .show-login").hide();b(".prompt-box .show-error").show();if(-600==f.code)var g=themify_plupload_lang.filesize_error,h=themify_plupload_lang.filesize_error_fix;0<b(".prompt-box .show-error").length&&(b(".prompt-box .show-error").html('<p class="prompt-error">'+g+"</p>"),h&&b(".prompt-box .show-error").append("<p>"+h+"</p>"));
b(".overlay, .prompt-box").fadeIn(500);document.getElementsByClassName("overlay")[0].addEventListener("click",function(){b(".overlay, .prompt-box").fadeOut(500)},{once:!0})});a.bind("FileUploaded",function(d,f,g){d=JSON.parse(g.response);var h="";h="200"!=g.status||d.error?"error":"done";b(".tb_alert").removeClass("busy").addClass(h).delay(800).fadeOut(800,function(){b(this).removeClass(h)});if(d.error)b(".prompt-box .show-login").hide(),b(".prompt-box .show-error").show(),0<b(".prompt-box .show-error").length&&
(b(".prompt-box .show-error").html('<p class="prompt-error">'+d.error+"</p>"),b(".prompt-box .show-error").append("<p>"+themify_plupload_lang.enable_zip_upload+"</p>")),b(".overlay, .prompt-box").fadeIn(500),document.getElementsByClassName("overlay")[0].addEventListener("click",function(){b(".overlay, .prompt-box").fadeOut(500)},{once:!0,passive:!0});else{b("#"+f.id).fadeOut();g=d.file;f=d.url;var l=d.type;"zip"===l||"rar"===l||"plain"===l?window.location=location.href.replace(location.hash,""):b("#"+
e).val(f);"undefined"!==typeof d.thumb&&(themifyMediaLib.setPreviewIcon(c.closest(".themify_field, .themify_field_row"),d.thumb),b("body").trigger("themify_plupload_selected",[c,d]));k&&(b("#"+e).closest("fieldset").children(".preset").find("img").removeClass("selected"),d=f.replace(/^.*[\\\/]/,""),d=b('<a href="#" title="'+d+'"><span title="'+g+'"></span><img src="'+f+'" alt="'+f+'" class="backgroundThumb selected" /></a>').css("display","inline-block"),b("#"+e).closest("fieldset").children(".preset").append(d));
m&&b("#"+e+"-preview").attr("src",f)}})}(function(c){const e=function(){const k=c(".plupload-upload-uic");0<k.length&&k.each(function(){themify_create_pluploader(c(this))})};"complete"===document.readyState?e():window.addEventListener("load",e,{once:!0,passive:!0})})(jQuery);
